//
// ChemDoodle Web Components 5.2.1
//
// http://web.chemdoodle.com
//
// Copyright 2009-2013 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact-us> for
// alternate licensing options.
//
var ChemDoodle=function(){var d={structures:{}};d.structures.d2={};d.structures.d3={};d.iChemLabs={};d.informatics={};d.io={};d.getVersion=function(){return"5.2.1"};return d}();
ChemDoodle.extensions=function(d,b,a){return{stringStartsWith:function(a,g){return a.slice(0,g.length)===g},vec3AngleFrom:function(f,g){var e=b.length(f),m=b.length(g),e=b.dot(f,g)/e/m;return a.acos(e)},contextHashTo:function(a,g,e,m,c,j,b){var n=0,h=(new d.Point(g,e)).distance(new d.Point(m,c)),l=!1,o=g,v=e;g=m-g;for(e=c-e;n<h;){if(l)if(n+b>h){a.moveTo(m,c);break}else{var k=b/h,o=o+k*g,v=v+k*e;a.moveTo(o,v);n+=b}else if(n+j>h){a.lineTo(m,c);break}else k=j/h,o+=k*g,v+=k*e,a.lineTo(o,v),n+=j;l=!l}},
contextRoundRect:function(a,g,e,m,c,j){a.beginPath();a.moveTo(g+j,e);a.lineTo(g+m-j,e);a.quadraticCurveTo(g+m,e,g+m,e+j);a.lineTo(g+m,e+c-j);a.quadraticCurveTo(g+m,e+c,g+m-j,e+c);a.lineTo(g+j,e+c);a.quadraticCurveTo(g,e+c,g,e+c-j);a.lineTo(g,e+j);a.quadraticCurveTo(g,e,g+j,e);a.closePath()},contextEllipse:function(a,g,e,m,c){var j=0.5522848*(m/2),b=0.5522848*(c/2),n=g+m,h=e+c;m=g+m/2;c=e+c/2;a.beginPath();a.moveTo(g,c);a.bezierCurveTo(g,c-b,m-j,e,m,e);a.bezierCurveTo(m+j,e,n,c-b,n,c);a.bezierCurveTo(n,
c+b,m+j,h,m,h);a.bezierCurveTo(m-j,h,g,c+b,g,c);a.closePath()}}}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(d,b,a){var f={},g={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};f.angleBetweenLargest=function(e){if(0===e.length)return{angle:0,largest:2*a.PI};if(1===e.length)return{angle:e[0]+a.PI,largest:2*a.PI};for(var m=0,c=0,j=0,f=e.length-1;j<f;j++){var n=e[j+1]-e[j];
n>m&&(m=n,c=(e[j+1]+e[j])/2)}j=e[0]+2*a.PI-e[e.length-1];j>m&&(c=e[0]-j/2,m=j,0>c&&(c+=2*a.PI));return{angle:c,largest:m}};f.isBetween=function(a,m,c){if(m>c){var j=m;m=c;c=j}return a>=m&&a<=c};f.getRGB=function(a,m){var c=[0,0,0];g[a.toLowerCase()]&&(a=g[a.toLowerCase()]);if("#"===a.charAt(0))return 4===a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),[parseInt(a.substring(1,3),16)/255*m,parseInt(a.substring(3,5),16)/255*m,parseInt(a.substring(5,7),16)/255*
m];if(d.stringStartsWith(a,"rgb")){var j=a.replace(/rgb\(|\)/g,"").split(",");return 3!==j.length?c:[parseInt(j[0])/255*m,parseInt(j[1])/255*m,parseInt(j[2])/255*m]}return c};f.distanceFromPointToLineInclusive=function(e,m,c){var j=m.distance(c);c=m.angle(c);c=a.PI/2-c;c=m.angle(e)+c;e=m.distance(e);e=new b.Point(e*a.cos(c),-e*a.sin(c));return f.isBetween(-e.y,0,j)?a.abs(e.x):-1};f.calculateDistanceInterior=function(e,m,c){if(this.isBetween(m.x,c.x,c.x+c.w)&&this.isBetween(m.y,c.y,c.y+c.w))return e.distance(m);
var j=[];j.push({x1:c.x,y1:c.y,x2:c.x+c.w,y2:c.y});j.push({x1:c.x,y1:c.y+c.h,x2:c.x+c.w,y2:c.y+c.h});j.push({x1:c.x,y1:c.y,x2:c.x,y2:c.y+c.h});j.push({x1:c.x+c.w,y1:c.y,x2:c.x+c.w,y2:c.y+c.h});c=[];for(var f=0;4>f;f++){var n=j[f];(n=this.intersectLines(m.x,m.y,e.x,e.y,n.x1,n.y1,n.x2,n.y2))&&c.push(n)}if(0===c.length)return 0;f=m=0;for(j=c.length;f<j;f++){var n=c[f],h=e.x-n.x,n=e.y-n.y;m=a.max(m,a.sqrt(h*h+n*n))}return m};f.intersectLines=function(a,m,c,j,f,n,h,g){c-=a;j-=m;h-=f;g-=n;var b=j*h-c*g;
if(0===b)return!1;h=(g*(a-f)-h*(m-n))/b;f=(j*(a-f)-c*(m-n))/b;return 0<=f&&1>=f&&0<=h&&1>=h?{x:a+h*c,y:m+h*j}:!1};f.hsl2rgb=function(a,m,c){var j=function(a,c,j){0>j?j+=1:1<j&&(j-=1);return j<1/6?a+6*(c-a)*j:0.5>j?c:j<2/3?a+6*(c-a)*(2/3-j):a};if(0===m)c=m=a=c;else{var f=0.5>c?c*(1+m):c+m-c*m,n=2*c-f;c=j(n,f,a+1/3);m=j(n,f,a);a=j(n,f,a-1/3)}return[255*c,255*m,255*a]};f.isPointInPoly=function(a,m){for(var c=!1,j=-1,f=a.length,n=f-1;++j<f;n=j)(a[j].y<=m.y&&m.y<a[n].y||a[n].y<=m.y&&m.y<a[j].y)&&m.x<(a[n].x-
a[j].x)*(m.y-a[j].y)/(a[n].y-a[j].y)+a[j].x&&(c=!c);return c};f.clamp=function(a,m,c){return a<m?m:a>c?c:a};return f}(ChemDoodle.extensions,ChemDoodle.structures,Math);
(function(d,b){d.Bounds=function(){};var a=d.Bounds.prototype;a.minX=a.minY=a.minZ=Infinity;a.maxX=a.maxY=a.maxZ=-Infinity;a.expand=function(a,g,e,m){a instanceof d.Bounds?(this.minX=b.min(this.minX,a.minX),this.minY=b.min(this.minY,a.minY),this.maxX=b.max(this.maxX,a.maxX),this.maxY=b.max(this.maxY,a.maxY),Infinity!==a.maxZ&&(this.minZ=b.min(this.minZ,a.minZ),this.maxZ=b.max(this.maxZ,a.maxZ))):(this.minX=b.min(this.minX,a),this.maxX=b.max(this.maxX,a),this.minY=b.min(this.minY,g),this.maxY=b.max(this.maxY,
g),void 0!==e&&void 0!==m&&(this.minX=b.min(this.minX,e),this.maxX=b.max(this.maxX,e),this.minY=b.min(this.minY,m),this.maxY=b.max(this.maxY,m)))};a.expand3D=function(a,g,e,m,c,j){this.minX=b.min(this.minX,a);this.maxX=b.max(this.maxX,a);this.minY=b.min(this.minY,g);this.maxY=b.max(this.maxY,g);this.minZ=b.min(this.minZ,e);this.maxZ=b.max(this.maxZ,e);void 0!==m&&(void 0!==c&&void 0!==j)&&(this.minX=b.min(this.minX,m),this.maxX=b.max(this.maxX,m),this.minY=b.min(this.minY,c),this.maxY=b.max(this.maxY,
c),this.minZ=b.min(this.minZ,j),this.maxZ=b.max(this.maxZ,j))}})(ChemDoodle.math,Math);
(function(){var d={subtract:function(a,c){return{x:a.x-c.x,y:a.y-c.y}},dotProduct:function(a,c){return a.x*c.x+a.y*c.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,c){return{x:a.x*c,y:a.y*c}}},b=Math.pow(2,-65),a=function(a,c){for(var j=[],m=c.length-1,e=2*m-1,b=[],w=[],u=[],q=[],r=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],p=0;p<=m;p++)b[p]=d.subtract(c[p],a);for(p=0;p<=m-1;p++)w[p]=d.subtract(c[p+1],c[p]),w[p]=d.scale(w[p],3);for(p=0;p<=m-1;p++)for(var y=0;y<=
m;y++)u[p]||(u[p]=[]),u[p][y]=d.dotProduct(w[p],b[y]);for(p=0;p<=e;p++)q[p]||(q[p]=[]),q[p].y=0,q[p].x=parseFloat(p)/e;e=m-1;for(b=0;b<=m+e;b++){p=Math.max(0,b-e);for(w=Math.min(b,m);p<=w;p++)y=b-p,q[p+y].y+=u[y][p]*r[y][p]}m=c.length-1;q=f(q,2*m-1,j,0);e=d.subtract(a,c[0]);u=d.square(e);for(p=r=0;p<q;p++)e=d.subtract(a,g(c,m,j[p],null,null)),e=d.square(e),e<u&&(u=e,r=j[p]);e=d.subtract(a,c[m]);e=d.square(e);e<u&&(u=e,r=1);return{location:r,distance:u}},f=function(a,c,j,e){var m=[],w=[],d=[],u=[],
q=0,r,p;p=0==a[0].y?0:0<a[0].y?1:-1;for(var y=1;y<=c;y++)r=0==a[y].y?0:0<a[y].y?1:-1,r!=p&&q++,p=r;switch(q){case 0:return 0;case 1:if(64<=e)return j[0]=(a[0].x+a[c].x)/2,1;var z,x,A,q=a[0].y-a[c].y;r=a[c].x-a[0].x;p=a[0].x*a[c].y-a[c].x*a[0].y;y=z=0;for(x=1;x<c;x++)A=q*a[x].x+r*a[x].y+p,A>z?z=A:A<y&&(y=A);A=r;x=0*A-1*q;z=(1*(p-z)-0*A)*(1/x);A=r;x=0*A-1*q;q=(1*(p-y)-0*A)*(1/x);r=Math.min(z,q);if(Math.max(z,q)-r<b)return d=a[c].x-a[0].x,u=a[c].y-a[0].y,j[0]=0+1*(d*(a[0].y-0)-u*(a[0].x-0))*(1/(0*d-
1*u)),1}g(a,c,0.5,m,w);a=f(m,c,d,e+1);c=f(w,c,u,e+1);for(e=0;e<a;e++)j[e]=d[e];for(e=0;e<c;e++)j[e+a]=u[e];return a+c},g=function(a,c,j,e,m){for(var f=[[]],g=0;g<=c;g++)f[0][g]=a[g];for(a=1;a<=c;a++)for(g=0;g<=c-a;g++)f[a]||(f[a]=[]),f[a][g]||(f[a][g]={}),f[a][g].x=(1-j)*f[a-1][g].x+j*f[a-1][g+1].x,f[a][g].y=(1-j)*f[a-1][g].y+j*f[a-1][g+1].y;if(null!=e)for(g=0;g<=c;g++)e[g]=f[g][0];if(null!=m)for(g=0;g<=c;g++)m[g]=f[c-g][g];return f[c][0]},e={},m=function(a,c){var j,m=a.length-1;j=e[m];if(!j){j=[];
var f=function(a){return function(){return a}},g=function(){return function(a){return a}},b=function(){return function(a){return 1-a}},d=function(a){return function(c){for(var j=1,e=0;e<a.length;e++)j*=a[e](c);return j}};j.push(new function(){return function(a){return Math.pow(a,m)}});for(var w=1;w<m;w++){for(var r=[new f(m)],p=0;p<m-w;p++)r.push(new g);for(p=0;p<w;p++)r.push(new b);j.push(new d(r))}j.push(new function(){return function(a){return Math.pow(1-a,m)}});e[m]=j}for(b=g=f=0;b<a.length;b++)f+=
a[b].x*j[b](c),g+=a[b].y*j[b](c);return{x:f,y:g}},c=function(a,c){return Math.sqrt(Math.pow(a.x-c.x,2)+Math.pow(a.y-c.y,2))},j=function(a,j,e){for(var f=m(a,j),g=0,b=0<e?1:-1,w=null;g<Math.abs(e);)j+=0.005*b,w=m(a,j),g+=c(w,f),f=w;return{point:w,location:j}},w=function(a,c){var j=m(a,c),e=m(a.slice(0,a.length-1),c),f=e.y-j.y,j=e.x-j.x;return 0==f?Infinity:Math.atan(f/j)};ChemDoodle.math.jsBezier={distanceFromCurve:a,gradientAtPoint:w,gradientAtPointAlongCurveFrom:function(a,c,e){c=j(a,c,e);1<c.location&&
(c.location=1);0>c.location&&(c.location=0);return w(a,c.location)},nearestPointOnCurve:function(c,j){var e=a(c,j);return{point:g(j,j.length-1,e.location,null,null),location:e.location}},pointOnCurve:m,pointAlongCurveFrom:function(a,c,e){return j(a,c,e).point},perpendicularToCurveAt:function(a,c,e,m){c=j(a,c,null==m?0:m);a=w(a,c.location);m=Math.atan(-1/a);a=e/2*Math.sin(m);e=e/2*Math.cos(m);return[{x:c.point.x+e,y:c.point.y+a},{x:c.point.x-e,y:c.point.y-a}]},locationAlongCurveFrom:function(a,c,e){return j(a,
c,e).location},getLength:function(a){for(var j=m(a,0),e=0,f=0,g=null;1>f;)f+=0.005,g=m(a,f),e+=c(g,j),j=g;return e}}})(ChemDoodle.math);
ChemDoodle.featureDetection=function(d,b,a,f){var g={supports_canvas:function(){return!!a.createElement("canvas").getContext},supports_canvas_text:function(){return!g.supports_canvas()?!1:"function"===typeof a.createElement("canvas").getContext("2d").fillText},supports_webgl:function(){var e=a.createElement("canvas");try{if(e.getContext("webgl")||e.getContext("experimental-webgl"))return!0}catch(m){}return!1},supports_xhr2:function(){return b.support.cors},supports_touch:function(){return"ontouchstart"in
f},supports_gesture:function(){return"ongesturestart"in f}};return g}(ChemDoodle.iChemLabs,jQuery,document,window);ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo".split(" ");
ChemDoodle.ELEMENT=function(d){function b(a,m,c){this.symbol=a;this.name=m;this.atomicNumber=c}var a=[];a.H=new b("H","Hydrogen",1);a.He=new b("He","Helium",2);a.Li=new b("Li","Lithium",3);a.Be=new b("Be","Beryllium",4);a.B=new b("B","Boron",5);a.C=new b("C","Carbon",6);a.N=new b("N","Nitrogen",7);a.O=new b("O","Oxygen",8);a.F=new b("F","Fluorine",9);a.Ne=new b("Ne","Neon",10);a.Na=new b("Na","Sodium",11);a.Mg=new b("Mg","Magnesium",12);a.Al=new b("Al","Aluminum",13);a.Si=new b("Si","Silicon",14);
a.P=new b("P","Phosphorus",15);a.S=new b("S","Sulfur",16);a.Cl=new b("Cl","Chlorine",17);a.Ar=new b("Ar","Argon",18);a.K=new b("K","Potassium",19);a.Ca=new b("Ca","Calcium",20);a.Sc=new b("Sc","Scandium",21);a.Ti=new b("Ti","Titanium",22);a.V=new b("V","Vanadium",23);a.Cr=new b("Cr","Chromium",24);a.Mn=new b("Mn","Manganese",25);a.Fe=new b("Fe","Iron",26);a.Co=new b("Co","Cobalt",27);a.Ni=new b("Ni","Nickel",28);a.Cu=new b("Cu","Copper",29);a.Zn=new b("Zn","Zinc",30);a.Ga=new b("Ga","Gallium",31);
a.Ge=new b("Ge","Germanium",32);a.As=new b("As","Arsenic",33);a.Se=new b("Se","Selenium",34);a.Br=new b("Br","Bromine",35);a.Kr=new b("Kr","Krypton",36);a.Rb=new b("Rb","Rubidium",37);a.Sr=new b("Sr","Strontium",38);a.Y=new b("Y","Yttrium",39);a.Zr=new b("Zr","Zirconium",40);a.Nb=new b("Nb","Niobium",41);a.Mo=new b("Mo","Molybdenum",42);a.Tc=new b("Tc","Technetium",43);a.Ru=new b("Ru","Ruthenium",44);a.Rh=new b("Rh","Rhodium",45);a.Pd=new b("Pd","Palladium",46);a.Ag=new b("Ag","Silver",47);a.Cd=new b("Cd",
"Cadmium",48);a.In=new b("In","Indium",49);a.Sn=new b("Sn","Tin",50);a.Sb=new b("Sb","Antimony",51);a.Te=new b("Te","Tellurium",52);a.I=new b("I","Iodine",53);a.Xe=new b("Xe","Xenon",54);a.Cs=new b("Cs","Cesium",55);a.Ba=new b("Ba","Barium",56);a.La=new b("La","Lanthanum",57);a.Ce=new b("Ce","Cerium",58);a.Pr=new b("Pr","Praseodymium",59);a.Nd=new b("Nd","Neodymium",60);a.Pm=new b("Pm","Promethium",61);a.Sm=new b("Sm","Samarium",62);a.Eu=new b("Eu","Europium",63);a.Gd=new b("Gd","Gadolinium",64);
a.Tb=new b("Tb","Terbium",65);a.Dy=new b("Dy","Dysprosium",66);a.Ho=new b("Ho","Holmium",67);a.Er=new b("Er","Erbium",68);a.Tm=new b("Tm","Thulium",69);a.Yb=new b("Yb","Ytterbium",70);a.Lu=new b("Lu","Lutetium",71);a.Hf=new b("Hf","Hafnium",72);a.Ta=new b("Ta","Tantalum",73);a.W=new b("W","Tungsten",74);a.Re=new b("Re","Rhenium",75);a.Os=new b("Os","Osmium",76);a.Ir=new b("Ir","Iridium",77);a.Pt=new b("Pt","Platinum",78);a.Au=new b("Au","Gold",79);a.Hg=new b("Hg","Mercury",80);a.Tl=new b("Tl","Thallium",
81);a.Pb=new b("Pb","Lead",82);a.Bi=new b("Bi","Bismuth",83);a.Po=new b("Po","Polonium",84);a.At=new b("At","Astatine",85);a.Rn=new b("Rn","Radon",86);a.Fr=new b("Fr","Francium",87);a.Ra=new b("Ra","Radium",88);a.Ac=new b("Ac","Actinium",89);a.Th=new b("Th","Thorium",90);a.Pa=new b("Pa","Protactinium",91);a.U=new b("U","Uranium",92);a.Np=new b("Np","Neptunium",93);a.Pu=new b("Pu","Plutonium",94);a.Am=new b("Am","Americium",95);a.Cm=new b("Cm","Curium",96);a.Bk=new b("Bk","Berkelium",97);a.Cf=new b("Cf",
"Californium",98);a.Es=new b("Es","Einsteinium",99);a.Fm=new b("Fm","Fermium",100);a.Md=new b("Md","Mendelevium",101);a.No=new b("No","Nobelium",102);a.Lr=new b("Lr","Lawrencium",103);a.Rf=new b("Rf","Rutherfordium",104);a.Db=new b("Db","Dubnium",105);a.Sg=new b("Sg","Seaborgium",106);a.Bh=new b("Bh","Bohrium",107);a.Hs=new b("Hs","Hassium",108);a.Mt=new b("Mt","Meitnerium",109);a.Ds=new b("Ds","Darmstadtium",110);a.Rg=new b("Rg","Roentgenium",111);a.Cn=new b("Cn","Copernicium",112);a.Uut=new b("Uut",
"Ununtrium",113);a.Uuq=new b("Uuq","Ununquadium",114);a.Uup=new b("Uup","Ununpentium",115);a.Uuh=new b("Uuh","Ununhexium",116);a.Uus=new b("Uus","Ununseptium",117);a.Uuo=new b("Uuo","Ununoctium",118);a.B.addH=!0;a.C.addH=!0;a.N.addH=!0;a.O.addH=!0;a.F.addH=!0;a.Si.addH=!0;a.P.addH=!0;a.S.addH=!0;a.Cl.addH=!0;a.As.addH=!0;a.Se.addH=!0;a.Br.addH=!0;a.Te.addH=!0;a.I.addH=!0;a.At.addH=!0;a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";
a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor="#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor=
"#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";
a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor="#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor=
"#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";
a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor="#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor=
"#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor="#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";for(var f=0,g=d.length;f<g;f++)a[d[f]].pymolColor=a[d[f]].jmolColor;a.H.pymolColor="#E6E6E6";a.C.pymolColor="#33FF33";a.N.pymolColor="#3333FF";a.O.pymolColor="#FF4D4D";a.F.pymolColor="#B3FFFF";a.S.pymolColor="#E6C640";a.H.covalentRadius=
0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=
1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=
1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;
a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=
1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=
0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=
0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=
0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;
a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=
0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=
1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=
1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=
1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=
0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=
80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=
175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=
0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(){function d(a,f){this.symbol=a;this.name=f}var b=[];b.Ala=new d("Ala","Alanine");b.Arg=new d("Arg","Arginine");b.Asn=new d("Asn","Asparagine");b.Asp=new d("Asp","Aspartic Acid");b.Cys=new d("Cys","Cysteine");b.Gln=new d("Gln","Glutamine");b.Glu=new d("Glu","Glutamic Acid");b.Gly=new d("Gly","Glycine");b.His=new d("His","Histidine");b.Ile=new d("Ile","Isoleucine");b.Leu=new d("Leu","Leucine");b.Lys=new d("Lys","Lysine");b.Met=new d("Met","Methionine");b.Phe=new d("Phe",
"Phenylalanine");b.Pro=new d("Pro","Proline");b.Ser=new d("Ser","Serine");b.Thr=new d("Thr","Threonine");b.Trp=new d("Trp","Tryptophan");b.Tyr=new d("Tyr","Tyrosine");b.Val=new d("Val","Valine");b.Asx=new d("Asx","Asparagine/Aspartic Acid");b.Glx=new d("Glx","Glutamine/Glutamic Acid");b["*"]=new d("*","Other");b.A=new d("A","Adenine");b.G=new d("G","Guanine");b.I=new d("I","");b.C=new d("C","Cytosine");b.T=new d("T","Thymine");b.U=new d("U","Uracil");b.Ala.polar=!1;b.Arg.polar=!0;b.Asn.polar=!0;b.Asp.polar=
!0;b.Cys.polar=!0;b.Gln.polar=!0;b.Glu.polar=!0;b.Gly.polar=!1;b.His.polar=!0;b.Ile.polar=!1;b.Leu.polar=!1;b.Lys.polar=!0;b.Met.polar=!1;b.Phe.polar=!1;b.Pro.polar=!1;b.Ser.polar=!0;b.Thr.polar=!0;b.Trp.polar=!0;b.Tyr.polar=!0;b.Val.polar=!1;b.Asx.polar=!0;b.Glx.polar=!0;b.Ala.aminoColor="#C8C8C8";b.Arg.aminoColor="#145AFF";b.Asn.aminoColor="#00DCDC";b.Asp.aminoColor="#E60A0A";b.Cys.aminoColor="#E6E600";b.Gln.aminoColor="#00DCDC";b.Glu.aminoColor="#E60A0A";b.Gly.aminoColor="#EBEBEB";b.His.aminoColor=
"#8282D2";b.Ile.aminoColor="#0F820F";b.Leu.aminoColor="#0F820F";b.Lys.aminoColor="#145AFF";b.Met.aminoColor="#E6E600";b.Phe.aminoColor="#3232AA";b.Pro.aminoColor="#DC9682";b.Ser.aminoColor="#FA9600";b.Thr.aminoColor="#FA9600";b.Trp.aminoColor="#B45AB4";b.Tyr.aminoColor="#3232AA";b.Val.aminoColor="#0F820F";b.Asx.aminoColor="#FF69B4";b.Glx.aminoColor="#FF69B4";b["*"].aminoColor="#BEA06E";b.A.aminoColor="#BEA06E";b.G.aminoColor="#BEA06E";b.I.aminoColor="#BEA06E";b.C.aminoColor="#BEA06E";b.T.aminoColor=
"#BEA06E";b.U.aminoColor="#BEA06E";b.Ala.shapelyColor="#8CFF8C";b.Arg.shapelyColor="#00007C";b.Asn.shapelyColor="#FF7C70";b.Asp.shapelyColor="#A00042";b.Cys.shapelyColor="#FFFF70";b.Gln.shapelyColor="#FF4C4C";b.Glu.shapelyColor="#660000";b.Gly.shapelyColor="#FFFFFF";b.His.shapelyColor="#7070FF";b.Ile.shapelyColor="#004C00";b.Leu.shapelyColor="#455E45";b.Lys.shapelyColor="#4747B8";b.Met.shapelyColor="#B8A042";b.Phe.shapelyColor="#534C52";b.Pro.shapelyColor="#525252";b.Ser.shapelyColor="#FF7042";b.Thr.shapelyColor=
"#B84C00";b.Trp.shapelyColor="#4F4600";b.Tyr.shapelyColor="#8C704C";b.Val.shapelyColor="#FF8CFF";b.Asx.shapelyColor="#FF00FF";b.Glx.shapelyColor="#FF00FF";b["*"].shapelyColor="#FF00FF";b.A.shapelyColor="#A0A0FF";b.G.shapelyColor="#FF7070";b.I.shapelyColor="#80FFFF";b.C.shapelyColor="#FF8C4B";b.T.shapelyColor="#A0FFA0";b.U.shapelyColor="#FF8080";return b}();
(function(d){d.Queue=function(){this.queue=[]};d=d.Queue.prototype;d.queueSpace=0;d.getSize=function(){return this.queue.length-this.queueSpace};d.isEmpty=function(){return 0===this.queue.length};d.enqueue=function(b){this.queue.push(b)};d.dequeue=function(){var b;this.queue.length&&(b=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0));return b};d.getOldestElement=function(){var b;this.queue.length&&(b=this.queue[this.queueSpace]);
return b}})(ChemDoodle.structures);
(function(d,b){d.Point=function(a,g){this.x=a?a:0;this.y=g?g:0};var a=d.Point.prototype;a.sub=function(a){this.x-=a.x;this.y-=a.y};a.add=function(a){this.x+=a.x;this.y+=a.y};a.distance=function(a){var g=a.x-this.x;a=a.y-this.y;return b.sqrt(g*g+a*a)};a.angleForStupidCanvasArcs=function(a){var g=a.x-this.x;a=a.y-this.y;for(var e=0,e=0===g?0===a?0:0<a?b.PI/2:3*b.PI/2:0===a?0<g?0:b.PI:0>g?b.atan(a/g)+b.PI:0>a?b.atan(a/g)+2*b.PI:b.atan(a/g);0>e;)e+=2*b.PI;return e%=2*b.PI};a.angle=function(a){var g=a.x-
this.x;a=this.y-a.y;for(var e=0,e=0===g?0===a?0:0<a?b.PI/2:3*b.PI/2:0===a?0<g?0:b.PI:0>g?b.atan(a/g)+b.PI:0>a?b.atan(a/g)+2*b.PI:b.atan(a/g);0>e;)e+=2*b.PI;return e%=2*b.PI}})(ChemDoodle.structures,Math);
(function(d,b,a,f,g,e){f.Atom=function(a,c,j,e){this.label=a?a.replace(/\s/g,""):"C";d[this.label]||(this.label="C");this.x=c?c:0;this.y=j?j:0;this.z=e?e:0};f=f.Atom.prototype=new f.Point(0,0);f.charge=0;f.numLonePair=0;f.numRadical=0;f.mass=-1;f.coordinationNumber=0;f.bondNumber=0;f.angleOfLeastInterference=0;f.isHidden=!1;f.altLabel=void 0;f.any=!1;f.rgroup=-1;f.isLone=!1;f.isHover=!1;f.isSelected=!1;f.add3D=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z};f.sub3D=function(a){this.x-=a.x;this.y-=
a.y;this.z-=a.z};f.distance3D=function(a){var c=a.x-this.x,j=a.y-this.y;a=a.z-this.z;return g.sqrt(c*c+j*j+a*a)};f.draw=function(e,c){if(this.isLassoed){var j=e.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);j.addColorStop(0,"rgba(212, 99, 0, 0)");j.addColorStop(0.7,"rgba(212, 99, 0, 0.8)");e.fillStyle=j;e.beginPath();e.arc(this.x,this.y,5,0,2*g.PI,!1);e.fill()}this.textBounds=[];this.specs&&(c=this.specs);var f=c.getFontString(c.atoms_font_size_2D,c.atoms_font_families_2D,c.atoms_font_bold_2D,
c.atoms_font_italic_2D);e.font=f;e.fillStyle=c.atoms_color;!this.any&&-1===this.rgroup&&(c.atoms_useJMOLColors?e.fillStyle=d[this.label].jmolColor:c.atoms_usePYMOLColors&&(e.fillStyle=d[this.label].pymolColor));var n;if(this.isLone&&!c.atoms_displayAllCarbonLabels_2D||c.atoms_circles_2D)e.beginPath(),e.arc(this.x,this.y,c.atoms_circleDiameter_2D/2,0,2*g.PI,!1),e.fill(),0<c.atoms_circleBorderWidth_2D&&(e.lineWidth=c.atoms_circleBorderWidth_2D,e.strokeStyle="black",e.stroke(this.x,this.y,0,2*g.PI,c.atoms_circleDiameter_2D/
2));else if(this.isLabelVisible(c))if(e.textAlign="center",e.textBaseline="middle",void 0!==this.altLabel){e.fillText(this.altLabel,this.x,this.y);var h=e.measureText(this.altLabel).width;this.textBounds.push({x:this.x-h/2,y:this.y-c.atoms_font_size_2D/2+1,w:h,h:c.atoms_font_size_2D-2})}else if(this.any)e.font=c.getFontString(c.atoms_font_size_2D+5,c.atoms_font_families_2D,!0),e.fillText("*",this.x+1,this.y+3),h=e.measureText("*").width,this.textBounds.push({x:this.x-h/2,y:this.y-c.atoms_font_size_2D/
2+1,w:h,h:c.atoms_font_size_2D-2});else if(-1!==this.rgroup)j="R"+this.rgroup,e.fillText(j,this.x,this.y),h=e.measureText(j).width,this.textBounds.push({x:this.x-h/2,y:this.y-c.atoms_font_size_2D/2+1,w:h,h:c.atoms_font_size_2D-2});else{e.fillText(this.label,this.x,this.y);h=e.measureText(this.label).width;this.textBounds.push({x:this.x-h/2,y:this.y-c.atoms_font_size_2D/2+1,w:h,h:c.atoms_font_size_2D-2});var l=0;if(-1!==this.mass){var o=c.getFontString(0.7*c.atoms_font_size_2D,c.atoms_font_families_2D,
c.atoms_font_bold_2D,c.atoms_font_italic_2D),j=e.font;e.font=c.getFontString(0.7*c.atoms_font_size_2D,c.atoms_font_families_2D,c.atoms_font_bold_2D,c.atoms_font_italic_2D);l=e.measureText(this.mass).width;e.fillText(this.mass,this.x-l-0.5,this.y-c.atoms_font_size_2D/2+1);this.textBounds.push({x:this.x-h/2-l-0.5,y:this.y-1.7*c.atoms_font_size_2D/2+1,w:l,h:c.atoms_font_size_2D/2-1});e.font=j}var j=h/2,v=this.getImplicitHydrogenCount();if(c.atoms_implicitHydrogens_2D&&0<v){n=0;var k=e.measureText("H").width,
t=!0;if(1<v){var u=h/2+k/2,q=0,o=c.getFontString(0.8*c.atoms_font_size_2D,c.atoms_font_families_2D,c.atoms_font_bold_2D,c.atoms_font_italic_2D);e.font=o;var r=e.measureText(v).width;1===this.bondNumber?this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2&&(u=-h/2-r-k/2-l/2,t=!1,n=g.PI):this.angleOfLeastInterference<=g.PI/4||(this.angleOfLeastInterference<3*g.PI/4?(u=0,q=0.9*-c.atoms_font_size_2D,0!==this.charge&&(q-=0.3*c.atoms_font_size_2D),t=!1,n=g.PI/2):this.angleOfLeastInterference<=
5*g.PI/4?(u=-h/2-r-k/2-l/2,t=!1,n=g.PI):this.angleOfLeastInterference<7*g.PI/4&&(u=0,q=0.9*c.atoms_font_size_2D,t=!1,n=3*g.PI/2));e.font=f;e.fillText("H",this.x+u,this.y+q);e.font=o;e.fillText(v,this.x+u+k/2+r/2,this.y+q+0.3*c.atoms_font_size_2D);this.textBounds.push({x:this.x+u-k/2,y:this.y+q-c.atoms_font_size_2D/2+1,w:k,h:c.atoms_font_size_2D-2});this.textBounds.push({x:this.x+u+k/2,y:this.y+q+0.3*c.atoms_font_size_2D-c.atoms_font_size_2D/2+1,w:r,h:0.8*c.atoms_font_size_2D-2})}else u=h/2+k/2,q=
0,1===this.bondNumber?this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2&&(u=-h/2-k/2-l/2,n=g.PI):this.angleOfLeastInterference<=g.PI/4||(this.angleOfLeastInterference<3*g.PI/4?(u=0,q=0.9*-c.atoms_font_size_2D,t=!1,n=g.PI/2):this.angleOfLeastInterference<=5*g.PI/4?(u=-h/2-k/2-l/2,t=!1,n=g.PI):this.angleOfLeastInterference<7*g.PI/4&&(u=0,q=0.9*c.atoms_font_size_2D,t=!1,n=3*g.PI/2)),e.fillText("H",this.x+u,this.y+q),this.textBounds.push({x:this.x+u-k/2,y:this.y+q-c.atoms_font_size_2D/
2+1,w:k,h:c.atoms_font_size_2D-2});t&&(j+=k)}0!==this.charge&&(f=this.charge.toFixed(0),f="1"===f?"+":"-1"===f?"\u2013":b.stringStartsWith(f,"-")?f.substring(1)+"\u2013":f+"+",h=e.measureText(f).width,j+=h/2,e.textAlign="center",e.textBaseline="middle",e.font=c.getFontString(g.floor(0.8*c.atoms_font_size_2D),c.atoms_font_families_2D,c.atoms_font_bold_2D,c.atoms_font_italic_2D),e.fillText(f,this.x+j-1,this.y-c.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+j-h/2-1,y:this.y-1.8*c.atoms_font_size_2D/
2+5,w:h,h:c.atoms_font_size_2D/2-1}))}if(0<this.numLonePair||0<this.numRadical)e.fillStyle="black",f=this.angles.slice(0),j=this.angleOfLeastInterference,h=this.largestAngle,void 0!==n&&(f.push(n),f.sort(),f=a.angleBetweenLargest(f),j=f.angle%(2*g.PI),h=f.largest),2===this.bondNumber&&void 0===n&&g.abs(h-g.PI)<g.PI/60?0===this.numRadical?(this.drawElectrons(e,c,g.floor(this.numLonePair/2),0,j,h,n),this.drawElectrons(e,c,g.floor(this.numLonePair/2)+this.numLonePair%2,0,j+g.PI,h,n)):0===this.numLonePair?
(this.drawElectrons(e,c,0,g.floor(this.numRadical/2),j,h,n),this.drawElectrons(e,c,0,g.floor(this.numRadical/2)+this.numRadical%2,j+g.PI,h,n)):(this.drawElectrons(e,c,this.numLonePair,0,j,h,n),this.drawElectrons(e,c,0,this.numRadical,j+g.PI,h,n)):this.drawElectrons(e,c,this.numLonePair,this.numRadical,j,h,n)};f.drawElectrons=function(a,c,j,e,f,b,d){d=b/(j+e+(0===this.bonds.length&&void 0===d?0:1));b=f-b/2+d;for(var o=0;o<j;o++){f=b+o*d;var v=this.x+Math.cos(f)*c.atoms_lonePairDistance_2D,k=this.y-
Math.sin(f)*c.atoms_lonePairDistance_2D,t=f+Math.PI/2;f=Math.cos(t)*c.atoms_lonePairSpread_2D/2;t=-Math.sin(t)*c.atoms_lonePairSpread_2D/2;a.beginPath();a.arc(v+f,k+t,c.atoms_lonePairDiameter_2D,0,2*g.PI,!1);a.fill();a.beginPath();a.arc(v-f,k-t,c.atoms_lonePairDiameter_2D,0,2*g.PI,!1);a.fill()}for(o=0;o<e;o++)f=b+(o+j)*d,v=this.x+Math.cos(f)*c.atoms_lonePairDistance_2D,k=this.y-Math.sin(f)*c.atoms_lonePairDistance_2D,a.beginPath(),a.arc(v,k,c.atoms_lonePairDiameter_2D,0,2*g.PI,!1),a.fill()};f.drawDecorations=
function(a){if(this.isHover||this.isSelected)a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,this.isHover?7:15,0,2*g.PI,!1),a.stroke();this.isOverlap&&(a.strokeStyle="#C10000",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,7,0,2*g.PI,!1),a.stroke())};f.render=function(a,c){this.specs&&(c=this.specs);var j=e.translate(a.modelViewMatrix,[this.x,this.y,this.z],[]),f=c.atoms_useVDWDiameters_3D?d[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/
2;0===f&&(f=1);e.scale(j,[f,f,f]);f=c.atoms_color;c.atoms_useJMOLColors?f=d[this.label].jmolColor:c.atoms_usePYMOLColors&&(f=d[this.label].pymolColor);a.material.setDiffuseColor(f);a.setMatrixUniforms(j);a.drawElements(a.TRIANGLES,(this.renderAsStar?a.starBuffer:a.sphereBuffer).vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)};f.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||(this.any||-1!==this.rgroup)||(-1!==this.mass||0!==this.charge)||a.atoms_showAttributedCarbons_2D&&
(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1};f.getImplicitHydrogenCount=function(){if("H"===this.label||!d[this.label]||!d[this.label].addH)return 0;var a=d[this.label].valency,c=a-this.coordinationNumber;0<this.numRadical&&(c=g.max(0,c-this.numRadical));0<this.charge?(a=4-a,c=this.charge<=a?c+this.charge:4-this.coordinationNumber-this.charge+a):c+=this.charge;return 0>c?0:g.floor(c)};f.getBounds=
function(){var e=new a.Bounds;e.expand(this.x,this.y);if(this.textBounds)for(var c=0,j=this.textBounds.length;c<j;c++){var f=this.textBounds[c];e.expand(f.x,f.y,f.x+f.w,f.y+f.h)}return e};f.getBounds3D=function(){var e=new a.Bounds;e.expand3D(this.x,this.y,this.z);return e}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,mat4);
(function(d,b,a,f,g,e,m){a.Bond=function(a,c,e){this.a1=a;this.a2=c;this.bondOrder=void 0!==e?e:1};a.Bond.STEREO_NONE="none";a.Bond.STEREO_PROTRUDING="protruding";a.Bond.STEREO_RECESSED="recessed";a.Bond.STEREO_AMBIGUOUS="ambiguous";var c=a.Bond.prototype;c.stereo=a.Bond.STEREO_NONE;c.isHover=!1;c.ring=void 0;c.getCenter=function(){return new a.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};c.getLength=function(){return this.a1.distance(this.a2)};c.getLength3D=function(){return this.a1.distance3D(this.a2)};
c.contains=function(a){return a===this.a1||a===this.a2};c.getNeighbor=function(a){if(a===this.a1)return this.a2;if(a===this.a2)return this.a1};c.draw=function(c,e){if(!(this.a1.x===this.a2.x&&this.a1.y===this.a2.y)){this.specs&&(e=this.specs);var m=this.a1.x,h=this.a2.x,l=this.a1.y,o=this.a2.y,v=this.a1.distance(this.a2),k=h-m,t=o-l;if(this.a1.isLassoed&&this.a2.isLassoed){var u=c.createLinearGradient(m,l,h,o);u.addColorStop(0,"rgba(212, 99, 0, 0)");u.addColorStop(0.5,"rgba(212, 99, 0, 0.8)");u.addColorStop(1,
"rgba(212, 99, 0, 0)");var q=2.5,r=this.a1.angle(this.a2)+g.PI/2,p=g.cos(r),r=g.sin(r),y=m-p*q,z=l+r*q,x=m+p*q,A=l-r*q,C=h+p*q,F=o-r*q,p=h-p*q,r=o+r*q;c.fillStyle=u;c.beginPath();c.moveTo(y,z);c.lineTo(x,A);c.lineTo(C,F);c.lineTo(p,r);c.closePath();c.fill()}if(e.atoms_display&&!e.atoms_circles_2D&&this.a1.isLabelVisible(e)&&this.a1.textBounds){q=p=0;for(y=this.a1.textBounds.length;q<y;q++)p=Math.max(p,f.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[q]));p+=e.bonds_atomLabelBuffer_2D;
p/=v;m+=k*p;l+=t*p}if(e.atoms_display&&!e.atoms_circles_2D&&this.a2.isLabelVisible(e)&&this.a2.textBounds){q=p=0;for(y=this.a2.textBounds.length;q<y;q++)p=Math.max(p,f.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[q]));p+=e.bonds_atomLabelBuffer_2D;p/=v;h-=k*p;o-=t*p}e.bonds_clearOverlaps_2D&&(p=m+0.15*k,r=l+0.15*t,q=h-0.15*k,v=o-0.15*t,c.strokeStyle=e.backgroundColor,c.lineWidth=e.bonds_width_2D+2*e.bonds_overlapClearWidth_2D,c.lineCap="round",c.beginPath(),c.moveTo(p,r),c.lineTo(q,
v),c.closePath(),c.stroke());c.strokeStyle=e.bonds_color;c.fillStyle=e.bonds_color;c.lineWidth=e.bonds_width_2D;c.lineCap=e.bonds_ends_2D;if(e.bonds_useJMOLColors||e.bonds_usePYMOLColors)p=c.createLinearGradient(m,l,h,o),r=d[this.a1.label].jmolColor,q=d[this.a2.label].jmolColor,e.atoms_usePYMOLColors&&(r=d[this.a1.label].pymolColor,q=d[this.a2.label].pymolColor),p.addColorStop(0,r),e.bonds_colorGradient||(p.addColorStop(0.5,r),p.addColorStop(0.51,q)),p.addColorStop(1,q),c.strokeStyle=p,c.fillStyle=
p;switch(this.bondOrder){case 0:h-=m;o-=l;h=g.sqrt(h*h+o*o);o=g.floor(h/e.bonds_dotSize_2D);h=(h-(o-1)*e.bonds_dotSize_2D)/2;1===o%2?h+=e.bonds_dotSize_2D/4:(h-=e.bonds_dotSize_2D/4,o+=2);o/=2;t=this.a1.angle(this.a2);p=m+h*Math.cos(t);r=l-h*Math.sin(t);c.beginPath();for(q=0;q<o;q++)c.arc(p,r,e.bonds_dotSize_2D/2,0,2*g.PI,!1),p+=2*e.bonds_dotSize_2D*Math.cos(t),r-=2*e.bonds_dotSize_2D*Math.sin(t);c.fill();break;case 0.5:c.beginPath();c.moveTo(m,l);b.contextHashTo(c,m,l,h,o,e.bonds_hashSpacing_2D,
e.bonds_hashSpacing_2D);c.stroke();break;case 1:if(this.stereo===a.Bond.STEREO_PROTRUDING||this.stereo===a.Bond.STEREO_RECESSED)t=e.bonds_width_2D/2,q=this.a1.distance(this.a2)*e.bonds_wedgeThickness_2D/2,r=this.a1.angle(this.a2)+g.PI/2,p=g.cos(r),r=g.sin(r),y=m-p*t,z=l+r*t,x=m+p*t,A=l-r*t,C=h+p*q,F=o-r*q,p=h-p*q,r=o+r*q,c.beginPath(),c.moveTo(y,z),c.lineTo(x,A),c.lineTo(C,F),c.lineTo(p,r),c.closePath(),this.stereo===a.Bond.STEREO_PROTRUDING?c.fill():(c.save(),c.clip(),c.lineWidth=2*q,c.lineCap="butt",
c.beginPath(),c.moveTo(m,l),b.contextHashTo(c,m,l,h,o,e.bonds_hashWidth_2D,e.bonds_hashSpacing_2D),c.stroke(),c.restore());else if(this.stereo===a.Bond.STEREO_AMBIGUOUS){c.beginPath();c.moveTo(m,l);h=g.floor(g.sqrt(k*k+t*t)/e.bonds_wavyLength_2D);r=this.a1.angle(this.a2)+g.PI/2;p=g.cos(r);r=g.sin(r);o=k/h;t/=h;q=0;for(y=h;q<y;q++)m+=o,l+=t,h=e.bonds_wavyLength_2D*p+m-0.5*o,v=e.bonds_wavyLength_2D*-r+l-0.5*t,k=e.bonds_wavyLength_2D*-p+m-0.5*o,z=e.bonds_wavyLength_2D*r+l-0.5*t,0===q%2?c.quadraticCurveTo(h,
v,m,l):c.quadraticCurveTo(k,z,m,l);c.stroke();break}else c.beginPath(),c.moveTo(m,l),c.lineTo(h,o),c.stroke();break;case 1.5:case 2:this.stereo===a.Bond.STEREO_AMBIGUOUS?(q=this.a1.distance(this.a2)*e.bonds_saturationWidth_2D/2,r=this.a1.angle(this.a2)+g.PI/2,p=g.cos(r),r=g.sin(r),y=m-p*q,z=l+r*q,x=m+p*q,A=l-r*q,C=h+p*q,F=o-r*q,p=h-p*q,r=o+r*q,c.beginPath(),c.moveTo(y,z),c.lineTo(C,F),c.moveTo(x,A),c.lineTo(p,r),c.stroke()):!e.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?
(c.beginPath(),c.moveTo(m,l),c.lineTo(h,o),p=0,v=this.a1.distance(this.a2),t=this.a1.angle(this.a2),r=t+g.PI/2,q=v*e.bonds_saturationWidth_2D,k=e.bonds_saturationAngle_2D,k<g.PI/2&&(p=-(q/g.tan(k))),g.abs(p)<v/2&&(k=m-g.cos(t)*p,m=h+g.cos(t)*p,h=l+g.sin(t)*p,l=o-g.sin(t)*p,p=g.cos(r),r=g.sin(r),y=k-p*q,z=h+r*q,x=k+p*q,A=h-r*q,C=m-p*q,F=l+r*q,p=m+p*q,r=l-r*q,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>
g.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-g.PI?(c.moveTo(y,z),2===this.bondOrder?c.lineTo(C,F):b.contextHashTo(c,y,z,C,F,e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D)):(c.moveTo(x,A),2===this.bondOrder?c.lineTo(p,r):b.contextHashTo(c,x,A,p,r,e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D)),c.stroke())):(q=this.a1.distance(this.a2)*e.bonds_saturationWidth_2D/2,r=this.a1.angle(this.a2)+g.PI/2,p=g.cos(r),r=g.sin(r),y=m-p*q,z=l+r*q,x=m+p*q,A=l-r*q,C=h+p*q,F=o-r*q,p=h-p*q,
r=o+r*q,c.beginPath(),c.moveTo(y,z),c.lineTo(p,r),c.moveTo(x,A),2===this.bondOrder?c.lineTo(C,F):b.contextHashTo(c,x,A,C,F,e.bonds_hashSpacing_2D,e.bonds_hashSpacing_2D),c.stroke());break;case 3:q=this.a1.distance(this.a2)*e.bonds_saturationWidth_2D,r=this.a1.angle(this.a2)+g.PI/2,p=g.cos(r),r=g.sin(r),y=m-p*q,z=l+r*q,x=m+p*q,A=l-r*q,C=h+p*q,F=o-r*q,p=h-p*q,r=o+r*q,c.beginPath(),c.moveTo(y,z),c.lineTo(p,r),c.moveTo(x,A),c.lineTo(C,F),c.moveTo(m,l),c.lineTo(h,o),c.stroke()}}};c.drawDecorations=function(a){if(this.isHover||
this.isSelected){var c=2*g.PI,e=(this.a1.angleForStupidCanvasArcs(this.a2)+g.PI/2)%c;a.strokeStyle=this.isHover?"#885110":"#0060B2";a.lineWidth=1.2;a.beginPath();var f=(e+g.PI)%c,f=f%(2*g.PI);a.arc(this.a1.x,this.a1.y,7,e,f,!1);a.stroke();a.beginPath();e+=g.PI;f=(e+g.PI)%c;a.arc(this.a2.x,this.a2.y,7,e,f,!1);a.stroke()}};c.render=function(a,c){this.specs&&(c=this.specs);var f=(c.bonds_renderAsLines_3D?1.1:1.001)*this.a1.distance3D(this.a2)/(c.bonds_useJMOLColors||c.bonds_usePYMOLColors?2:1);if(0!==
f){var f=[c.bonds_cylinderDiameter_3D/2,f,c.bonds_cylinderDiameter_3D/2],h=e.translate(a.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),l,o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(c.bonds_useJMOLColors||c.bonds_usePYMOLColors)m.scale(o,0.5),l=e.translate(a.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]);var v=[0],k;if(c.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:v=[-c.bonds_cylinderDiameter_3D,c.bonds_cylinderDiameter_3D];break;case 3:v=[-1.2*c.bonds_cylinderDiameter_3D,
0,1.2*c.bonds_cylinderDiameter_3D]}if(1<v.length){k=[0,0,1];var t=e.inverse(a.rotationMatrix,[]);e.multiplyVec3(t,k);k=m.cross(o,k,[]);m.normalize(k)}}var u=[0,1,0],t=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(t=g.PI)):(t=b.vec3AngleFrom(u,o),o=m.cross(u,o,[]));for(var u=0,q=v.length;u<q;u++){var r=e.set(h,[]);0!==v[u]&&e.translate(r,m.scale(k,v[u],[]));0!==t&&e.rotate(r,t,o);e.scale(r,f);var p=c.bonds_color;c.bonds_useJMOLColors?p=d[this.a1.label].jmolColor:c.bonds_usePYMOLColors&&
(p=d[this.a1.label].pymolColor);a.material.setDiffuseColor(p);a.setMatrixUniforms(r);c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems);if(c.bonds_useJMOLColors||c.bonds_usePYMOLColors)e.set(l,r),0!==v[u]&&e.translate(r,m.scale(k,v[u],[])),e.rotate(r,t+g.PI,o),e.scale(r,f),a.material.setDiffuseColor(c.bonds_usePYMOLColors?d[this.a2.label].pymolColor:d[this.a2.label].jmolColor),
a.setMatrixUniforms(r),c.bonds_renderAsLines_3D?a.drawArrays(a.LINES,0,a.lineBuffer.vertexPositionBuffer.numItems):a.drawArrays(a.TRIANGLE_STRIP,0,a.cylinderBuffer.vertexPositionBuffer.numItems)}}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,mat4,vec3);
(function(d,b){d.Ring=function(){this.atoms=[];this.bonds=[]};var a=d.Ring.prototype;a.center=void 0;a.setupBonds=function(){for(var a=0,g=this.bonds.length;a<g;a++)this.bonds[a].ring=this;this.center=this.getCenter()};a.getCenter=function(){for(var a=Infinity,g=Infinity,e=-Infinity,m=-Infinity,c=0,j=this.atoms.length;c<j;c++)a=b.min(this.atoms[c].x,a),g=b.min(this.atoms[c].y,g),e=b.max(this.atoms[c].x,e),m=b.max(this.atoms[c].y,m);return new d.Point((e+a)/2,(m+g)/2)}})(ChemDoodle.structures,Math);
(function(d,b,a,f,g){a.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[]};var e=a.Molecule.prototype;e.findRings=!0;e.draw=function(a,c){this.specs&&(c=this.specs);if(c.atoms_display&&!c.atoms_circles_2D)for(var e=0,f=this.atoms.length;e<f;e++)this.atoms[e].draw(a,c);if(c.bonds_display){e=0;for(f=this.bonds.length;e<f;e++)this.bonds[e].draw(a,c)}if(c.atoms_display&&c.atoms_circles_2D){e=0;for(f=this.atoms.length;e<f;e++)this.atoms[e].draw(a,c)}};e.render=function(e,c){this.specs&&(c=this.specs);
var j=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(j){if(c.macro_displayBonds){0<this.bonds.length&&(c.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(e.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(c.bonds_materialAmbientColor_3D,void 0,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));for(var g=0,b=
this.bonds.length;g<b;g++){var h=this.bonds[g];if(!h.a1.hetatm&&(-1===c.macro_atomToLigandDistance||void 0!==h.a1.closestDistance&&c.macro_atomToLigandDistance>=h.a1.closestDistance&&c.macro_atomToLigandDistance>=h.a2.closestDistance))h.render(e,this.residueSpecs?this.residueSpecs:c)}}if(c.macro_displayAtoms){0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(c.atoms_materialAmbientColor_3D,void 0,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));g=0;for(b=
this.atoms.length;g<b;g++){var d=this.atoms[g];if(!d.hetatm&&(-1===c.macro_atomToLigandDistance||void 0!==d.closestDistance&&c.macro_atomToLigandDistance>=d.closestDistance))d.render(e,this.residueSpecs?this.residueSpecs:c)}}}if(c.bonds_display){0<this.bonds.length&&(c.bonds_renderAsLines_3D?(e.lineWidth(c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(c.bonds_materialAmbientColor_3D,void 0,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));
g=0;for(b=this.bonds.length;g<b;g++)h=this.bonds[g],(!j||h.a1.hetatm)&&h.render(e,c)}if(c.atoms_display){g=0;for(b=this.atoms.length;g<b;g++)d=this.atoms[g],d.bondNumber=0,d.renderAsStar=!1;g=0;for(b=this.bonds.length;g<b;g++)h=this.bonds[g],h.a1.bondNumber++,h.a2.bondNumber++;0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(c.atoms_materialAmbientColor_3D,void 0,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));h=[];g=0;for(b=this.atoms.length;g<b;g++)if(d=
this.atoms[g],!j||d.hetatm&&(c.macro_showWater||!d.isWater))c.atoms_nonBondedAsStars_3D&&0===d.bondNumber?(d.renderAsStar=!0,h.push(d)):d.render(e,c);if(0<h.length){e.starBuffer.bindBuffers(e);g=0;for(b=h.length;g<b;g++)h[g].render(e,c)}}if(this.chains){e.setMatrixUniforms(e.modelViewMatrix);if(c.proteins_displayRibbon){e.material.setTempColors(c.proteins_materialAmbientColor_3D,void 0,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);j=0;for(d=this.ribbons.length;j<d;j++)if(c.proteins_useShapelyColors||
c.proteins_useAminoColors||c.proteins_usePolarityColors){h=c.proteins_ribbonCartoonize?this.cartoons[j]:this.ribbons[j];h.front.bindBuffers(e);g=0;for(b=h.front.segments.length;g<b;g++)h.front.segments[g].render(e,c);h.back.bindBuffers(e);g=0;for(b=h.back.segments.length;g<b;g++)h.back.segments[g].render(e,c)}else if(c.proteins_ribbonCartoonize){h=this.cartoons[j];h.front.bindBuffers(e);g=0;for(b=h.front.cartoonSegments.length;g<b;g++)h.front.cartoonSegments[g].render(e,c);h.back.bindBuffers(e);g=
0;for(b=h.back.cartoonSegments.length;g<b;g++)h.back.cartoonSegments[g].render(e,c)}else h=this.ribbons[j],h.front.render(e,c),h.back.render(e,c)}if(c.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]};j=0;for(d=this.chains.length;j<d;j++){var o=this.chains[j];if(!(2<o.length&&f[o[2].name]&&"#BEA06E"===f[o[2].name].aminoColor)&&0<o.length){g=1;for(b=o.length-2;g<b;g++)h=o[g].cp1,h.chainColor=o.chainColor,this.alphaCarbonTrace.nodes.push(h),h=new a.Bond(o[g].cp1,
o[g+1].cp1),h.residueName=o[g].name,h.chainColor=o.chainColor,this.alphaCarbonTrace.edges.push(h),g===o.length-3&&(h=o[g+1].cp1,h.chainColor=o.chainColor,this.alphaCarbonTrace.nodes.push(h))}}}if(0<this.alphaCarbonTrace.nodes.length){j=new a.VisualSpecifications;j.atoms_display=!0;j.bonds_display=!0;j.atoms_sphereDiameter_3D=c.proteins_backboneThickness;j.bonds_cylinderDiameter_3D=c.proteins_backboneThickness;j.bonds_useJMOLColors=!1;j.atoms_color=c.proteins_backboneColor;j.bonds_color=c.proteins_backboneColor;
j.atoms_useVDWDiameters_3D=!1;e.material.setTempColors(c.proteins_materialAmbientColor_3D,void 0,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);e.material.setDiffuseColor(c.proteins_backboneColor);g=0;for(b=this.alphaCarbonTrace.nodes.length;g<b;g++)h=this.alphaCarbonTrace.nodes[g],c.macro_colorByChain&&(j.atoms_color=h.chainColor),e.sphereBuffer.bindBuffers(e),h.render(e,j);g=0;for(b=this.alphaCarbonTrace.edges.length;g<b;g++){var d=this.alphaCarbonTrace.edges[g],v,h=f[d.residueName]?
f[d.residueName]:f["*"];c.macro_colorByChain?v=d.chainColor:c.proteins_useShapelyColors?v=h.shapelyColor:c.proteins_useAminoColors?v=h.aminoColor:c.proteins_usePolarityColors&&(v=h.polar?"#C10000":"#FFFFFF");v&&(j.bonds_color=v);e.cylinderBuffer.bindBuffers(e);d.render(e,j)}}}if(c.nucleics_display){e.material.setTempColors(c.nucleics_materialAmbientColor_3D,void 0,c.nucleics_materialSpecularColor_3D,c.nucleics_materialShininess_3D);j=0;for(d=this.tubes.length;j<d;j++)e.setMatrixUniforms(e.modelViewMatrix),
h=this.tubes[j],h.render(e,c)}}c.crystals_displayUnitCell&&this.unitCell&&(e.setMatrixUniforms(e.modelViewMatrix),this.unitCell.bindBuffers(e),e.material.setDiffuseColor(c.crystals_unitCellColor),e.lineWidth(c.crystals_unitCellLineWidth),e.drawElements(e.LINES,this.unitCell.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0));this.surface&&c.surfaces_display&&(e.setMatrixUniforms(e.modelViewMatrix),this.surface.bindBuffers(e),e.material.setTempColors(c.surfaces_materialAmbientColor_3D,c.surfaces_color,
c.surfaces_materialSpecularColor_3D,c.surfaces_materialShininess_3D),"Dot"===c.surfaces_style?e.drawArrays(e.POINTS,0,this.surface.vertexPositionBuffer.numItems):e.drawElements(e.TRIANGLES,this.surface.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0))};e.getCenter3D=function(){if(1===this.atoms.length)return new a.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var e=Infinity,c=Infinity,j=Infinity,f=-Infinity,b=-Infinity,h=-Infinity;if(this.chains)for(var d=0,o=this.chains.length;d<o;d++)for(var v=
this.chains[d],k=0,t=v.length;k<t;k++)var u=v[k],e=g.min(u.cp1.x,e),c=g.min(u.cp1.y,c),j=g.min(u.cp1.z,j),f=g.max(u.cp1.x,f),b=g.max(u.cp1.y,b),h=g.max(u.cp1.z,h),e=g.min(u.cp2.x,e),c=g.min(u.cp2.y,c),j=g.min(u.cp2.z,j),f=g.max(u.cp2.x,f),b=g.max(u.cp2.y,b),h=g.max(u.cp2.z,h);d=0;for(o=this.atoms.length;d<o;d++)e=g.min(this.atoms[d].x,e),c=g.min(this.atoms[d].y,c),j=g.min(this.atoms[d].z,j),f=g.max(this.atoms[d].x,f),b=g.max(this.atoms[d].y,b),h=g.max(this.atoms[d].z,h);return new a.Atom("C",(f+e)/
2,(b+c)/2,(h+j)/2)};e.getCenter=function(){if(1===this.atoms.length)return new a.Point(this.atoms[0].x,this.atoms[0].y);for(var e=Infinity,c=Infinity,j=-Infinity,f=-Infinity,b=0,d=this.atoms.length;b<d;b++)e=g.min(this.atoms[b].x,e),c=g.min(this.atoms[b].y,c),j=g.max(this.atoms[b].x,j),f=g.max(this.atoms[b].y,f);return new a.Point((j+e)/2,(f+c)/2)};e.getDimension=function(){if(1===this.atoms.length)return new a.Point(0,0);var e=Infinity,c=Infinity,j=-Infinity,f=-Infinity;if(this.chains){for(var b=
0,d=this.chains.length;b<d;b++)for(var l=this.chains[b],o=0,v=l.length;o<v;o++)var k=l[o],e=g.min(k.cp1.x,e),c=g.min(k.cp1.y,c),j=g.max(k.cp1.x,j),f=g.max(k.cp1.y,f),e=g.min(k.cp2.x,e),c=g.min(k.cp2.y,c),j=g.max(k.cp2.x,j),f=g.max(k.cp2.y,f);e-=30;c-=30;j+=30;f+=30}b=0;for(d=this.atoms.length;b<d;b++)e=g.min(this.atoms[b].x,e),c=g.min(this.atoms[b].y,c),j=g.max(this.atoms[b].x,j),f=g.max(this.atoms[b].y,f);return new a.Point(j-e,f-c)};e.check=function(a){if(a&&this.doChecks){if(this.findRings)if(this.bonds.length-
this.atoms.length!==this.fjNumCache){this.rings=(new d.informatics.SSSRFinder(this)).rings;for(var c=0,e=this.bonds.length;c<e;c++)this.bonds[c].ring=void 0;c=0;for(e=this.rings.length;c<e;c++)this.rings[c].setupBonds()}else{c=0;for(e=this.rings.length;c<e;c++){var f=this.rings[c];f.center=f.getCenter()}}c=0;for(e=this.atoms.length;c<e;c++)if(this.atoms[c].isLone=!1,"C"===this.atoms[c].label){for(var g=f=0,b=this.bonds.length;g<b;g++)(this.bonds[g].a1===this.atoms[c]||this.bonds[g].a2===this.atoms[c])&&
f++;0===f&&(this.atoms[c].isLone=!0)}f=!1;c=0;for(e=this.atoms.length;c<e;c++)0!==this.atoms[c].z&&(f=!0);f&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData();this.atomNumCache=this.atoms.length;this.bondNumCache=this.bonds.length;this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!a};e.getAngles=function(a){for(var c=[],e=0,f=this.bonds.length;e<f;e++)this.bonds[e].contains(a)&&c.push(a.angle(this.bonds[e].getNeighbor(a)));c.sort();return c};e.getCoordinationNumber=function(a){for(var c=
0,e=0,f=a.length;e<f;e++)c+=a[e].bondOrder;return c};e.getBonds=function(a){for(var c=[],e=0,f=this.bonds.length;e<f;e++)this.bonds[e].contains(a)&&c.push(this.bonds[e]);return c};e.sortAtomsByZ=function(){for(var a=1,c=this.atoms.length;a<c;a++)for(var e=a;0<e&&this.atoms[e].z<this.atoms[e-1].z;){var f=this.atoms[e];this.atoms[e]=this.atoms[e-1];this.atoms[e-1]=f;e--}};e.sortBondsByZ=function(){for(var a=1,c=this.bonds.length;a<c;a++)for(var e=a;0<e&&this.bonds[e].a1.z+this.bonds[e].a2.z<this.bonds[e-
1].a1.z+this.bonds[e-1].a2.z;){var f=this.bonds[e];this.bonds[e]=this.bonds[e-1];this.bonds[e-1]=f;e--}};e.setupMetaData=function(){for(var a=this.getCenter(),c=0,e=this.atoms.length;c<e;c++){var f=this.atoms[c];f.bonds=this.getBonds(f);f.angles=this.getAngles(f);f.isHidden=2===f.bonds.length&&g.abs(g.abs(f.angles[1]-f.angles[0])-g.PI)<g.PI/30&&f.bonds[0].bondOrder===f.bonds[1].bondOrder;var d=b.angleBetweenLargest(f.angles);f.angleOfLeastInterference=d.angle%(2*g.PI);f.largestAngle=d.largest;f.coordinationNumber=
this.getCoordinationNumber(f.bonds);f.bondNumber=f.bonds.length;f.molCenter=a}c=0;for(e=this.bonds.length;c<e;c++)this.bonds[c].molCenter=a};e.scaleToAverageBondLength=function(a){var c=this.getAverageBondLength();if(0!==c){a/=c;for(var c=0,e=this.atoms.length;c<e;c++)this.atoms[c].x*=a,this.atoms[c].y*=a}};e.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var a=0,c=0,e=this.bonds.length;c<e;c++)a+=this.bonds[c].getLength();return a/=this.bonds.length};e.getBounds=function(){for(var a=
new b.Bounds,c=0,e=this.atoms.length;c<e;c++)a.expand(this.atoms[c].getBounds());if(this.chains){c=0;for(e=this.chains.length;c<e;c++)for(var f=this.chains[c],g=0,d=f.length;g<d;g++){var l=f[g];a.expand(l.cp1.x,l.cp1.y);a.expand(l.cp2.x,l.cp2.y)}a.minX-=30;a.minY-=30;a.maxX+=30;a.maxY+=30}return a};e.getBounds3D=function(){for(var a=new b.Bounds,c=0,e=this.atoms.length;c<e;c++)a.expand(this.atoms[c].getBounds3D());if(this.chains){c=0;for(e=this.chains.length;c<e;c++)for(var f=this.chains[c],g=0,d=
f.length;g<d;g++){var l=f[g];a.expand3D(l.cp1.x,l.cp1.y,l.cp1.z);a.expand3D(l.cp2.x,l.cp2.y,l.cp2.z)}}return a}})(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);
(function(d,b,a,f){var g,e=-1;d.Residue=function(a){this.resSeq=a};var m=d.Residue.prototype;m.setup=function(a,e){this.horizontalResolution=e;var g=[a.x-this.cp1.x,a.y-this.cp1.y,a.z-this.cp1.z],b=f.cross(g,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=f.cross(b,g,[]);f.normalize(b);f.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];g=[(a.x+this.cp1.x)/2,(a.y+this.cp1.y)/2,(a.z+this.cp1.z)/2];this.helix&&(f.scale(b,1.5),f.add(g,b));this.guidePointsSmall[0]=
new d.Atom("",g[0]-this.D[0]/2,g[1]-this.D[1]/2,g[2]-this.D[2]/2);for(b=1;b<e;b++)this.guidePointsSmall[b]=new d.Atom("",this.guidePointsSmall[0].x+this.D[0]*b/e,this.guidePointsSmall[0].y+this.D[1]*b/e,this.guidePointsSmall[0].z+this.D[2]*b/e);f.scale(this.D,4);this.guidePointsLarge[0]=new d.Atom("",g[0]-this.D[0]/2,g[1]-this.D[1]/2,g[2]-this.D[2]/2);for(b=1;b<e;b++)this.guidePointsLarge[b]=new d.Atom("",this.guidePointsLarge[0].x+this.D[0]*b/e,this.guidePointsLarge[0].y+this.D[1]*b/e,this.guidePointsLarge[0].z+
this.D[2]*b/e)};m.getGuidePointSet=function(a){if(0===a)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1===a)return this.guidePointsSmall;if(2===a)return this.guidePointsLarge};m.computeLineSegments=function(c,f,b,d,h){if(h!==e){var m=h*h,o=h*h*h;g=a.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],[6/o,0,0,0,6/o,2/m,0,0,1/o,1/m,1/h,0,0,0,0,1],[]);e=h}this.split=f.helix!==this.helix||f.sheet!==this.sheet;this.lineSegments=this.innerCompute(0,c,f,b,
!1,h);d&&(this.lineSegmentsCartoon=this.innerCompute(f.helix||f.sheet?2:1,c,f,b,!0,h))};m.innerCompute=function(c,e,m,n,h,l){var o=[],v=this.getGuidePointSet(c);e=e.getGuidePointSet(c);m=m.getGuidePointSet(c);for(var k=n.getGuidePointSet(c),t=0,u=this.guidePointsLarge.length;t<u;t++){for(var q=a.multiply([e[t].x,e[t].y,e[t].z,1,v[t].x,v[t].y,v[t].z,1,m[t].x,m[t].y,m[t].z,1,k[t].x,k[t].y,k[t].z,1],g,[]),r=[],p=0;p<l;p++){for(c=3;0<c;c--)for(n=0;4>n;n++)q[4*c+n]+=q[4*(c-1)+n];r[p]=new d.Atom("",q[12]/
q[15],q[13]/q[15],q[14]/q[15])}o[t]=r}if(h&&this.arrow)for(c=0;c<l;c++){h=1.5-1.3*c/l;v=b.floor(this.horizontalResolution/2);e=o[v];n=0;for(m=o.length;n<m;n++)n!==v&&(k=e[c],t=o[n][c],u=[t.x-k.x,t.y-k.y,t.z-k.z],f.scale(u,h),t.x=k.x+u[0],t.y=k.y+u[1],t.z=k.z+u[2])}return o}})(ChemDoodle.structures,Math,mat4,vec3);
(function(d,b,a,f,g){b.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}};f=b.Spectrum.prototype;f.title=void 0;f.xUnit=void 0;f.yUnit=void 0;f.continuous=!0;f.integrationSensitivity=0.01;f.draw=function(a,f,c,b){this.specs&&(f=this.specs);var w=5,n=0,h=0;a.fillStyle=f.text_color;a.textAlign="center";a.textBaseline="alphabetic";a.font=f.getFontString(f.text_font_size,f.text_font_families);
this.xUnit&&(h+=f.text_font_size,a.fillText(this.xUnit,c/2,b-2));this.yUnit&&f.plots_showYAxis&&(n+=f.text_font_size,a.save(),a.translate(f.text_font_size,b/2),a.rotate(-g.PI/2),a.fillText(this.yUnit,0,0),a.restore());this.title&&(w+=f.text_font_size,a.fillText(this.title,c/2,f.text_font_size));h+=5+f.text_font_size;f.plots_showYAxis&&(n+=5+a.measureText("1000").width);f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,a.strokeRect(n,w,c-n,b-h-w));a.textAlign="center";
a.textBaseline="top";for(var l=this.maxX-this.minX,o=l/100,v=0.001;v<o||25<l/v;)v*=10;for(var k=0,t=f.plots_flipXAxis?c:0,l=g.round(this.minX/v)*v;l<=this.maxX;l+=v/2){var u=this.getTransformedX(l,f,c,n);if(u>n)if(a.strokeStyle="black",a.lineWidth=1,0===k%2){a.beginPath();a.moveTo(u,b-h);a.lineTo(u,b-h+2);a.stroke();for(o=l.toFixed(5);"0"===o.charAt(o.length-1);)o=o.substring(0,o.length-1);"."===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));var q=a.measureText(o).width;f.plots_flipXAxis&&(q*=
-1);var r=u-q/2;if(f.plots_flipXAxis?r<t:r>t)a.fillText(o,u,b-h+2),t=u+q/2;f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,a.beginPath(),a.moveTo(u,b-h),a.lineTo(u,w),a.stroke())}else a.beginPath(),a.moveTo(u,b-h),a.lineTo(u,b-h+2),a.stroke();k++}if(f.plots_showYAxis||f.plots_showGrid){v=1/f.scale;a.textAlign="right";a.textBaseline="middle";for(l=0;10>=l;l++)if(o=v/10*l,k=w+(b-h-w)*(1-o*f.scale),f.plots_showGrid&&(a.strokeStyle=f.plots_gridColor,a.lineWidth=f.plots_gridLineWidth,
a.beginPath(),a.moveTo(n,k),a.lineTo(c,k),a.stroke()),f.plots_showYAxis){a.strokeStyle="black";a.lineWidth=1;a.beginPath();a.moveTo(n,k);a.lineTo(n-3,k);a.stroke();o*=100;t=g.max(0,3-g.floor(o).toString().length);o=o.toFixed(t);if(0<t)for(;"0"===o.charAt(o.length-1);)o=o.substring(0,o.length-1);"."===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));a.fillText(o,n-3,k)}}a.strokeStyle="black";a.lineWidth=1;a.beginPath();a.moveTo(c,b-h);a.lineTo(n,b-h);f.plots_showYAxis&&a.lineTo(n,w);a.stroke();
if(0<this.dataDisplay.length){a.textAlign="left";a.textBaseline="top";l=o=0;for(v=this.dataDisplay.length;l<v;l++)if(this.dataDisplay[l].value)a.fillText([this.dataDisplay[l].display,": ",this.dataDisplay[l].value].join(""),n+10,w+10+o*(f.text_font_size+5)),o++;else if(this.dataDisplay[l].tag){k=0;for(t=this.metadata.length;k<t;k++)if(d.stringStartsWith(this.metadata[k],this.dataDisplay[l].tag)){t=this.metadata[k];this.dataDisplay[l].display&&(t=this.metadata[k].indexOf("\x3d"),t=[this.dataDisplay[l].display,
": ",-1<t?this.metadata[k].substring(t+2):this.metadata[k]].join(""));a.fillText(t,n+10,w+10+o*(f.text_font_size+5));o++;break}}}this.drawPlot(a,f,c,b,w,n,h);this.memory.offsetTop=w;this.memory.offsetLeft=n;this.memory.offsetBottom=h;this.memory.flipXAxis=f.plots_flipXAxis;this.memory.scale=f.scale;this.memory.width=c;this.memory.height=b};f.drawPlot=function(a,f,c,j,d,n,h){this.specs&&(f=this.specs);a.strokeStyle=f.plots_color;a.lineWidth=f.plots_width;var l=[];a.beginPath();if(this.continuous)for(var o=
!1,v=0,k=0,t=this.data.length;k<t;k++){var u=this.getTransformedX(this.data[k].x,f,c,n);if(u>=n&&u<c){var q=this.getTransformedY(this.data[k].y,f,j,h,d);f.plots_showIntegration&&g.abs(this.data[k].y)>this.integrationSensitivity&&l.push(new b.Point(this.data[k].x,this.data[k].y));o||(a.moveTo(u,q),o=!0);a.lineTo(u,q);v++;0===v%1E3&&(a.stroke(),a.beginPath(),a.moveTo(u,q))}else if(o)break}else{k=0;for(t=this.data.length;k<t;k++)u=this.getTransformedX(this.data[k].x,f,c,n),u>=n&&u<c&&(a.moveTo(u,j-h),
a.lineTo(u,this.getTransformedY(this.data[k].y,f,j,h,d)))}a.stroke();if(f.plots_showIntegration&&1<l.length){a.strokeStyle=f.plots_integrationColor;a.lineWidth=f.plots_integrationLineWidth;a.beginPath();k=l[1].x>l[0].x;if(this.flipXAxis&&!k||!this.flipXAxis&&k){for(k=l.length-2;0<=k;k--)l[k].y+=l[k+1].y;o=l[0].y}else{k=1;for(t=l.length;k<t;k++)l[k].y+=l[k-1].y;o=l[l.length-1].y}k=0;for(t=l.length;k<t;k++)u=this.getTransformedX(l[k].x,f,c,n),q=this.getTransformedY(l[k].y/f.scale/o,f,j,h,d),0===k?a.moveTo(u,
q):a.lineTo(u,q);a.stroke()}};f.getTransformedY=function(a,f,c,g,b){return b+(c-g-b)*(1-a*f.scale)};f.getInverseTransformedY=function(a){return 100*((1-(a-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale)};f.getTransformedX=function(a,f,c,g){a=g+(a-this.minX)/(this.maxX-this.minX)*(c-g);f.plots_flipXAxis&&(a=c+g-a);return a};f.getInverseTransformedX=function(a){this.memory.flipXAxis&&(a=this.memory.width+this.memory.offsetLeft-a);return(a-
this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX};f.setup=function(){for(var a=Number.MAX_VALUE,f=Number.MIN_VALUE,c=Number.MIN_VALUE,b=0,d=this.data.length;b<d;b++)a=g.min(a,this.data[b].x),f=g.max(f,this.data[b].x),c=g.max(c,this.data[b].y);this.continuous?(this.minX=a,this.maxX=f):(this.minX=a-1,this.maxX=f+1);b=0;for(d=this.data.length;b<d;b++)this.data[b].y/=c};f.zoom=function(e,f,c,b){e=this.getInverseTransformedX(e);f=this.getInverseTransformedX(f);
this.minX=g.min(e,f);this.maxX=g.max(e,f);if(b){b=Number.MIN_VALUE;f=0;for(e=this.data.length;f<e;f++)a.isBetween(this.data[f].x,this.minX,this.maxX)&&(b=g.max(b,this.data[f].y));return 1/b}};f.translate=function(a,f){var c=a/(f-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=c;this.maxX+=c};f.alertMetadata=function(){alert(this.metadata.join("\n"))};f.getInternalCoordinates=function(a,f){return new ChemDoodle.structures.Point(this.getInverseTransformedX(a),this.getInverseTransformedY(f))};
f.getClosestPlotInternalCoordinates=function(e){var f=this.getInverseTransformedX(e-1);e=this.getInverseTransformedX(e+1);if(f>e){var c=f,f=e;e=c}for(var c=-1,g=-Infinity,b=!1,d=0,h=this.data.length;d<h;d++){var l=this.data[d];if(a.isBetween(l.x,f,e))l.y>g&&(b=!0,g=l.y,c=d);else if(b)break}if(-1!==c)return l=this.data[c],new ChemDoodle.structures.Point(l.x,100*l.y)};f.getClosestPeakInternalCoordinates=function(a){var f=this.getInverseTransformedX(a);a=0;for(var c=Infinity,b=0,d=this.data.length;b<
d;b++){var n=g.abs(this.data[b].x-f);if(n<=c)c=n,a=b;else break}f=highestRight=a;c=maxRight=this.data[a].y;b=a+1;for(d=this.data.length;b<d;b++)if(this.data[b].y+0.05>maxRight)maxRight=this.data[b].y,highestRight=b;else break;for(b=a-1;0<=b;b--)if(this.data[b].y+0.05>c)c=this.data[b].y,f=b;else break;a=this.data[f-a>highestRight-a?highestRight:f];return new ChemDoodle.structures.Point(a.x,100*a.y)}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(d,b,a){b._Shape=function(){};b=b._Shape.prototype;b.drawDecorations=function(a,g){if(this.isHover)for(var e=this.getPoints(),b=0,c=e.length;b<c;b++){var d=e[b];this.drawAnchor(a,g,d,d===this.hoverPoint)}};b.getBounds=function(){for(var a=new d.Bounds,g=this.getPoints(),e=0,b=g.length;e<b;e++){var c=g[e];a.expand(c.x,c.y)}return a};b.drawAnchor=function(f,g,e,b){f.save();f.translate(e.x,e.y);f.rotate(a.PI/4);f.scale(1/g.scale,1/g.scale);f.beginPath();f.moveTo(-4,-4);f.lineTo(4,-4);f.lineTo(4,
4);f.lineTo(-4,4);f.closePath();f.fillStyle=b?"#885110":"white";f.fill();f.beginPath();f.moveTo(-4,-2);f.lineTo(-4,-4);f.lineTo(-2,-4);f.moveTo(2,-4);f.lineTo(4,-4);f.lineTo(4,-2);f.moveTo(4,2);f.lineTo(4,4);f.lineTo(2,4);f.moveTo(-2,4);f.lineTo(-4,4);f.lineTo(-4,2);f.moveTo(-4,-2);f.strokeStyle="rgba(0,0,0,.2)";f.lineWidth=5;f.stroke();f.strokeStyle="blue";f.lineWidth=1;f.stroke();f.restore()}})(ChemDoodle.math,ChemDoodle.structures.d2,Math);
(function(d,b,a,f,g){f.Bracket=function(e,f){this.p1=e?e:new a.Point;this.p2=f?f:new a.Point};f=f.Bracket.prototype=new f._Shape;f.charge=0;f.mult=0;f.repeat=0;f.draw=function(a,f){var c=g.min(this.p1.x,this.p2.x),b=g.max(this.p1.x,this.p2.x),w=g.min(this.p1.y,this.p2.y),n=g.max(this.p1.y,this.p2.y),h=n-w,l=h/10;a.beginPath();a.moveTo(c+l,w);a.lineTo(c,w);a.lineTo(c,n);a.lineTo(c+l,n);a.moveTo(b-l,n);a.lineTo(b,n);a.lineTo(b,w);a.lineTo(b-l,w);this.isLassoed&&(l=a.createLinearGradient(this.p1.x,this.p1.y,
this.p2.x,this.p2.y),l.addColorStop(0,"rgba(212, 99, 0, 0)"),l.addColorStop(0.5,"rgba(212, 99, 0, 0.8)"),l.addColorStop(1,"rgba(212, 99, 0, 0)"),a.lineWidth=f.shapes_lineWidth_2D+5,a.strokeStyle=l,a.lineJoin="miter",a.lineCap="square",a.stroke());a.strokeStyle=f.shapes_color;a.lineWidth=f.shapes_lineWidth_2D;a.lineJoin="miter";a.lineCap="butt";a.stroke();0!==this.charge&&(a.fillStyle=f.text_color,a.textAlign="left",a.textBaseline="alphabetic",a.font=f.getFontString(f.text_font_size,f.text_font_families),
l=this.charge.toFixed(0),l="1"===l?"+":"-1"===l?"\u2013":d.stringStartsWith(l,"-")?l.substring(1)+"\u2013":l+"+",a.fillText(l,b+5,w+5));0!==this.mult&&(a.fillStyle=f.text_color,a.textAlign="right",a.textBaseline="middle",a.font=f.getFontString(f.text_font_size,f.text_font_families),a.fillText(this.mult.toFixed(0),c-5,w+h/2));0!==this.repeat&&(a.fillStyle=f.text_color,a.textAlign="left",a.textBaseline="top",a.font=f.getFontString(f.text_font_size,f.text_font_families),l=this.repeat.toFixed(0),a.fillText(l,
b+5,n-5))};f.getPoints=function(){return[this.p1,this.p2]};f.isOver=function(a){return b.isBetween(a.x,this.p1.x,this.p2.x)&&b.isBetween(a.y,this.p1.y,this.p2.y)}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(d,b,a,f){a.Line=function(a,f){this.p1=a?a:new b.Point;this.p2=f?f:new b.Point};a.Line.ARROW_SYNTHETIC="synthetic";a.Line.ARROW_RETROSYNTHETIC="retrosynthetic";a.Line.ARROW_RESONANCE="resonance";a.Line.ARROW_EQUILIBRIUM="equilibrium";var g=a.Line.prototype=new a._Shape;g.arrowType=void 0;g.topText=void 0;g.bottomText=void 0;g.draw=function(e,g){if(this.isLassoed){var c=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);c.addColorStop(0,"rgba(212, 99, 0, 0)");c.addColorStop(0.5,
"rgba(212, 99, 0, 0.8)");c.addColorStop(1,"rgba(212, 99, 0, 0)");var b=2.5,d=this.p1.angle(this.p2)+f.PI/2,n=f.cos(d),d=f.sin(d),h=this.p1.x-n*b,l=this.p1.y+d*b,o=this.p1.x+n*b,v=this.p1.y-d*b,k=this.p2.x+n*b,t=this.p2.y-d*b,u=this.p2.x-n*b,q=this.p2.y+d*b;e.fillStyle=c;e.beginPath();e.moveTo(h,l);e.lineTo(o,v);e.lineTo(k,t);e.lineTo(u,q);e.closePath();e.fill()}e.strokeStyle=g.shapes_color;e.fillStyle=g.shapes_color;e.lineWidth=g.shapes_lineWidth_2D;e.lineJoin="miter";e.lineCap="butt";if(this.p1.x!==
this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===a.Line.ARROW_RETROSYNTHETIC){var c=2*f.sqrt(2),b=g.shapes_arrowLength_2D/c,n=this.p1.angle(this.p2),d=n+f.PI/2,c=g.shapes_arrowLength_2D/c,r=f.cos(n),p=f.sin(n),n=f.cos(d),d=f.sin(d),h=this.p1.x-n*b,l=this.p1.y+d*b,o=this.p1.x+n*b,v=this.p1.y-d*b,k=this.p2.x+n*b-r*c,t=this.p2.y-d*b+p*c,u=this.p2.x-n*b-r*c,q=this.p2.y+d*b+p*c,y=this.p2.x+2*n*b-2*r*c,z=this.p2.y-2*d*b+2*p*c,x=this.p2.x-2*n*b-2*r*c,b=this.p2.y+2*d*b+2*p*c;e.beginPath();e.moveTo(o,
v);e.lineTo(k,t);e.moveTo(y,z);e.lineTo(this.p2.x,this.p2.y);e.lineTo(x,b);e.moveTo(u,q);e.lineTo(h,l)}else this.arrowType===a.Line.ARROW_EQUILIBRIUM?(c=2*f.sqrt(2),b=g.shapes_arrowLength_2D/c/2,n=this.p1.angle(this.p2),d=n+f.PI/2,c=2*g.shapes_arrowLength_2D/f.sqrt(3),r=f.cos(n),p=f.sin(n),n=f.cos(d),d=f.sin(d),h=this.p1.x-n*b,l=this.p1.y+d*b,o=this.p1.x+n*b,v=this.p1.y-d*b,k=this.p2.x+n*b,t=this.p2.y-d*b,u=this.p2.x-n*b,q=this.p2.y+d*b,e.beginPath(),e.moveTo(o,v),e.lineTo(k,t),e.moveTo(u,q),e.lineTo(h,
l),e.stroke(),o=k-0.8*r*c,v=t+0.8*p*c,y=k+n*g.shapes_arrowLength_2D/3-r*c,z=t-d*g.shapes_arrowLength_2D/3+p*c,e.beginPath(),e.moveTo(k,t),e.lineTo(y,z),e.lineTo(o,v),e.closePath(),e.fill(),e.stroke(),o=h+0.8*r*c,v=l-0.8*p*c,y=h-n*g.shapes_arrowLength_2D/3+r*c,z=l+d*g.shapes_arrowLength_2D/3-p*c,e.beginPath(),e.moveTo(h,l),e.lineTo(y,z),e.lineTo(o,v),e.closePath(),e.fill()):this.arrowType===a.Line.ARROW_SYNTHETIC?(n=this.p1.angle(this.p2),d=n+f.PI/2,c=2*g.shapes_arrowLength_2D/f.sqrt(3),r=f.cos(n),
p=f.sin(n),n=f.cos(d),d=f.sin(d),e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x-r*c/2,this.p2.y+p*c/2),e.stroke(),o=this.p2.x-0.8*r*c,v=this.p2.y+0.8*p*c,y=this.p2.x+n*g.shapes_arrowLength_2D/3-r*c,z=this.p2.y-d*g.shapes_arrowLength_2D/3+p*c,x=this.p2.x-n*g.shapes_arrowLength_2D/3-r*c,b=this.p2.y+d*g.shapes_arrowLength_2D/3+p*c,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(x,b),e.lineTo(o,v),e.lineTo(y,z),e.closePath(),e.fill()):this.arrowType===a.Line.ARROW_RESONANCE?(n=this.p1.angle(this.p2),
d=n+f.PI/2,c=2*g.shapes_arrowLength_2D/f.sqrt(3),r=f.cos(n),p=f.sin(n),n=f.cos(d),d=f.sin(d),e.beginPath(),e.moveTo(this.p1.x+r*c/2,this.p1.y-p*c/2),e.lineTo(this.p2.x-r*c/2,this.p2.y+p*c/2),e.stroke(),o=this.p2.x-0.8*r*c,v=this.p2.y+0.8*p*c,y=this.p2.x+n*g.shapes_arrowLength_2D/3-r*c,z=this.p2.y-d*g.shapes_arrowLength_2D/3+p*c,x=this.p2.x-n*g.shapes_arrowLength_2D/3-r*c,b=this.p2.y+d*g.shapes_arrowLength_2D/3+p*c,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(x,b),e.lineTo(o,v),e.lineTo(y,
z),e.closePath(),e.fill(),e.stroke(),o=this.p1.x+0.8*r*c,v=this.p1.y-0.8*p*c,y=this.p1.x-n*g.shapes_arrowLength_2D/3+r*c,z=this.p1.y+d*g.shapes_arrowLength_2D/3-p*c,x=this.p1.x+n*g.shapes_arrowLength_2D/3+r*c,b=this.p1.y-d*g.shapes_arrowLength_2D/3-p*c,e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(x,b),e.lineTo(o,v),e.lineTo(y,z),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x,this.p2.y));e.stroke();this.topText&&(e.textAlign="center",e.textBaseline=
"bottom",e.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5));this.bottomText&&(e.textAlign="center",e.textBaseline="top",e.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}};g.getPoints=function(){return[this.p1,this.p2]};g.isOver=function(a,f){var c=d.distanceFromPointToLineInclusive(a,this.p1,this.p2);return-1!==c&&c<f}})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(d,b,a,f,g){var e=function(c){var e=[];if(c instanceof a.Atom)if(0===c.bondNumber)e.push(g.PI);else{if(c.angles){if(1===c.angles.length)e.push(c.angles[0]+g.PI);else{for(var f=1,b=c.angles.length;f<b;f++)e.push(c.angles[f-1]+(c.angles[f]-c.angles[f-1])/2);f=c.angles[c.angles.length-1];e.push(f+(c.angles[0]+2*g.PI-f)/2)}c.largestAngle>g.PI&&(e=[c.angleOfLeastInterference]);if(c.bonds){f=0;for(b=c.bonds.length;f<b;f++){var d=c.bonds[f];if(2===d.bondOrder&&(d=d.getNeighbor(c),"O"===d.label)){e=
[d.angle(c)];break}}}}}else c=c.a1.angle(c.a2),e.push(c+g.PI/2),e.push(c+3*g.PI/2);f=0;for(b=e.length;f<b;f++){for(;e[f]>2*g.PI;)e[f]-=2*g.PI;for(;0>e[f];)e[f]+=2*g.PI}return e},m=function(c,e){var f=3;if(c instanceof a.Atom){if(c.isLabelVisible(e)&&(f=8),0!==c.charge||0!==c.numRadical||0!==c.numLonePair)f=13}else c instanceof a.Point?f=0:1<c.bondOrder&&(f=5);return f},c=function(c,e,f,b,d,o,v,k,t,u){var q=o.angle(d),r=v.angle(k),p=q+g.PI/2,y=g.cos(q),q=g.sin(q),p=m(f,e);d.x-=y*p;d.y+=q*p;p=r+g.PI/
2;f=2*e.shapes_arrowLength_2D/g.sqrt(3);var y=g.cos(r),q=g.sin(r),z=g.cos(p),x=g.sin(p);k.x-=5*y;k.y+=5*q;r=new a.Point(k.x,k.y);p=m(b,e)/3;r.x-=y*p;r.y+=q*p;k.x-=y*(0.8*f+p);k.y+=q*(0.8*f+p);b=r.x-0.8*y*f;var p=r.y+0.8*q*f,A=new a.Point(r.x+z*e.shapes_arrowLength_2D/3-y*f,r.y-x*e.shapes_arrowLength_2D/3+q*f);e=new a.Point(r.x-z*e.shapes_arrowLength_2D/3-y*f,r.y+x*e.shapes_arrowLength_2D/3+q*f);q=y=!0;1===t&&(A.distance(o)>e.distance(o)?q=!1:y=!1);c.beginPath();c.moveTo(r.x,r.y);q&&c.lineTo(e.x,e.y);
c.lineTo(b,p);y&&c.lineTo(A.x,A.y);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(d.x,d.y);c.bezierCurveTo(o.x,o.y,v.x,v.y,k.x,k.y);c.stroke();u.push([d,o,v,k])};f.Pusher=function(a,c,e){this.o1=a;this.o2=c;this.numElectron=e?e:1};f=f.Pusher.prototype=new f._Shape;f.drawDecorations=function(c,e){if(this.isHover)for(var f=this.o1 instanceof a.Atom?new a.Point(this.o1.x,this.o1.y):this.o1.getCenter(),b=this.o2 instanceof a.Atom?new a.Point(this.o2.x,this.o2.y):this.o2.getCenter(),f=[f,b],
b=0,g=f.length;b<g;b++){var d=f[b];this.drawAnchor(c,e,d,d===this.hoverPoint)}};f.draw=function(f,b){if(this.o1&&this.o2){f.strokeStyle=b.shapes_color;f.fillStyle=b.shapes_color;f.lineWidth=b.shapes_lineWidth_2D;f.lineJoin="miter";f.lineCap="butt";for(var m=this.o1 instanceof a.Atom?new a.Point(this.o1.x,this.o1.y):this.o1.getCenter(),h=this.o2 instanceof a.Atom?new a.Point(this.o2.x,this.o2.y):this.o2.getCenter(),l=e(this.o1),o=e(this.o2),v,k,t=Infinity,u=0,q=l.length;u<q;u++)for(var r=0,p=o.length;r<
p;r++){var y=new a.Point(m.x+35*g.cos(l[u]),m.y-35*g.sin(l[u])),z=new a.Point(h.x+35*g.cos(o[r]),h.y-35*g.sin(o[r])),x=y.distance(z);x<t&&(t=x,v=y,k=z)}this.caches=[];-1===this.numElectron?(u=m.distance(h)/2,o=m.angle(h),l=o+g.PI/2,q=g.cos(o),r=g.sin(o),o=new a.Point(m.x+(u-1)*q,m.y-(u-1)*r),t=new a.Point(o.x+35*g.cos(l+g.PI/6),o.y-35*g.sin(l+g.PI/6)),u=new a.Point(m.x+(u+1)*q,m.y-(u+1)*r),l=new a.Point(u.x+35*g.cos(l-g.PI/6),u.y-35*g.sin(l-g.PI/6)),c(f,b,this.o1,o,m,v,t,o,1,this.caches),c(f,b,this.o2,
u,h,k,l,u,1,this.caches)):(d.intersectLines(m.x,m.y,v.x,v.y,h.x,h.y,k.x,k.y)&&(l=v,v=k,k=l),l=v.angle(m),o=k.angle(h),t=g.max(l,o)-g.min(l,o),0.001>g.abs(t-g.PI)&&this.o1.molCenter===this.o2.molCenter&&(l+=g.PI/2,o-=g.PI/2,v.x=m.x+35*g.cos(l+g.PI),v.y=m.y-35*g.sin(l+g.PI),k.x=h.x+35*g.cos(o+g.PI),k.y=h.y-35*g.sin(o+g.PI)),c(f,b,this.o1,this.o2,m,v,k,h,this.numElectron,this.caches))}};f.getPoints=function(){return[]};f.isOver=function(a,c){for(var f=0,e=this.caches.length;f<e;f++)if(b.distanceFromCurve(a,
this.caches[f]).distance<c)return!0;return!1}})(ChemDoodle.math,ChemDoodle.math.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(d){d._Mesh=function(){};d=d._Mesh.prototype;d.storeData=function(b,a,f){this.positionData=b;this.normalData=a;this.indexData=f};d.setupBuffers=function(b){this.vertexPositionBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.positionData),b.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,
this.vertexNormalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(this.normalData),b.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),b.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);if(this.partitions)for(var a=
0,f=this.partitions.length;a<f;a++){var g=this.partitions[a],e=this.generateBuffers(b,g.positionData,g.normalData,g.indexData);g.vertexPositionBuffer=e[0];g.vertexNormalBuffer=e[1];g.vertexIndexBuffer=e[2]}};d.generateBuffers=function(b,a,f,g){var e=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);e.itemSize=3;e.numItems=a.length/3;a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,new Float32Array(f),b.STATIC_DRAW);
a.itemSize=3;a.numItems=f.length/3;var d;g&&(d=b.createBuffer(),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,d),b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(g),b.STATIC_DRAW),d.itemSize=1,d.numItems=g.length);return[e,a,d]};d.bindBuffers=function(b){this.vertexPositionBuffer||this.setupBuffers(b);b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexNormalBuffer);
b.vertexAttribPointer(b.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,b.FLOAT,!1,0,0);this.vertexIndexBuffer&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures.d3,Math);
(function(d,b){d.Arrow=function(a,f){for(var g=[],e=[],d=0;d<=f;d++){var c=2*d*b.PI/f,j=b.sin(c),c=b.cos(c);e.push(0,0,-1,0,0,-1,c,j,0,c,j,0,0,0,-1,0,0,-1,c,j,1,c,j,1);g.push(0,0,0,a*c,a*j,0,a*c,a*j,0,a*c,a*j,2,a*c,a*j,2,2*a*c,2*a*j,2,2*a*c,2*a*j,2,0,0,3)}d=[];for(j=0;j<f;j++)for(var c=8*j,w=0;7>w;w++){var n=w+c,h=n+7+2;d.push(n,n+1,h,h,h-1,n)}this.storeData(g,e,d)};d.Arrow.prototype=new d._Mesh})(ChemDoodle.structures.d3,Math);
(function(d,b,a){d.d3.Compass=function(f,g){var e=3/(g.compass_size_3D/f.canvas.clientHeight),d=b.tan(g.projectionPerspectiveVerticalFieldOfView_3D/360*b.PI),c=e/d,j=b.max(c-e,0.1),w=f.canvas.clientWidth/f.canvas.clientHeight,n=-(f.canvas.clientWidth-g.compass_size_3D)/2+g.compass_size_3D/10,h=-(f.canvas.clientHeight-g.compass_size_3D)/2+g.compass_size_3D/10,l,o;g.projectionPerspective_3D?(o=j,l=a.frustum):(o=c,l=a.ortho);var v=2*(o/f.canvas.clientHeight)*d,n=n*v,h=h*v,d=d*o;o=-d;this.projectionMatrix=
l(w*o-n,w*d-n,o-h,d-h,j,c+e);this.translationMatrix=a.translate(a.identity([]),[0,0,-c])};d=d.d3.Compass.prototype;d.renderArrow=function(a,b,e){a.material.setDiffuseColor(b);a.setMatrixUniforms(e);a.drawElements(a.TRIANGLES,a.arrowBuffer.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)};d.render=function(f,g){f.arrowBuffer.bindBuffers(f);f.material.setTempColors(g.bonds_materialAmbientColor_3D,void 0,g.bonds_materialSpecularColor_3D,g.bonds_materialShininess_3D);var e=a.multiply(this.translationMatrix,
f.rotationMatrix,[]),d=b.PI/2;this.renderArrow(f,g.compass_axisXColor_3D,a.rotateY(e,d,[]));this.renderArrow(f,g.compass_axisYColor_3D,a.rotateX(e,-d,[]));this.renderArrow(f,g.compass_axisZColor_3D,e)}})(ChemDoodle.structures,Math,mat4);
(function(d,b){d.Cylinder=function(a,f,g){for(var e=[],d=[],c=0;c<g;c++){var j=2*c*b.PI/g,w=b.cos(j),j=b.sin(j);d.push(w,0,j);e.push(a*w,0,a*j);d.push(w,0,j);e.push(a*w,f,a*j)}d.push(1,0,0);e.push(a,0,0);d.push(1,0,0);e.push(a,f,0);this.storeData(e,d)};d.Cylinder.prototype=new d._Mesh})(ChemDoodle.structures.d3,Math);
(function(d,b){b.Fog=function(a){this.gl=a;this.mUL=a.getUniformLocation(a.program,"u_fog.mode");this.cUL=a.getUniformLocation(a.program,"u_fog.color");this.sUL=a.getUniformLocation(a.program,"u_fog.start");this.eUL=a.getUniformLocation(a.program,"u_fog.end");this.dUL=a.getUniformLocation(a.program,"u_fog.density")};var a=b.Fog.prototype;a.setTempParameter=function(a,b,e,m){if(!this.cCache||this.cCache!==a)this.cCache=a,a=d.getRGB(a,1),this.gl.uniform3f(this.cUL,a[0],a[1],a[2]);if(!this.sCache||this.sCache!==
b)this.sCache=b,this.gl.uniform1f(this.sUL,b);if(!this.eCache||this.eCache!==e)this.eCache=e,this.gl.uniform1f(this.eUL,e);if(!this.dCache||this.dCache!==m)this.dCache=m,this.gl.uniform1f(this.dUL,m)};a.setMode=function(a){if(!this.mCache||this.mCache!==a)this.mCache=a,this.gl.uniform1i(this.mUL,a)}})(ChemDoodle.math,ChemDoodle.structures.d3,vec3);
(function(d,b){b.Label=function(){this.textImage=new b.TextImage};var a=b.Label.prototype;a.initialize=function(a){a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);this.initGLTexture(a);this.initGLProgram(a,"attribute vec3 a_vertex_position;\nattribute vec2 a_vertex_texcoord;\nattribute vec2 a_translation;\nattribute float a_z_depth;\nuniform mat4 u_model_view_matrix;\nuniform mat4 u_projection_matrix;\nuniform vec2 u_dimension;\nvarying vec2 v_texcoord;\nvoid main() {\ngl_Position \x3d u_model_view_matrix * vec4(a_vertex_position, 1.0);\nvec4 depth_pos \x3d vec4(gl_Position);\ndepth_pos.z +\x3d a_z_depth;\ngl_Position \x3d u_projection_matrix * gl_Position;\ndepth_pos \x3d u_projection_matrix * depth_pos;\ngl_Position /\x3d gl_Position.w;\ngl_Position.xy +\x3d a_translation / u_dimension * 2.0;\ngl_Position.z \x3d depth_pos.z / depth_pos.w;\nv_texcoord \x3d a_vertex_texcoord;\n}",
"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nvoid main() {\ngl_FragColor \x3d texture2D(u_image, v_texcoord);\n}")};a.loadShader=function(a,b,e){switch(e){case "x-shader/x-vertex":e=a.createShader(a.VERTEX_SHADER);break;case "x-shader/x-fragment":e=a.createShader(a.FRAGMENT_SHADER);break;default:return}a.shaderSource(e,b);a.compileShader(e);if(a.getShaderParameter(e,a.COMPILE_STATUS))return e};a.initGLProgram=function(a,b,e){b=this.loadShader(a,b,"x-shader/x-vertex");
e=this.loadShader(a,e,"x-shader/x-fragment");var d=a.createProgram();a.attachShader(d,b);a.attachShader(d,e);a.linkProgram(d);a.getProgramParameter(d,a.LINK_STATUS)&&(d.vertexPositionAttribute=a.getAttribLocation(d,"a_vertex_position"),d.vertexTexCoordAttribute=a.getAttribLocation(d,"a_vertex_texcoord"),d.vertexTranslationAttribute=a.getAttribLocation(d,"a_translation"),d.vertexZDepthAttribute=a.getAttribLocation(d,"a_z_depth"),this.modelViewMatrixUniform=a.getUniformLocation(d,"u_model_view_matrix"),
this.projectionMatrixUniform=a.getUniformLocation(d,"u_projection_matrix"),this.dimensionUniform=a.getUniformLocation(d,"u_dimension"),a.programLabel=d)};a.initGLTexture=function(a){this.textureImage=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.textureImage);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.NEAREST);a.bindTexture(a.TEXTURE_2D,null)};a.changeFontTexture=function(a,b){this.textImage.updateFont(b);a.bindTexture(a.TEXTURE_2D,this.textureImage);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.textImage.getCanvas())};a.setUniforms=function(a){a.uniformMatrix4fv(this.modelViewMatrixUniform,!1,a.modelViewMatrix);a.uniformMatrix4fv(this.projectionMatrixUniform,!1,a.projectionMatrix);a.uniform2f(this.dimensionUniform,a.canvas.clientWidth,a.canvas.clientHeight)};
a.updateVerticesBuffer=function(a,b,e){for(var m=0,c=b.length;m<c;m++){for(var j=b[m],w=j.labelMesh,n=j.atoms,h=this.textImage,l={position:[],texCoord:[],translation:[],zDepth:[]},o=0<n.length&&void 0!=n[0].hetatm,v=0,k=n.length;v<k;v++){var t=n[v],u=t.label,q=0.05;e.atoms_useVDWDiameters_3D?q+=d[u].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D&&(q+=1.5*(e.atoms_sphereDiameter_3D/2));if(o)if(t.hetatm){if(t.isWater&&!e.macro_showWaters)continue}else if(!e.macro_displayAtoms)continue;
h.pushVertexData(u,[t.x,t.y,t.z],q,l)}if((j=j.chains)&&(e.proteins_displayRibbon||e.proteins_displayBackbone)){v=0;for(k=j.length;v<k;v++){n=j[v];o=0;for(u=n.length;o<u;o++){var r=n[o];r.name&&(t=r.cp1,q=0,e.atoms_useVDWDiameters_3D?q+=d[t.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D&&(q+=1.5*(e.atoms_sphereDiameter_3D/2)),h.pushVertexData(r.name,[t.x,t.y,t.z],q,l))}}}w.storeData(a,l.position,l.texCoord,l.translation,l.zDepth)}};a.render=function(a,b,e){var d=a.programLabel,
c=a.program;a.useProgram(d);a.enable(a.BLEND);a.depthMask(!1);this.setUniforms(a);a.enableVertexAttribArray(d.vertexPositionAttribute);a.enableVertexAttribArray(d.vertexTexCoordAttribute);a.enableVertexAttribArray(d.vertexTranslationAttribute);a.enableVertexAttribArray(d.vertexZDepthAttribute);for(var j=0,w=e.length;j<w;j++)e[j].labelMesh&&e[j].labelMesh.render(a,b);a.disableVertexAttribArray(d.vertexPositionAttribute);a.disableVertexAttribArray(d.vertexTexCoordAttribute);a.disableVertexAttribArray(d.vertexTranslationAttribute);
a.disableVertexAttribArray(d.vertexZDepthAttribute);a.disable(a.BLEND);a.depthMask(!0);a.useProgram(c);a.enableVertexAttribArray(a.shader.vertexPositionAttribute);a.enableVertexAttribArray(a.shader.vertexNormalAttribute)};a.bindMoleculeLabel=function(a,g){for(var e=0,d=g.length;e<d;e++){var c=g[e];c.labelMesh instanceof b.TextMesh||(c.labelMesh=new b.TextMesh,c.labelMesh.initialize(a))}}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3);
(function(d,b){d.Sphere=function(a,f,g){for(var e=[],d=[],c=0;c<=f;c++)for(var j=c*b.PI/f,w=b.sin(j),n=b.cos(j),j=0;j<=g;j++){var h=2*j*b.PI/g,l=b.sin(h),h=b.cos(h)*w,o=n,l=l*w;d.push(h,o,l);e.push(a*h,a*o,a*l)}a=[];g+=1;for(c=0;c<f;c++)for(j=0;j<g;j++)w=c*g+j%g,n=w+g,a.push(w),a.push(n),a.push(w+1),j<g-1&&(a.push(n),a.push(n+1),a.push(w+1));this.storeData(e,d,a)};d.Sphere.prototype=new d._Mesh})(ChemDoodle.structures.d3,Math);
(function(d,b,a,f){function g(a,e,b,f){this.entire=a;this.name=e;this.indexes=b;this.pi=f}var e=function(a,e){a.bindBuffer(a.ARRAY_BUFFER,e.vertexPositionBuffer);a.vertexAttribPointer(a.shader.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,e.vertexNormalBuffer);a.vertexAttribPointer(a.shader.vertexNormalAttribute,e.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e.vertexIndexBuffer)},m=g.prototype;m.getColor=function(a){return a.macro_colorByChain?
this.chainColor:this.name?this.getResidueColor(d[this.name]?this.name:"*",a):this.helix?this.entire.front?a.proteins_ribbonCartoonHelixPrimaryColor:a.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?a.proteins_ribbonCartoonSheetColor:this.entire.front?a.proteins_primaryColor:a.proteins_secondaryColor};m.getResidueColor=function(a,e){var b=d[a];return e.proteins_useShapelyColors?b.shapelyColor:e.proteins_useAminoColors?b.aminoColor:e.proteins_usePolarityColors&&b.polar?"#C10000":"#FFFFFF"};m.render=
function(a,b){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(e(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi);this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);
a.material.setDiffuseColor(this.getColor(b));a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)};b.Ribbon=function(c,e,b){var d=c[0].lineSegments.length,h=c[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;var l;this.front=0<e;for(var m=0,v=c.length-1;m<v;m++){if(!l||65E3<l.positionData.length)0<this.partitions.length&&m--,l={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(l);var k=c[m];l.count++;for(var t=0;t<d;t++)for(var u=
b?k.lineSegmentsCartoon[t]:k.lineSegments[t],q=0===t,r=!1,p=0;p<h;p++){var y=u[p],z=m,x=p+1;m===c.length-2&&p===h-1?x--:p===h-1&&(z++,x=0);var x=b?c[z].lineSegmentsCartoon[t][x]:c[z].lineSegments[t][x],z=!1,A=t+1;t===d-1&&(A-=2,z=!0);var A=b?k.lineSegmentsCartoon[A][p]:k.lineSegments[A][p],x=[x.x-y.x,x.y-y.y,x.z-y.z],A=[A.x-y.x,A.y-y.y,A.z-y.z],C=f.cross(x,A,[]);0===p&&(f.normalize(x),f.scale(x,-1),l.normalData.push(x[0],x[1],x[2]),l.positionData.push(y.x,y.y,y.z));q||r?(f.normalize(A),f.scale(A,
-1),l.normalData.push(A[0],A[1],A[2]),l.positionData.push(y.x,y.y,y.z),q&&p===h-1&&(q=!1,p=-1)):(f.normalize(C),(z&&!this.front||!z&&this.front)&&f.scale(C,-1),l.normalData.push(C[0],C[1],C[2]),f.scale(C,a.abs(e)),l.positionData.push(y.x+C[0],y.y+C[1],y.z+C[2]),t===d-1&&p===h-1&&(r=!0,p=-1));if(-1===p||p===h-1)f.normalize(x),l.normalData.push(x[0],x[1],x[2]),l.positionData.push(y.x,y.y,y.z)}}d+=2;h+=2;b&&(this.cartoonSegments=[]);this.segments=[];e=0;for(k=this.partitions.length;e<k;e++){l=this.partitions[e];
var F;b&&(F=[]);m=0;for(v=l.count-1;m<v;m++){u=m;for(t=0;t<e;t++)u+=this.partitions[t].count-1;t=c[u];0<m&&(b&&t.split)&&(p=new g(this,void 0,F,e),t.helix&&(p.helix=!0),t.sheet&&(p.sheet=!0),this.cartoonSegments.push(p),F=[]);q=m*d*h;r=[];t=0;for(y=d-1;t<y;t++){z=q+t*h;for(p=0;p<h;p++){x=1;m===l.count-1?x=0:p===h-1&&(x=d*h-p);x=[z+p,z+h+p,z+h+p+x,z+p,z+p+x,z+h+p+x];if(p!==h-1)for(A=0;6>A;A++)r.push(x[A]);p===h-2&&m<l.count-1&&(A=d*h-p,x[2]+=A,x[4]+=A,x[5]+=A);for(A=0;6>A;A++)l.indexData.push(x[A]);
if(b)for(A=0;6>A;A++)F.push(x[A])}}this.segments.push(new g(this,c[u+1].name,r,e))}if(b){p=new g(this,void 0,F,e);u=l.count-1;for(t=0;t<e;t++)u+=this.partitions[t].count-1;t=c[u];t.helix&&(p.helix=!0);t.sheet&&(p.sheet=!0);this.cartoonSegments.push(p)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);1===this.partitions.length&&(this.partitions=void 0)};(b.Ribbon.prototype=new b._Mesh).render=function(a,b){this.bindBuffers(a);var f=b.macro_colorByChain?
this.chainColor:void 0;f||(f=this.front?b.proteins_primaryColor:b.proteins_secondaryColor);a.material.setDiffuseColor(f);a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0);if(this.partitions)for(var f=1,g=this.partitions.length;f<g;f++){var d=this.partitions[f];e(a,d);a.drawElements(a.TRIANGLES,d.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}})(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,vec3);
(function(d,b,a){b.Light=function(a,b,e){this.diffuseRGB=d.getRGB(a,1);this.specularRGB=d.getRGB(b,1);this.direction=e};b.Light.prototype.lightScene=function(b){b.uniform3f(b.getUniformLocation(b.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);b.uniform3f(b.getUniformLocation(b.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var g=a.create(this.direction);a.normalize(g);a.negate(g);b.uniform3f(b.getUniformLocation(b.program,
"u_light.direction"),g[0],g[1],g[2]);var e=[0,0,0],g=[e[0]+g[0],e[1]+g[1],e[2]+g[2]],e=a.length(g);0===e?g=[0,0,1]:a.scale(1/e);b.uniform3f(b.getUniformLocation(b.program,"u_light.half_vector"),g[0],g[1],g[2])}})(ChemDoodle.math,ChemDoodle.structures.d3,vec3);(function(d){d.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])};d.Line.prototype=new d._Mesh})(ChemDoodle.structures.d3);
(function(d,b){b.Material=function(a){this.gl=a;this.aUL=a.getUniformLocation(a.program,"u_material.ambient_color");this.dUL=a.getUniformLocation(a.program,"u_material.diffuse_color");this.sUL=a.getUniformLocation(a.program,"u_material.specular_color");this.snUL=a.getUniformLocation(a.program,"u_material.shininess");this.alUL=a.getUniformLocation(a.program,"u_material.alpha")};var a=b.Material.prototype;a.setTempColors=function(a,b,e,m){if(!this.aCache||this.aCache!==a)this.aCache=a,a=d.getRGB(a,
1),this.gl.uniform3f(this.aUL,a[0],a[1],a[2]);if(b&&(!this.dCache||this.dCache!==b))this.dCache=b,a=d.getRGB(b,1),this.gl.uniform3f(this.dUL,a[0],a[1],a[2]);if(!this.sCache||this.sCache!==e)this.sCache=e,a=d.getRGB(e,1),this.gl.uniform3f(this.sUL,a[0],a[1],a[2]);if(!this.snCache||this.snCache!==m)this.snCache=m,this.gl.uniform1f(this.snUL,m);this.alCache=1;this.gl.uniform1f(this.alUL,1)};a.setDiffuseColor=function(a){if(!this.dCache||this.dCache!==a)this.dCache=a,a=d.getRGB(a,1),this.gl.uniform3f(this.dUL,
a[0],a[1],a[2])};a.setAlpha=function(a){if(!this.alCache||this.alCache!==a)this.alCache=a,this.gl.uniform1f(this.alUL,a)}})(ChemDoodle.math,ChemDoodle.structures.d3);
(function(d,b,a,f){b.MolecularSurface=function(b,e,m,c,j){function w(a,c,e,b){var f=a.index;if(a.contained)for(var f=-1,d=Infinity,g=0,h=c.length;g<h;g++)for(var j=c[g],l=0,m=j.length;l<m;l++){var n=j[l];if(!n.contained&&n.index!==e&&n.index!==b){var o=n.distance3D(a);o<d&&(f=n.index,d=o)}}return f}for(var n=[],h=[],l=[],o=[],v=0;v<=e;v++)for(var k=v*f.PI/e,t=f.sin(k),u=f.cos(k),k=0;k<=m;k++){var q=2*k*f.PI/m;o.push(f.cos(q)*t,u,f.sin(q)*t)}t=[];v=0;for(k=b.atoms.length;v<k;v++){for(var u=[],r=b.atoms[v],
p=a[r.label][j]+c,y=[],q=0,z=b.atoms.length;q<z;q++)if(q!==v){var x=b.atoms[q];x.index=q;r.distance3D(x)<p+a[x.label][j]+c&&y.push(x)}q=0;for(z=o.length;q<z;q+=3){for(var A=new d.Atom("C",r.x+p*o[q],r.y+p*o[q+1],r.z+p*o[q+2]),C=0,F=y.length;C<F;C++)if(x=y[C],A.distance3D(x)<a[x.label][j]+c){A.contained=!0;break}u.push(A)}t.push(u)}b=[];m++;for(v=0;v<e;v++)for(k=0;k<m;k++)j=v*m+k%m,c=j+m,b.push(j),b.push(c),b.push(j+1),k<m-1&&(b.push(c),b.push(c+1),b.push(j+1));v=C=0;for(k=t.length;v<k;v++){u=t[v];
q=0;for(z=u.length;q<z;q++)A=u[q],A.contained||(A.index=C,C++,n.push(A.x,A.y,A.z),h.push(o[3*q],o[3*q+1],o[3*q+2]));q=0;for(z=b.length;q<z;q+=3)j=u[b[q]],c=u[b[q+1]],A=u[b[q+2]],!j.contained&&(!c.contained&&!A.contained)&&l.push(j.index,c.index,A.index)}o=[];v=0;for(k=t.length;v<k;v++){u=t[v];q=0;for(z=b.length;q<z;q+=3){j=u[b[q]];c=u[b[q+1]];A=u[b[q+2]];y=[];C=0;for(F=t.length;C<F;C++)C!==v&&y.push(t[C]);if((!j.contained||!c.contained||!A.contained)&&(j.contained||c.contained||A.contained))if(e=
w(j,y,-1,-1),m=w(c,y,e,-1),y=w(A,y,e,m),-1!==e&&-1!==m&&-1!==y){c=!1;C=0;for(F=o.length;C<F;C+=3)if(j=o[C],A=o[C+1],r=o[C+2],p=m===j||m===A||m===r,x=y===j||y===A||y===r,(e===j||e===A||e===r)&&p&&x){c=!0;break}c||o.push(e,m,y)}}}l=l.concat(o);this.storeData(n,h,l)};b.MolecularSurface.prototype=new b._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(d,b){d.Shader=function(){};var a=d.Shader.prototype;a.init=function(a){var b=this.getShader(a,"vertex-shader");b||(b=this.loadDefaultVertexShader(a));var e=this.getShader(a,"fragment-shader");e||(e=this.loadDefaultFragmentShader(a));a.attachShader(a.program,b);a.attachShader(a.program,e);a.linkProgram(a.program);a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(program));a.useProgram(a.program);this.vertexPositionAttribute=a.getAttribLocation(a.program,
"a_vertex_position");a.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal");a.enableVertexAttribArray(this.vertexNormalAttribute)};a.getShader=function(a,d){var e=b.getElementById(d);if(e){for(var m=[],c=e.firstChild;c;)3===c.nodeType&&m.push(c.textContent),c=c.nextSibling;if("x-shader/x-fragment"===e.type)c=a.createShader(a.FRAGMENT_SHADER);else if("x-shader/x-vertex"===e.type)c=a.createShader(a.VERTEX_SHADER);else return;
a.shaderSource(c,m.join(""));a.compileShader(c);if(a.getShaderParameter(c,a.COMPILE_STATUS))return c;alert(e.type+" "+a.getShaderInfoLog(c))}};a.loadDefaultVertexShader=function(a){var b=a.createShader(a.VERTEX_SHADER);a.shaderSource(b,"struct Light{vec3 diffuse_color;vec3 specular_color;vec3 direction;vec3 half_vector;};struct Material{vec3 ambient_color;vec3 diffuse_color;vec3 specular_color;float shininess;float alpha;};attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;uniform Light u_light;uniform Material u_material;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;varying vec4 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;varying vec3 v_light_direction;void main(void){if(length(a_vertex_normal)\x3d\x3d0.0){v_normal \x3d a_vertex_normal;}else{v_normal \x3d normalize(u_normal_matrix * a_vertex_normal);}vec4 diffuse \x3d vec4(u_light.diffuse_color, 1.0);v_light_direction \x3d u_light.direction;v_ambient \x3d vec4(u_material.ambient_color, 1.0);v_diffuse \x3d vec4(u_material.diffuse_color, 1.0) * diffuse;gl_Position \x3d u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);gl_Position /\x3d gl_Position.w;}");
a.compileShader(b);if(a.getShaderParameter(b,a.COMPILE_STATUS))return b;alert("Vertex shader failed to compile: "+a.getShaderInfoLog(b))};a.loadDefaultFragmentShader=function(a){var b=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(b,"precision mediump float;\nstruct Light{vec3 diffuse_color;vec3 specular_color;vec3 direction;vec3 half_vector;};struct Material{vec3 ambient_color;vec3 diffuse_color;vec3 specular_color;float shininess;float alpha;};struct Fog{int mode;vec3 color;float density;float start;float end;};uniform Light u_light;uniform Material u_material;uniform Fog u_fog;varying vec4 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;varying vec3 v_light_direction;void main(void){if(length(v_normal)\x3d\x3d0.0){gl_FragColor \x3d vec4(v_diffuse.rgba);}else{float nDotL \x3d max(dot(v_normal, v_light_direction), 0.0);vec4 color \x3d vec4(v_diffuse.rgb*nDotL, v_diffuse.a);float nDotHV \x3d max(dot(v_normal, u_light.half_vector), 0.0);vec4 specular \x3d vec4(u_material.specular_color * u_light.specular_color, 1.0);color+\x3dvec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);gl_FragColor \x3d color+v_ambient;gl_FragColor.a*\x3du_material.alpha;float fogCoord \x3d gl_FragCoord.z/gl_FragCoord.w;float fogFactor \x3d 1.;if(u_fog.mode \x3d\x3d 1){if(fogCoord \x3c u_fog.start){fogFactor \x3d 1.;}else if(fogCoord \x3e u_fog.end){fogFactor \x3d 0.;}else{fogFactor \x3d clamp((u_fog.end - fogCoord) / (u_fog.end - u_fog.start), 0.0, 1.0);}}else if(u_fog.mode \x3d\x3d 2) {fogFactor \x3d clamp(exp(-u_fog.density*fogCoord), 0.0, 1.0);}else if(u_fog.mode \x3d\x3d 3) {fogFactor \x3d clamp(exp(-pow(u_fog.density*fogCoord, 2.0)), 0.0, 1.0);}gl_FragColor \x3d mix(vec4(vec3(u_fog.color), 1.), gl_FragColor, fogFactor);}}");
a.compileShader(b);if(a.getShaderParameter(b,a.COMPILE_STATUS))return b;alert("Fragment shader failed to compile: "+a.getShaderInfoLog(b))}})(ChemDoodle.structures.d3,document);
(function(d,b,a){b.Shape=function(b,g){for(var e=b.length,m=[],c=[],j=new d.Point,w=0,n=e;w<n;w++){var h=w+1;w===n-1&&(h=0);for(var l=b[w],h=b[h],o=a.cross([0,0,1],[h.x-l.x,h.y-l.y,0]),v=0;2>v;v++)m.push(l.x,l.y,g/2),m.push(l.x,l.y,-g/2),m.push(h.x,h.y,g/2),m.push(h.x,h.y,-g/2);for(v=0;4>v;v++)c.push(o[0],o[1],o[2]);c.push(0,0,1);c.push(0,0,-1);c.push(0,0,1);c.push(0,0,-1);j.add(l)}j.x/=e;j.y/=e;c.push(0,0,1);m.push(j.x,j.y,g/2);c.push(0,0,-1);m.push(j.x,j.y,-g/2);j=[];l=8*e;w=0;for(n=e;w<n;w++)e=
8*w,j.push(e),j.push(e+1),j.push(e+3),j.push(e),j.push(e+2),j.push(e+3),j.push(e+4),j.push(e+6),j.push(l),j.push(e+5),j.push(e+7),j.push(l+1);this.storeData(m,c,j)};b.Shape.prototype=new b._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,vec3);
(function(d,b,a){d.Star=function(){for(var b=[0.8944,0.4472,0,0.2764,0.4472,0.8506,0.2764,0.4472,-0.8506,-0.7236,0.4472,0.5257,-0.7236,0.4472,-0.5257,-0.3416,0.4472,0,-0.1056,0.4472,0.3249,-0.1056,0.4472,-0.3249,0.2764,0.4472,0.2008,0.2764,0.4472,-0.2008,-0.8944,-0.4472,0,-0.2764,-0.4472,0.8506,-0.2764,-0.4472,-0.8506,0.7236,-0.4472,0.5257,0.7236,-0.4472,-0.5257,0.3416,-0.4472,0,0.1056,-0.4472,0.3249,0.1056,-0.4472,-0.3249,-0.2764,-0.4472,0.2008,-0.2764,-0.4472,-0.2008,-0.5527,0.1058,0,-0.1708,0.1058,
0.5527,-0.1708,0.1058,-0.5527,0.4471,0.1058,0.3249,0.4471,0.1058,-0.3249,0.5527,-0.1058,0,0.1708,-0.1058,0.5527,0.1708,-0.1058,-0.5527,-0.4471,-0.1058,0.3249,-0.4471,-0.1058,-0.3249,0,1,0,0,-1,0],d=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,
10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],e=[],m=[],c=[],j=0,w=d.length;j<w;j+=3){var n=3*d[j],h=3*d[j+1],l=3*d[j+2],n=[b[n],b[n+1],b[n+2]],h=[b[h],b[h+1],b[h+2]],l=[b[l],b[l+1],b[l+2]],o=a.cross([l[0]-h[0],l[1]-h[1],l[2]-h[2]],[n[0]-h[0],n[1]-h[1],n[2]-h[2]],[]);a.normalize(o);e.push(n[0],n[1],n[2],h[0],h[1],h[2],l[0],l[1],l[2]);m.push(o[0],o[1],o[2],o[0],o[1],
o[2],o[0],o[1],o[2]);c.push(j,j+1,j+2)}this.storeData(e,m,c)};d.Star.prototype=new d._Mesh})(ChemDoodle.structures.d3,Math,vec3);
(function(d,b){d.TextImage=function(){this.ctx=b.createElement("canvas").getContext("2d");this.data=[];this.text="";this.charHeight=0};var a=d.TextImage.prototype;a.charData=function(a){a=this.text.indexOf(a);return 0<=a?this.data[a]:null};a.updateFont=function(a){var b=this.ctx,e=this.ctx.canvas,d=[],c="",j=a.getFontString(a.atoms_font_size_2D,a.atoms_font_families_2D,a.atoms_font_bold_2D,a.atoms_font_italic_2D);b.font=j;b.save();for(var w=0,n=1.5*a.atoms_font_size_2D,h=32,l=127;h<l;h++){var o=String.fromCharCode(h),
v=b.measureText(o).width;d.push({text:o,width:v,height:n});w+=2*v}h=Math.sqrt(w*n);h=Math.ceil(h/n);w=Math.ceil(w/(h-1));e.width=w;e.height=h*n;b.font=j;b.textAlign="left";b.textBaseline="middle";b.strokeStyle="#000";b.lineWidth=1.4;b.fillStyle="#fff";h=j=e=0;for(l=d.length;h<l;h++){var o=d[h],v=2*o.width,n=o.height,k=o.text;j+v>w&&(e++,j=0);var t=e*n;a.labels_font_stroke_3D&&b.strokeText(k,j,t+n/2);b.fillText(k,j,t+n/2);o.x=j;o.y=t;c+=k;j+=v}this.text=c;this.data=d;this.charHeight=n;return this};
a.pushVertexData=function(a,b,e,d){var c=a.toString().split(""),j=this.getHeight(),w=this.getWidth();a=-this.textWidth(a)/2;for(var n=-this.charHeight/2,h=0,l=c.length;h<l;h++){var o=this.charData(c[h]),v=o.width,k=o.x/w,t=k+1.8*o.width/w,u=o.y/j,o=u+o.height/j,q=a+1.8*v,r=this.charHeight/2;d.position.push(b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2],b[0],b[1],b[2]);d.texCoord.push(k,u,t,u,t,o,k,u,k,o,t,o);d.translation.push(a,r,q,r,q,n,a,r,a,n,q,n);d.zDepth.push(e,e,
e,e,e,e);a=q+v-1.8*v}};a.getCanvas=function(){return this.ctx.canvas};a.getHeight=function(){return this.getCanvas().height};a.getWidth=function(){return this.getCanvas().width};a.textWidth=function(a){return this.ctx.measureText(a).width};a.test=function(){b.body.appendChild(this.getCanvas())}})(ChemDoodle.structures.d3,document);
(function(d){d.TextMesh=function(){};d=d.TextMesh.prototype;d.initialize=function(b){this.vertexPositionBuffer=b.createBuffer();this.vertexTexCoordBuffer=b.createBuffer();this.vertexTranslationBuffer=b.createBuffer();this.vertexZDepthBuffer=b.createBuffer()};d.setVertexData=function(b,a,d,g){b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,new Float32Array(d),b.STATIC_DRAW);a.itemSize=g;a.numItems=d.length/g};d.storeData=function(b,a,d,g,e){this.setVertexData(b,this.vertexPositionBuffer,
a,3);this.setVertexData(b,this.vertexTexCoordBuffer,d,2);this.setVertexData(b,this.vertexTranslationBuffer,g,2);this.setVertexData(b,this.vertexZDepthBuffer,e,1)};d.bindBuffers=function(b){var a=b.programLabel;b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.vertexAttribPointer(a.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexTexCoordBuffer);b.vertexAttribPointer(a.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,
b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexTranslationBuffer);b.vertexAttribPointer(a.vertexTranslationAttribute,this.vertexTranslationBuffer.itemSize,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexZDepthBuffer);b.vertexAttribPointer(a.vertexZDepthAttribute,this.vertexZDepthBuffer.itemSize,b.FLOAT,!1,0,0)};d.render=function(b){var a=this.vertexPositionBuffer.numItems;a&&(this.bindBuffers(b),b.drawArrays(b.TRIANGLES,0,a))}})(ChemDoodle.structures.d3,Math);
(function(d,b,a,f,g,e,m){var c=function(a,c,b){var d=g.sqrt(c[1]*c[1]+c[2]*c[2]),f=[1,0,0,0,0,c[2]/d,-c[1]/d,0,0,c[1]/d,c[2]/d,0,0,0,0,1],m=[1,0,0,0,0,c[2]/d,c[1]/d,0,0,-c[1]/d,c[2]/d,0,0,0,0,1],v=[d,0,-c[0],0,0,1,0,0,c[0],0,d,0,0,0,0,1];c=[d,0,c[0],0,0,1,0,0,-c[0],0,d,0,0,0,0,1];b=[g.cos(b),-g.sin(b),0,0,g.sin(b),g.cos(b),0,0,0,0,1,0,0,0,0,1];var k=e.multiply(f,e.multiply(v,e.multiply(b,e.multiply(c,m,[]))));this.rotate=function(){return e.multiplyVec3(k,a)}};f.Tube=function(f,w,n){var h=f[0].lineSegments[0].length;
this.partitions=[];var l;this.ends=[];this.ends.push(f[0].lineSegments[0][0]);this.ends.push(f[f.length-2].lineSegments[0][0]);for(var o=[1,0,0],v=0,k=f.length-1;v<k;v++){if(!l||65E3<l.positionData.length)0<this.partitions.length&&v--,l={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(l);var t=f[v];l.count++;for(var u=Infinity,q=new a.Atom("",f[v+1].cp1.x,f[v+1].cp1.y,f[v+1].cp1.z),r=0;r<h;r++){var p=t.lineSegments[0][r],y;y=r===h-1?v===f.length-2?t.lineSegments[0][r-1]:f[v+
1].lineSegments[0][0]:t.lineSegments[0][r+1];y=[y.x-p.x,y.y-p.y,y.z-p.z];m.normalize(y);v===f.length-2&&r===h-1&&m.scale(y,-1);var z=vec3.cross(y,o,[]);m.normalize(z);m.scale(z,w/2);z=new c(z,y,2*Math.PI/n);y=0;for(var x=n;y<x;y++){var A=z.rotate();y===g.floor(n/4)&&(o=[A[0],A[1],A[2]]);l.normalData.push(A[0],A[1],A[2]);l.positionData.push(p.x+A[0],p.y+A[1],p.z+A[2])}q&&(y=p.distance3D(q),y<u&&(u=y,f[v+1].pPoint=p))}}o=0;for(t=this.partitions.length;o<t;o++){l=this.partitions[o];v=0;for(k=l.count-
1;v<k;v++){u=v*h*n;r=0;for(q=h;r<q;r++){p=u+r*n;for(y=0;y<n;y++)z=p+y,l.indexData.push(z),l.indexData.push(z+n),l.indexData.push(z+n+1),l.indexData.push(z),l.indexData.push(z+1),l.indexData.push(z+n+1)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);n=[new a.Point(2,0)];for(v=0;60>v;v++)h=v/60*g.PI,n.push(new a.Point(2*g.cos(h),-2*g.sin(h)));n.push(new a.Point(-2,0),new a.Point(-2,4),new a.Point(2,4));var C=new a.d3.Shape(n,1);this.render=
function(c,h){this.bindBuffers(c);c.material.setDiffuseColor(h.macro_colorByChain?this.chainColor:h.nucleics_tubeColor);c.drawElements(c.TRIANGLES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0);if(this.partitions)for(var l=1,n=this.partitions.length;l<n;l++){var o=this.partitions[l],k=c,t=o;k.bindBuffer(k.ARRAY_BUFFER,t.vertexPositionBuffer);k.vertexAttribPointer(k.shader.vertexPositionAttribute,t.vertexPositionBuffer.itemSize,k.FLOAT,!1,0,0);k.bindBuffer(k.ARRAY_BUFFER,t.vertexNormalBuffer);
k.vertexAttribPointer(k.shader.vertexNormalAttribute,t.vertexNormalBuffer.itemSize,k.FLOAT,!1,0,0);k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,t.vertexIndexBuffer);c.drawElements(c.TRIANGLES,o.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)}c.sphereBuffer.bindBuffers(c);for(l=0;2>l;l++)o=this.ends[l],o=e.translate(c.modelViewMatrix,[o.x,o.y,o.z],[]),n=w/2,e.scale(o,[n,n,n]),c.setMatrixUniforms(o),c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0);c.cylinderBuffer.bindBuffers(c);
l=1;for(n=f.length-1;l<n;l++){var t=f[l],q=t.pPoint,u=new a.Atom("",t.cp2.x,t.cp2.y,t.cp2.z),o=1.001*q.distance3D(u),t=[w/4,o,w/4],o=e.translate(c.modelViewMatrix,[q.x,q.y,q.z],[]),v=[0,1,0],p=0,k=[u.x-q.x,u.y-q.y,u.z-q.z];q.x===u.x&&q.z===u.z?(v=[0,0,1],q.y<q.y&&(p=g.PI)):(p=d.vec3AngleFrom(v,k),v=m.cross(v,k,[]));0!==p&&e.rotate(o,p,v);e.scale(o,t);c.setMatrixUniforms(o);c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems)}C.bindBuffers(c);!h.nucleics_useShapelyColors&&
!h.macro_colorByChain&&c.material.setDiffuseColor(h.nucleics_baseColor);l=1;for(n=f.length-1;l<n;l++)t=f[l],u=t.cp2,o=e.translate(c.modelViewMatrix,[u.x,u.y,u.z],[]),v=[0,1,0],p=0,q=t.cp3,k=[q.x-u.x,q.y-u.y,q.z-u.z],u.x===q.x&&u.z===q.z?(v=[0,0,1],u.y<u.y&&(p=g.PI)):(p=d.vec3AngleFrom(v,k),v=m.cross(v,k,[])),0!==p&&e.rotate(o,p,v),u=[1,0,0],p=e.rotate(e.identity([]),p,v),e.multiplyVec3(p,u),p=t.cp4,q=t.cp5,p.y===q.y&&p.z===q.z||(p=[q.x-p.x,q.y-p.y,q.z-p.z],q=d.vec3AngleFrom(u,p),0>m.dot(k,m.cross(u,
p))&&(q*=-1),e.rotateY(o,q)),h.nucleics_useShapelyColors&&!h.macro_colorByChain&&(b[t.name]?c.material.setDiffuseColor(b[t.name].shapelyColor):c.material.setDiffuseColor(b["*"].shapelyColor)),c.setMatrixUniforms(o),c.drawElements(c.TRIANGLES,C.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)}};f.Tube.prototype=new f._Mesh})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,mat4,vec3);
(function(d){d.UnitCell=function(b){var a=[],d=[],g=function(e,c,b,g){a.push(e[0],e[1],e[2]);a.push(c[0],c[1],c[2]);a.push(b[0],b[1],b[2]);a.push(g[0],g[1],g[2]);for(e=0;4>e;e++)d.push(0,0,0)};g(b.o,b.x,b.xy,b.y);g(b.o,b.y,b.yz,b.z);g(b.o,b.z,b.xz,b.x);g(b.yz,b.y,b.xy,b.xyz);g(b.xyz,b.xz,b.z,b.yz);g(b.xy,b.x,b.xz,b.xyz);b=[];for(g=0;6>g;g++){var e=4*g;b.push(e,e+1,e+1,e+2,e+2,e+3,e+3,e)}this.storeData(a,d,b)};d.UnitCell.prototype=new d._Mesh})(ChemDoodle.structures.d3,vec3);
(function(d,b,a){d.Plate=function(a){this.lanes=Array(a);i=0;for(ii=a;i<ii;i++)this.lanes[i]=[]};var f=d.Plate.prototype;f.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(a,e){return a-e})};f.draw=function(d){var e=d.canvas.width,f=d.canvas.height;this.origin=9*f/10;this.front=f/10;this.laneLength=this.origin-this.front;d.strokeStyle="#000000";d.beginPath();d.moveTo(0,this.front);b.contextHashTo(d,0,this.front,e,this.front,3,3);d.closePath();d.stroke();d.beginPath();
d.moveTo(0,this.origin);d.lineTo(e,this.origin);d.closePath();d.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){f=(i+1)*e/(ii+1);d.beginPath();d.moveTo(f,this.origin);d.lineTo(f,this.origin+3);d.closePath();d.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var c=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":d.beginPath();d.arc(f,c,3,0,2*a.PI,!1);d.closePath();break;case "expanded":d.beginPath();d.arc(f,c,7,0,2*a.PI,!1);d.closePath();break;case "widened":b.contextOval(d,
f-18,c-10,36,10);break;case "cresent":d.beginPath(),d.arc(f,c,9,0,a.PI,!0),d.closePath()}switch(this.lanes[i][s].style){case "solid":d.fillStyle="#000000";d.fill();break;case "transparent":d.stroke()}}}};d.Plate.Spot=function(a,e,b){this.type=a;this.rf=e;this.style=b?b:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(d,b,a){d.default_backgroundColor="#FFFFFF";d.default_scale=1;d.default_rotateAngle=0;d.default_bondLength_2D=20;d.default_angstromsPerBondLength=1.25;d.default_lightDirection_3D=[-0.1,-0.1,-1];d.default_lightDiffuseColor_3D="#FFFFFF";d.default_lightSpecularColor_3D="#FFFFFF";d.default_projectionPerspective_3D=!0;d.default_projectionPerspectiveVerticalFieldOfView_3D=45;d.default_projectionOrthoWidth_3D=40;d.default_projectionWidthHeightRatio_3D=void 0;d.default_projectionFrontCulling_3D=
0.1;d.default_projectionBackCulling_3D=1E4;d.default_fog_mode_3D=0;d.default_fog_color_3D="#000000";d.default_fog_start_3D=0;d.default_fog_end_3D=1;d.default_fog_density_3D=1;d.default_atoms_display=!0;d.default_atoms_color="#000000";d.default_atoms_font_size_2D=12;d.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];d.default_atoms_font_bold_2D=!1;d.default_atoms_font_italic_2D=!1;d.default_atoms_circles_2D=!1;d.default_atoms_circleDiameter_2D=10;d.default_atoms_circleBorderWidth_2D=1;
d.default_atoms_lonePairDistance_2D=8;d.default_atoms_lonePairSpread_2D=4;d.default_atoms_lonePairDiameter_2D=1;d.default_atoms_useJMOLColors=!1;d.default_atoms_usePYMOLColors=!1;d.default_atoms_resolution_3D=60;d.default_atoms_sphereDiameter_3D=0.8;d.default_atoms_useVDWDiameters_3D=!1;d.default_atoms_vdwMultiplier_3D=1;d.default_atoms_materialAmbientColor_3D="#000000";d.default_atoms_materialSpecularColor_3D="#555555";d.default_atoms_materialShininess_3D=32;d.default_atoms_implicitHydrogens_2D=
!0;d.default_atoms_displayTerminalCarbonLabels_2D=!1;d.default_atoms_showHiddenCarbons_2D=!0;d.default_atoms_showAttributedCarbons_2D=!0;d.default_atoms_displayAllCarbonLabels_2D=!1;d.default_atoms_nonBondedAsStars_3D=!1;d.default_atoms_displayLabels_3D=!1;d.default_bonds_display=!0;d.default_bonds_color="#000000";d.default_bonds_width_2D=1;d.default_bonds_saturationWidth_2D=0.2;d.default_bonds_ends_2D="round";d.default_bonds_useJMOLColors=!1;d.default_bonds_usePYMOLColors=!1;d.default_bonds_colorGradient=
!1;d.default_bonds_saturationAngle_2D=a.PI/3;d.default_bonds_symmetrical_2D=!1;d.default_bonds_clearOverlaps_2D=!1;d.default_bonds_overlapClearWidth_2D=0.5;d.default_bonds_atomLabelBuffer_2D=1;d.default_bonds_wedgeThickness_2D=0.22;d.default_bonds_hashWidth_2D=1;d.default_bonds_hashSpacing_2D=2.5;d.default_bonds_dotSize_2D=2;d.default_bonds_showBondOrders_3D=!1;d.default_bonds_resolution_3D=60;d.default_bonds_renderAsLines_3D=!1;d.default_bonds_cylinderDiameter_3D=0.3;d.default_bonds_materialAmbientColor_3D=
"#222222";d.default_bonds_materialSpecularColor_3D="#555555";d.default_bonds_materialShininess_3D=32;d.default_proteins_displayRibbon=!0;d.default_proteins_displayBackbone=!1;d.default_proteins_backboneThickness=1.5;d.default_proteins_backboneColor="#CCCCCC";d.default_proteins_ribbonCartoonize=!1;d.default_proteins_useShapelyColors=!1;d.default_proteins_useAminoColors=!1;d.default_proteins_usePolarityColors=!1;d.default_proteins_primaryColor="#FF0D0D";d.default_proteins_secondaryColor="#FFFF30";d.default_proteins_ribbonCartoonHelixPrimaryColor=
"#00E740";d.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF";d.default_proteins_ribbonCartoonSheetColor="#E8BB99";d.default_proteins_ribbonThickness=0.2;d.default_proteins_verticalResolution=10;d.default_proteins_horizontalResolution=9;d.default_proteins_materialAmbientColor_3D="#222222";d.default_proteins_materialSpecularColor_3D="#555555";d.default_proteins_materialShininess_3D=32;d.default_nucleics_display=!0;d.default_nucleics_tubeColor="#CCCCCC";d.default_nucleics_baseColor="#C10000";
d.default_nucleics_useShapelyColors=!0;d.default_nucleics_tubeThickness=1.5;d.default_nucleics_tubeResolution_3D=60;d.default_nucleics_verticalResolution=10;d.default_nucleics_materialAmbientColor_3D="#222222";d.default_nucleics_materialSpecularColor_3D="#555555";d.default_nucleics_materialShininess_3D=32;d.default_macro_displayAtoms=!1;d.default_macro_displayBonds=!1;d.default_macro_atomToLigandDistance=-1;d.default_macro_showWater=!1;d.default_macro_colorByChain=!1;d.default_surfaces_display=!0;
d.default_surfaces_style="Dot";d.default_surfaces_color="#E9B862";d.default_surfaces_materialAmbientColor_3D="#000000";d.default_surfaces_materialSpecularColor_3D="#000000";d.default_surfaces_materialShininess_3D=32;d.default_crystals_displayUnitCell=!0;d.default_crystals_unitCellColor="green";d.default_crystals_unitCellLineWidth=1;d.default_plots_color="#000000";d.default_plots_width=1;d.default_plots_showIntegration=!1;d.default_plots_integrationColor="#c10000";d.default_plots_integrationLineWidth=
1;d.default_plots_showGrid=!1;d.default_plots_gridColor="gray";d.default_plots_gridLineWidth=0.5;d.default_plots_showYAxis=!0;d.default_plots_flipXAxis=!1;d.default_text_font_size=12;d.default_text_font_families=["Helvetica","Arial","Dialog"];d.default_text_color="#000000";d.default_shapes_color="#000000";d.default_shapes_lineWidth_2D=1;d.default_shapes_arrowLength_2D=8;d.default_labels_font_stroke_3D=!0;d.default_compass_display=!1;d.default_compass_axisXColor_3D="#FF0000";d.default_compass_axisYColor_3D=
"#00FF00";d.default_compass_axisZColor_3D="#0000FF";d.default_compass_size_3D=50;d.default_compass_resolution_3D=10;b.VisualSpecifications=function(){this.backgroundColor=d.default_backgroundColor;this.scale=d.default_scale;this.rotateAngle=d.default_rotateAngle;this.bondLength=d.default_bondLength_2D;this.angstromsPerBondLength=d.default_angstromsPerBondLength;this.lightDirection_3D=d.default_lightDirection_3D;this.lightDiffuseColor_3D=d.default_lightDiffuseColor_3D;this.lightSpecularColor_3D=d.default_lightSpecularColor_3D;
this.projectionPerspective_3D=d.default_projectionPerspective_3D;this.projectionPerspectiveVerticalFieldOfView_3D=d.default_projectionPerspectiveVerticalFieldOfView_3D;this.projectionOrthoWidth_3D=d.default_projectionOrthoWidth_3D;this.projectionWidthHeightRatio_3D=d.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=d.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=d.default_projectionBackCulling_3D;this.fog_mode_3D=d.default_fog_mode_3D;this.fog_color_3D=d.default_fog_color_3D;
this.fog_start_3D=d.default_fog_start_3D;this.fog_end_3D=d.default_fog_end_3D;this.fog_density_3D=d.default_fog_density_3D;this.atoms_display=d.default_atoms_display;this.atoms_color=d.default_atoms_color;this.atoms_font_size_2D=d.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var a=0,b=d.default_atoms_font_families_2D.length;a<b;a++)this.atoms_font_families_2D[a]=d.default_atoms_font_families_2D[a];this.atoms_font_bold_2D=d.default_atoms_font_bold_2D;this.atoms_font_italic_2D=d.default_atoms_font_italic_2D;
this.atoms_circles_2D=d.default_atoms_circles_2D;this.atoms_circleDiameter_2D=d.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=d.default_atoms_circleBorderWidth_2D;this.atoms_lonePairDistance_2D=d.default_atoms_lonePairDistance_2D;this.atoms_lonePairSpread_2D=d.default_atoms_lonePairSpread_2D;this.atoms_lonePairDiameter_2D=d.default_atoms_lonePairDiameter_2D;this.atoms_useJMOLColors=d.default_atoms_useJMOLColors;this.atoms_usePYMOLColors=d.default_atoms_usePYMOLColors;this.atoms_resolution_3D=
d.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=d.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=d.default_atoms_useVDWDiameters_3D;this.atoms_vdwMultiplier_3D=d.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=d.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=d.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=d.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=d.default_atoms_implicitHydrogens_2D;
this.atoms_displayTerminalCarbonLabels_2D=d.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=d.default_atoms_showHiddenCarbons_2D;this.atoms_showAttributedCarbons_2D=d.default_atoms_showAttributedCarbons_2D;this.atoms_displayAllCarbonLabels_2D=d.default_atoms_displayAllCarbonLabels_2D;this.atoms_nonBondedAsStars_3D=d.default_atoms_nonBondedAsStars_3D;this.atoms_displayLabels_3D=d.default_atoms_displayLabels_3D;this.bonds_display=d.default_bonds_display;this.bonds_color=
d.default_bonds_color;this.bonds_width_2D=d.default_bonds_width_2D;this.bonds_saturationWidth_2D=d.default_bonds_saturationWidth_2D;this.bonds_ends_2D=d.default_bonds_ends_2D;this.bonds_useJMOLColors=d.default_bonds_useJMOLColors;this.bonds_usePYMOLColors=d.default_bonds_usePYMOLColors;this.bonds_colorGradient=d.default_bonds_colorGradient;this.bonds_saturationAngle_2D=d.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=d.default_bonds_symmetrical_2D;this.bonds_clearOverlaps_2D=d.default_bonds_clearOverlaps_2D;
this.bonds_overlapClearWidth_2D=d.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=d.default_bonds_atomLabelBuffer_2D;this.bonds_wedgeThickness_2D=d.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=d.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=d.default_bonds_hashSpacing_2D;this.bonds_dotSize_2D=d.default_bonds_dotSize_2D;this.bonds_showBondOrders_3D=d.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=d.default_bonds_resolution_3D;this.bonds_renderAsLines_3D=
d.default_bonds_renderAsLines_3D;this.bonds_cylinderDiameter_3D=d.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=d.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=d.default_bonds_materialSpecularColor_3D;this.bonds_materialShininess_3D=d.default_bonds_materialShininess_3D;this.proteins_displayRibbon=d.default_proteins_displayRibbon;this.proteins_displayBackbone=d.default_proteins_displayBackbone;this.proteins_backboneThickness=d.default_proteins_backboneThickness;
this.proteins_backboneColor=d.default_proteins_backboneColor;this.proteins_ribbonCartoonize=d.default_proteins_ribbonCartoonize;this.proteins_useShapelyColors=d.default_proteins_useShapelyColors;this.proteins_useAminoColors=d.default_proteins_useAminoColors;this.proteins_usePolarityColors=d.default_proteins_usePolarityColors;this.proteins_primaryColor=d.default_proteins_primaryColor;this.proteins_secondaryColor=d.default_proteins_secondaryColor;this.proteins_ribbonCartoonHelixPrimaryColor=d.default_proteins_ribbonCartoonHelixPrimaryColor;
this.proteins_ribbonCartoonHelixSecondaryColor=d.default_proteins_ribbonCartoonHelixSecondaryColor;this.proteins_ribbonCartoonSheetColor=d.default_proteins_ribbonCartoonSheetColor;this.proteins_ribbonThickness=d.default_proteins_ribbonThickness;this.proteins_verticalResolution=d.default_proteins_verticalResolution;this.proteins_horizontalResolution=d.default_proteins_horizontalResolution;this.proteins_materialAmbientColor_3D=d.default_proteins_materialAmbientColor_3D;this.proteins_materialSpecularColor_3D=
d.default_proteins_materialSpecularColor_3D;this.proteins_materialShininess_3D=d.default_proteins_materialShininess_3D;this.macro_displayAtoms=d.default_macro_displayAtoms;this.macro_displayBonds=d.default_macro_displayBonds;this.macro_atomToLigandDistance=d.default_macro_atomToLigandDistance;this.nucleics_display=d.default_nucleics_display;this.nucleics_tubeColor=d.default_nucleics_tubeColor;this.nucleics_baseColor=d.default_nucleics_baseColor;this.nucleics_useShapelyColors=d.default_nucleics_useShapelyColors;
this.nucleics_tubeThickness=d.default_nucleics_tubeThickness;this.nucleics_tubeResolution_3D=d.default_nucleics_tubeResolution_3D;this.nucleics_verticalResolution=d.default_nucleics_verticalResolution;this.nucleics_materialAmbientColor_3D=d.default_nucleics_materialAmbientColor_3D;this.nucleics_materialSpecularColor_3D=d.default_nucleics_materialSpecularColor_3D;this.nucleics_materialShininess_3D=d.default_nucleics_materialShininess_3D;this.macro_showWater=d.default_macro_showWater;this.macro_colorByChain=
d.default_macro_colorByChain;this.surfaces_display=d.default_surfaces_display;this.surfaces_style=d.default_surfaces_style;this.surfaces_color=d.default_surfaces_color;this.surfaces_materialAmbientColor_3D=d.default_surfaces_materialAmbientColor_3D;this.surfaces_materialSpecularColor_3D=d.default_surfaces_materialSpecularColor_3D;this.surfaces_materialShininess_3D=d.default_surfaces_materialShininess_3D;this.crystals_displayUnitCell=d.default_crystals_displayUnitCell;this.crystals_unitCellColor=d.default_crystals_unitCellColor;
this.crystals_unitCellLineWidth=d.default_crystals_unitCellLineWidth;this.plots_color=d.default_plots_color;this.plots_width=d.default_plots_width;this.plots_showIntegration=d.default_plots_showIntegration;this.plots_integrationColor=d.default_plots_integrationColor;this.plots_integrationLineWidth=d.default_plots_integrationLineWidth;this.plots_showGrid=d.default_plots_showGrid;this.plots_gridColor=d.default_plots_gridColor;this.plots_gridLineWidth=d.default_plots_gridLineWidth;this.plots_showYAxis=
d.default_plots_showYAxis;this.plots_flipXAxis=d.default_plots_flipXAxis;this.text_font_size=d.default_text_font_size;this.text_font_families=[];a=0;for(b=d.default_text_font_families.length;a<b;a++)this.text_font_families[a]=d.default_text_font_families[a];this.text_color=d.default_text_color;this.shapes_color=d.default_shapes_color;this.shapes_lineWidth_2D=d.default_shapes_lineWidth_2D;this.shapes_arrowLength_2D=d.default_shapes_arrowLength_2D;this.labels_font_stroke_3D=d.default_labels_font_stroke_3D;
this.compass_display=d.default_compass_display;this.compass_axisXColor_3D=d.default_compass_axisXColor_3D;this.compass_axisYColor_3D=d.default_compass_axisYColor_3D;this.compass_axisZColor_3D=d.default_compass_axisZColor_3D;this.compass_size_3D=d.default_compass_size_3D;this.compass_resolution_3D=d.default_compass_resolution_3D};b=b.VisualSpecifications.prototype;b.set3DRepresentation=function(a){this.bonds_display=this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=
this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;"Ball and Stick"===a?(this.atoms_vdwMultiplier_3D=0.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=0.3,this.bonds_materialAmbientColor_3D=d.default_atoms_materialAmbientColor_3D):"van der Waals Spheres"===a?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===a?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=0.8,
this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===a?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=0.05,this.atoms_sphereDiameter_3D=0.15,this.bonds_materialAmbientColor_3D=d.default_atoms_materialAmbientColor_3D):"Line"===a?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=0.05):alert('"'+a+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};
b.getFontString=function(a,b,e,d){var c=[];e&&c.push("bold ");d&&c.push("italic ");c.push(a+"px ");a=0;for(e=b.length;a<e;a++)d=b[a],-1!==d.indexOf(" ")&&(d='"'+d+'"'),c.push((0!==a?",":"")+d);return c.join("")}})(ChemDoodle,ChemDoodle.structures,Math);
(function(d,b,a,f){a.getPointsPerAngstrom=function(){return d.default_bondLength_2D/d.default_angstromsPerBondLength};a.BondDeducer=function(){};var g=a.BondDeducer.prototype;g.margin=1.1;g.deduceCovalentBonds=function(e,d){var c=a.getPointsPerAngstrom();d&&(c=d);for(var g=0,w=e.atoms.length;g<w;g++)for(var n=g+1;n<w;n++){var h=e.atoms[g],l=e.atoms[n];h.distance3D(l)<(b[h.label].covalentRadius+b[l.label].covalentRadius)*c*this.margin&&e.bonds.push(new f.Bond(h,l,1))}}})(ChemDoodle,ChemDoodle.ELEMENT,
ChemDoodle.informatics,ChemDoodle.structures);(function(d){d.HydrogenDeducer=function(){};d.HydrogenDeducer.prototype.removeHydrogens=function(b){for(var a=[],d=[],g=0,e=b.bonds.length;g<e;g++)"H"!==b.bonds[g].a1.label&&"H"!==b.bonds[g].a2.label&&d.push(b.bonds[g]);g=0;for(e=b.atoms.length;g<e;g++)"H"!==b.atoms[g].label&&a.push(b.atoms[g]);b.atoms=a;b.bonds=d}})(ChemDoodle.informatics);
(function(d,b,a){b.MolecularSurfaceGenerator=function(){};b.MolecularSurfaceGenerator.prototype.generateSurface=function(b,d,e,m,c){return new a.MolecularSurface(b,d,e,m,c)}})(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures.d3);
(function(d,b){d.Splitter=function(){};d.Splitter.prototype.split=function(a){for(var d=[],g=0,e=a.atoms.length;g<e;g++)a.atoms[g].visited=!1;g=0;for(e=a.bonds.length;g<e;g++)a.bonds[g].visited=!1;g=0;for(e=a.atoms.length;g<e;g++){var m=a.atoms[g];if(!m.visited){var c=new b.Molecule;c.atoms.push(m);m.visited=!0;var j=new b.Queue;for(j.enqueue(m);!j.isEmpty();)for(var m=j.dequeue(),w=0,n=a.bonds.length;w<n;w++){var h=a.bonds[w];h.contains(m)&&!h.visited&&(h.visited=!0,c.bonds.push(h),h=h.getNeighbor(m),
h.visited||(h.visited=!0,c.atoms.push(h),j.enqueue(h)))}d.push(c)}}return d}})(ChemDoodle.informatics,ChemDoodle.structures);(function(d,b){d.StructureBuilder=function(){};d.StructureBuilder.prototype.copy=function(a){var d=new b.JSONInterpreter;return d.molFrom(d.molTo(a))}})(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures);
(function(d){d._Counter=function(){};d=d._Counter.prototype;d.value=0;d.molecule=void 0;d.setMolecule=function(b){this.value=0;this.molecule=b;this.innerCalculate&&this.innerCalculate()}})(ChemDoodle.informatics);(function(d){d.FrerejacqueNumberCounter=function(b){this.setMolecule(b)};(d.FrerejacqueNumberCounter.prototype=new d._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new d.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(d,b){b.NumberOfMoleculesCounter=function(a){this.setMolecule(a)};(b.NumberOfMoleculesCounter.prototype=new b._Counter).innerCalculate=function(){for(var a=0,b=this.molecule.atoms.length;a<b;a++)this.molecule.atoms[a].visited=!1;a=0;for(b=this.molecule.atoms.length;a<b;a++)if(!this.molecule.atoms[a].visited){this.value++;var g=new d.Queue;this.molecule.atoms[a].visited=!0;for(g.enqueue(this.molecule.atoms[a]);!g.isEmpty();)for(var e=g.dequeue(),m=0,c=this.molecule.bonds.length;m<c;m++){var j=
this.molecule.bonds[m];j.contains(e)&&(j=j.getNeighbor(e),j.visited||(j.visited=!0,g.enqueue(j)))}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(d){d._RingFinder=function(){};d=d._RingFinder.prototype;d.atoms=void 0;d.bonds=void 0;d.rings=void 0;d.reduce=function(b){for(var a=0,d=b.atoms.length;a<d;a++)b.atoms[a].visited=!1;a=0;for(d=b.bonds.length;a<d;a++)b.bonds[a].visited=!1;for(var g=!0;g;){g=!1;a=0;for(d=b.atoms.length;a<d;a++){for(var e=0,m,c=0,j=b.bonds.length;c<j;c++)if(b.bonds[c].contains(b.atoms[a])&&!b.bonds[c].visited){e++;if(2===e)break;m=b.bonds[c]}1===e&&(g=!0,m.visited=!0,b.atoms[a].visited=!0)}}a=0;for(d=b.atoms.length;a<
d;a++)b.atoms[a].visited||this.atoms.push(b.atoms[a]);a=0;for(d=b.bonds.length;a<d;a++)b.bonds[a].visited||this.bonds.push(b.bonds[a]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])};d.setMolecule=function(b){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(b);2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()};d.fuse=function(){for(var b=0,a=this.rings.length;b<a;b++)for(var d=0,g=this.bonds.length;d<g;d++)-1!==this.rings[b].atoms.indexOf(this.bonds[d].a1)&&-1!==this.rings[b].atoms.indexOf(this.bonds[d].a2)&&
this.rings[b].bonds.push(this.bonds[d])}})(ChemDoodle.informatics);
(function(d,b){function a(a,b){this.atoms=[];if(b)for(var d=0,c=b.atoms.length;d<c;d++)this.atoms[d]=b.atoms[d];this.atoms.push(a)}var f=a.prototype;f.grow=function(b,e){for(var d=this.atoms[this.atoms.length-1],c=[],f=0,w=b.length;f<w;f++)if(b[f].contains(d)){var n=b[f].getNeighbor(d);-1===e.indexOf(n)&&c.push(n)}d=[];f=0;for(w=c.length;f<w;f++)d.push(new a(c[f],this));return d};f.check=function(a,e,d){for(var c=0,f=e.atoms.length-1;c<f;c++)if(-1!==this.atoms.indexOf(e.atoms[c]))return;var w;if(e.atoms[e.atoms.length-
1]===this.atoms[this.atoms.length-1]){w=new b.Ring;w.atoms[0]=d;c=0;for(f=this.atoms.length;c<f;c++)w.atoms.push(this.atoms[c]);for(c=e.atoms.length-2;0<=c;c--)w.atoms.push(e.atoms[c])}else{for(var n=[],c=0,f=a.length;c<f;c++)a[c].contains(e.atoms[e.atoms.length-1])&&n.push(a[c]);c=0;for(f=n.length;c<f;c++)if((1===e.atoms.length||!n[c].contains(e.atoms[e.atoms.length-2]))&&n[c].contains(this.atoms[this.atoms.length-1])){w=new b.Ring;w.atoms[0]=d;a=0;for(d=this.atoms.length;a<d;a++)w.atoms.push(this.atoms[a]);
for(a=e.atoms.length-1;0<=a;a--)w.atoms.push(e.atoms[a]);break}}return w};d.EulerFacetRingFinder=function(a){this.setMolecule(a)};f=d.EulerFacetRingFinder.prototype=new d._RingFinder;f.fingerBreak=5;f.innerGetRings=function(){for(var b=0,e=this.atoms.length;b<e;b++){for(var d=[],c=0,f=this.bonds.length;c<f;c++)this.bonds[c].contains(this.atoms[b])&&d.push(this.bonds[c].getNeighbor(this.atoms[b]));c=0;for(f=d.length;c<f;c++)for(var w=c+1;w<d.length;w++){var n=[];n[0]=new a(d[c]);n[1]=new a(d[w]);var h=
[];h[0]=this.atoms[b];for(var l=0,o=d.length;l<o;l++)l!==c&&l!==w&&h.push(d[l]);var v=[];for((l=n[0].check(this.bonds,n[1],this.atoms[b]))&&(v[0]=l);0===v.length&&0<n.length&&n[0].atoms.length<this.fingerBreak;){for(var k=[],l=0,o=n.length;l<o;l++)for(var t=n[l].grow(this.bonds,h),u=0,q=t.length;u<q;u++)k.push(t[u]);n=k;l=0;for(o=n.length;l<o;l++)for(u=l+1;u<o;u++)(q=n[l].check(this.bonds,n[u],this.atoms[b]))&&v.push(q);if(0===v.length){k=[];l=0;for(o=h.length;l<o;l++){u=0;for(q=this.bonds.length;u<
q;u++)this.bonds[u].contains(h[l])&&(d=this.bonds[u].getNeighbor(h[l]),-1===h.indexOf(d)&&-1===k.indexOf(d)&&k.push(d))}l=0;for(o=k.length;l<o;l++)h.push(k[l])}}if(0<v.length){n=void 0;l=0;for(o=v.length;l<o;l++)if(!n||n.atoms.length>v[l].atoms.length)n=v[l];v=!1;l=0;for(o=this.rings.length;l<o;l++){h=!0;u=0;for(q=n.atoms.length;u<q;u++)if(-1===this.rings[l].atoms.indexOf(n.atoms[u])){h=!1;break}if(h){v=!0;break}}v||this.rings.push(n)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(d){d.SSSRFinder=function(b){this.rings=[];if(0<b.atoms.length){var a=(new d.FrerejacqueNumberCounter(b)).value,f=(new d.EulerFacetRingFinder(b)).rings;f.sort(function(a,c){return a.atoms.length-c.atoms.length});for(var g=0,e=b.bonds.length;g<e;g++)b.bonds[g].visited=!1;g=0;for(e=f.length;g<e;g++){b=!1;for(var m=0,c=f[g].bonds.length;m<c;m++)if(!f[g].bonds[m].visited){b=!0;break}if(b){m=0;for(c=f[g].bonds.length;m<c;m++)f[g].bonds[m].visited=!0;this.rings.push(f[g])}if(this.rings.length===
a)break}}}})(ChemDoodle.informatics);(function(d){d._Interpreter=function(){};d._Interpreter.prototype.fit=function(b,a,d){for(var g=b.length,e=[],m=0;m<a-g;m++)e.push(" ");return d?b+e.join(""):e.join("")+b}})(ChemDoodle.io);
(function(d,b,a,f,g,e){var m=/\s+/g,c=/\(|\)|\s+/g,j=/\'|\s+/g,w=/,|\'|\s+/g,n=/^\s+/,h=/[0-9]/g,l=/[0-9]|\+|\-/g,o=function(a){return 0!==a.length},v={P:[],A:[[0,0.5,0.5]],B:[[0.5,0,0.5]],C:[[0.5,0.5,0]],I:[[0.5,0.5,0.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,0.5,0.5],[0.5,0,0.5],[0.5,0.5,0]]},k=function(a){var c=0,b=0,e=0,d=0,f=a.indexOf("x"),g=a.indexOf("y"),j=a.indexOf("z");-1!==f&&(b++,0<f&&"+"!==a.charAt(f-1)&&(b*=-1));-1!==g&&
(e++,0<g&&"+"!==a.charAt(g-1)&&(e*=-1));-1!==j&&(d++,0<j&&"+"!==a.charAt(j-1)&&(d*=-1));if(2<a.length){f="+";g=0;for(j=a.length;g<j;g++){var l=a.charAt(g);if(("-"===l||"/"===l)&&(g===a.length-1||a.charAt(g+1).match(h)))f=l;l.match(h)&&("+"===f?c+=parseInt(l):"-"===f?c-=parseInt(l):"/"===f&&(c/=parseInt(l)))}}return[c,b,e,d]};a.CIFInterpreter=function(){};(a.CIFInterpreter.prototype=new a._Interpreter).read=function(a,h,t,p){h=h?h:1;t=t?t:1;p=p?p:1;var y=new f.Molecule;if(!a)return y;for(var z=a.split("\n"),
x=0,A=0,C=0,F=a=0,D=0,E="P",I,G,L,B,H=!0;0<z.length;)if(H?B=z.shift():H=!0,0<B.length)if(b.stringStartsWith(B,"_cell_length_a"))x=parseFloat(B.split(c)[1]);else if(b.stringStartsWith(B,"_cell_length_b"))A=parseFloat(B.split(c)[1]);else if(b.stringStartsWith(B,"_cell_length_c"))C=parseFloat(B.split(c)[1]);else if(b.stringStartsWith(B,"_cell_angle_alpha"))a=g.PI*parseFloat(B.split(c)[1])/180;else if(b.stringStartsWith(B,"_cell_angle_beta"))F=g.PI*parseFloat(B.split(c)[1])/180;else if(b.stringStartsWith(B,
"_cell_angle_gamma"))D=g.PI*parseFloat(B.split(c)[1])/180;else if(b.stringStartsWith(B,"_symmetry_space_group_name_H-M"))E=B.split(j)[1];else if(b.stringStartsWith(B,"loop_")){for(var J={fields:[],lines:[]},M=!1;void 0!==(B=z.shift())&&!b.stringStartsWith(B=B.replace(n,""),"loop_")&&0<B.length;)if(b.stringStartsWith(B,"_")){if(M)break;J.fields=J.fields.concat(B.split(m).filter(o))}else M=!0,J.lines.push(B);if(0!==z.length&&(b.stringStartsWith(B,"loop_")||b.stringStartsWith(B,"_")))H=!1;-1!==J.fields.indexOf("_symmetry_equiv_pos_as_xyz")||
-1!==J.fields.indexOf("_space_group_symop_operation_xyz")?I=J:-1!==J.fields.indexOf("_atom_site_label")?G=J:-1!==J.fields.indexOf("_geom_bond_atom_site_label_1")&&(L=J)}B=x;a=(g.cos(a)-g.cos(D)*g.cos(F))/g.sin(D);a=[B,0,0,0,A*g.cos(D),A*g.sin(D),0,0,C*g.cos(F),C*a,C*g.sqrt(1-g.pow(g.cos(F),2)-a*a),0,0,0,0,1];if(G){J=H=x=z=C=-1;D=0;for(F=G.fields.length;D<F;D++)B=G.fields[D],"_atom_site_type_symbol"===B?C=D:"_atom_site_label"===B?z=D:"_atom_site_fract_x"===B?x=D:"_atom_site_fract_y"===B?H=D:"_atom_site_fract_z"===
B&&(J=D);D=0;for(F=G.lines.length;D<F;D++)B=G.lines[D],A=B.split(m).filter(o),B=new f.Atom(A[-1===C?z:C].split(l)[0],parseFloat(A[x]),parseFloat(A[H]),parseFloat(A[J])),y.atoms.push(B),-1!==z&&(B.cifId=A[z],B.cifPart=0)}if(I&&!L){D=A=0;for(F=I.fields.length;D<F;D++)if(B=I.fields[D],"_symmetry_equiv_pos_as_xyz"===B||"_space_group_symop_operation_xyz"===B)A=D;H=v[E];z=[];D=0;for(F=I.lines.length;D<F;D++){B=I.lines[D].split(w).filter(o);for(var J=k(B[A]),M=k(B[A+1]),N=k(B[A+2]),E=0,x=y.atoms.length;E<
x;E++){B=y.atoms[E];var Q=B.x*J[1]+B.y*J[2]+B.z*J[3]+J[0],K=B.x*M[1]+B.y*M[2]+B.z*M[3]+M[0],P=B.x*N[1]+B.y*N[2]+B.z*N[3]+N[0];G=new f.Atom(B.label,Q,K,P);z.push(G);void 0!==B.cifId&&(G.cifId=B.cifId,G.cifPart=D+1);if(H){G=0;for(C=H.length;G<C;G++){var O=H[G],O=new f.Atom(B.label,Q+O[0],K+O[1],P+O[2]);z.push(O);void 0!==B.cifId&&(O.cifId=B.cifId,O.cifPart=D+1)}}}}D=0;for(F=z.length;D<F;D++){for(B=z[D];1<=B.x;)B.x--;for(;0>B.x;)B.x++;for(;1<=B.y;)B.y--;for(;0>B.y;)B.y++;for(;1<=B.z;)B.z--;for(;0>B.z;)B.z++}G=
[];D=0;for(F=z.length;D<F;D++){C=!1;B=z[D];E=0;for(x=y.atoms.length;E<x;E++)if(1E-4>y.atoms[E].distance3D(B)){C=!0;break}if(!C){E=0;for(x=G.length;E<x;E++)if(1E-4>G[E].distance3D(B)){C=!0;break}C||G.push(B)}}y.atoms=y.atoms.concat(G)}F=[];for(D=0;D<h;D++)for(E=0;E<t;E++)for(G=0;G<p;G++)if(!(0===D&&0===E&&0===G)){C=0;for(A=y.atoms.length;C<A;C++)B=y.atoms[C],z=new f.Atom(B.label,B.x+D,B.y+E,B.z+G),F.push(z),void 0!==B.cifId&&(z.cifId=B.cifId,z.cifPart=B.cifPart+(I?I.lines.length:0)+D+10*E+100*G)}y.atoms=
y.atoms.concat(F);D=0;for(F=y.atoms.length;D<F;D++)B=y.atoms[D],I=e.multiplyVec3(a,[B.x,B.y,B.z]),B.x=I[0],B.y=I[1],B.z=I[2];if(L){z=I=-1;D=0;for(F=L.fields.length;D<F;D++)B=L.fields[D],"_geom_bond_atom_site_label_1"===B?I=D:"_geom_bond_atom_site_label_2"===B&&(z=D);G=0;for(C=L.lines.length;G<C;G++){A=L.lines[G].split(m).filter(o);B=A[I];A=A[z];D=0;for(F=y.atoms.length;D<F;D++)for(E=D+1;E<F;E++){x=y.atoms[D];H=y.atoms[E];if(x.cifPart!==H.cifPart)break;(x.cifId===B&&H.cifId===A||x.cifId===A&&H.cifId===
B)&&y.bonds.push(new f.Bond(x,H))}}}else(new d.informatics.BondDeducer).deduceCovalentBonds(y,1);h=[-h/2,-t/2,-p/2];y.unitCellVectors={o:e.multiplyVec3(a,h,[]),x:e.multiplyVec3(a,[h[0]+1,h[1],h[2]]),y:e.multiplyVec3(a,[h[0],h[1]+1,h[2]]),z:e.multiplyVec3(a,[h[0],h[1],h[2]+1]),xy:e.multiplyVec3(a,[h[0]+1,h[1]+1,h[2]]),xz:e.multiplyVec3(a,[h[0]+1,h[1],h[2]+1]),yz:e.multiplyVec3(a,[h[0],h[1]+1,h[2]+1]),xyz:e.multiplyVec3(a,[h[0]+1,h[1]+1,h[2]+1])};return y};var t=new a.CIFInterpreter;d.readCIF=function(a,
c,b,e){return t.read(a,c,b,e)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3);
(function(d,b,a,f){a.MOLInterpreter=function(){};var g=a.MOLInterpreter.prototype=new a._Interpreter;g.read=function(a,c){c||(c=d.default_bondLength_2D);var e=new f.Molecule;if(!a)return e;for(var g=a.split("\n"),n=g[3],h=parseInt(n.substring(0,3)),n=parseInt(n.substring(3,6)),l=0;l<h;l++){var o=g[4+l];e.atoms[l]=new f.Atom(o.substring(31,34),parseFloat(o.substring(0,10))*c,(1===c?1:-1)*parseFloat(o.substring(10,20))*c,parseFloat(o.substring(20,30))*c);var v=parseInt(o.substring(34,36));0!==v&&b[e.atoms[l].label]&&
(e.atoms[l].mass=b[e.atoms[l].label].mass+v);switch(parseInt(o.substring(36,39))){case 1:e.atoms[l].charge=3;break;case 2:e.atoms[l].charge=2;break;case 3:e.atoms[l].charge=1;break;case 5:e.atoms[l].charge=-1;break;case 6:e.atoms[l].charge=-2;break;case 7:e.atoms[l].charge=-3}}for(l=0;l<n;l++){var o=g[4+h+l],k=parseInt(o.substring(6,9)),v=parseInt(o.substring(9,12));if(3<k)switch(k){case 4:k=1.5;break;default:k=1}o=new f.Bond(e.atoms[parseInt(o.substring(0,3))-1],e.atoms[parseInt(o.substring(3,6))-
1],k);switch(v){case 3:o.stereo=f.Bond.STEREO_AMBIGUOUS;break;case 1:o.stereo=f.Bond.STEREO_PROTRUDING;break;case 6:o.stereo=f.Bond.STEREO_RECESSED}e.bonds[l]=o}return e};g.write=function(a){var c=[];c.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");c.push(this.fit(a.atoms.length.toString(),3));c.push(this.fit(a.bonds.length.toString(),3));c.push("  0  0  0  0            999 v2000\n");for(var e=a.getCenter(),g=0,n=a.atoms.length;g<n;g++){var h=a.atoms[g],l=" 0";if(-1!==
h.mass&&b[h.label]){var o=h.mass-b[h.label].mass;5>o&&-4<o&&(l=(-1<o?" ":"")+o)}o="  0";if(0!==h.charge)switch(h.charge){case 3:o="  1";break;case 2:o="  2";break;case 1:o="  3";break;case -1:o="  5";break;case -2:o="  6";break;case -3:o="  7"}c.push(this.fit(((h.x-e.x)/d.default_bondLength_2D).toFixed(4),10));c.push(this.fit((-(h.y-e.y)/d.default_bondLength_2D).toFixed(4),10));c.push(this.fit((h.z/d.default_bondLength_2D).toFixed(4),10));c.push(" ");c.push(this.fit(h.label,3,!0));c.push(l);c.push(o);
c.push("  0  0  0  0\n")}g=0;for(n=a.bonds.length;g<n;g++)e=a.bonds[g],h=0,e.stereo===f.Bond.STEREO_AMBIGUOUS?h=3:e.stereo===f.Bond.STEREO_PROTRUDING?h=1:e.stereo===f.Bond.STEREO_RECESSED&&(h=6),c.push(this.fit((a.atoms.indexOf(e.a1)+1).toString(),3)),c.push(this.fit((a.atoms.indexOf(e.a2)+1).toString(),3)),c.push(this.fit(e.bondOrder.toString(),3)),c.push("  "),c.push(h),c.push("     0  0\n");c.push("M  END");return c.join("")};var e=new a.MOLInterpreter;d.readMOL=function(a,c){return e.read(a,c)};
d.writeMOL=function(a){return e.write(a)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures);
(function(d,b,a,f,g,e,m){function c(a,c,b,e,d){for(var f=0,g=c.length;f<g;f++){var j=c[f];if(j.id===b&&e>=j.start&&e<=j.end){d?a.helix=!0:a.sheet=!0;e+1===j.end&&(a.arrow=!0);break}}}a.PDBInterpreter=function(){};var j=a.PDBInterpreter.prototype=new a._Interpreter;j.calculateRibbonDistances=!1;j.deduceResidueBonds=!1;j.read=function(a,h){var l=new f.Molecule;l.chains=[];if(!a)return l;var j=a.split("\n");h||(h=1);for(var v=[],k=[],t,w=[],q=[],r=[],p=0,y=j.length;p<y;p++){var z=j[p];if(b.stringStartsWith(z,
"HELIX"))v.push({id:z.substring(19,20),start:parseInt(z.substring(21,25)),end:parseInt(z.substring(33,37))});else if(b.stringStartsWith(z,"SHEET"))k.push({id:z.substring(21,22),start:parseInt(z.substring(22,26)),end:parseInt(z.substring(33,37))});else if(b.stringStartsWith(z,"ATOM")){var x=z.substring(16,17);if(" "===x||"A"===x){x=e(z.substring(76,78));if(0===x.length){var A=e(z.substring(12,14));"HD"===A?x="H":0<A.length&&(x=1<A.length?A.charAt(0)+A.substring(1).toLowerCase():A)}A=new f.Atom(x,parseFloat(z.substring(30,
38))*h,parseFloat(z.substring(38,46))*h,parseFloat(z.substring(46,54))*h);A.hetatm=!1;q.push(A);var C=parseInt(z.substring(22,26));if(0===w.length)for(x=0;2>x;x++){var F=new f.Residue(-1);F.cp1=A;F.cp2=A;w.push(F)}C!==Number.NaN&&w[w.length-1].resSeq!==C&&(x=new f.Residue(C),x.name=e(z.substring(17,20)),3===x.name.length?x.name=x.name.substring(0,1)+x.name.substring(1).toLowerCase():2===x.name.length&&"D"===x.name.charAt(0)&&(x.name=x.name.substring(1)),w.push(x),F=z.substring(21,22),c(x,v,F,C,!0),
c(x,k,F,C,!1));z=e(z.substring(12,16));x=w[w.length-1];if("CA"===z||"P"===z||"O5'"===z)x.cp1||(x.cp1=A);else if("N3"===z&&("C"===x.name||"U"===x.name||"T"===x.name)||"N1"===z&&("A"===x.name||"G"===x.name))x.cp3=A;else if("C2"===z)x.cp4=A;else if("C4"===z&&("C"===x.name||"U"===x.name||"T"===x.name)||"C6"===z&&("A"===x.name||"G"===x.name))x.cp5=A;else if("O"===z||"C6"===z&&("C"===x.name||"U"===x.name||"T"===x.name)||"N9"===z){if(!w[w.length-1].cp2){if("C6"===z||"N9"===z)t=A;x.cp2=A}}else"C"===z&&(t=
A)}}else if(b.stringStartsWith(z,"HETATM"))x=e(z.substring(76,78)),0===x.length&&(x=e(z.substring(12,16))),1<x.length&&(x=x.substring(0,1)+x.substring(1).toLowerCase()),x=new f.Atom(x,parseFloat(z.substring(30,38))*h,parseFloat(z.substring(38,46))*h,parseFloat(z.substring(46,54))*h),x.hetatm=!0,"HOH"===e(z.substring(17,20))&&(x.isWater=!0),l.atoms.push(x),r[parseInt(e(z.substring(6,11)))]=x;else if(b.stringStartsWith(z,"CONECT")){if(x=parseInt(e(z.substring(6,11))),r[x]){A=r[x];for(C=0;4>C;C++)if(x=
e(z.substring(11+5*C,16+5*C)),0!==x.length&&(x=parseInt(x),r[x])){for(var F=r[x],D=!1,x=0,E=l.bonds.length;x<E;x++){var I=l.bonds[x];if(I.a1===A&&I.a2===F||I.a1===F&&I.a2===A){D=!0;break}}D||l.bonds.push(new f.Bond(A,F))}}}else if(b.stringStartsWith(z,"TER"))this.endChain(l,w,t,q),w=[];else if(b.stringStartsWith(z,"ENDMDL"))break}this.endChain(l,w,t,q);0===l.bonds.size&&(new d.informatics.BondDeducer).deduceCovalentBonds(l,h);if(this.deduceResidueBonds){p=0;for(y=q.length;p<y;p++){j=m.min(y,p+20);
for(x=p+1;x<j;x++)v=q[p],k=q[x],v.distance3D(k)<1.1*(g[v.label].covalentRadius+g[k.label].covalentRadius)&&l.bonds.push(new f.Bond(v,k,1))}}l.atoms=l.atoms.concat(q);this.calculateRibbonDistances&&this.calculateDistances(l,q);return l};j.endChain=function(a,c,b,e){if(0<c.length){var d=c[c.length-1];d.cp1||(d.cp1=e[e.length-2]);d.cp2||(d.cp2=e[e.length-1]);for(e=0;4>e;e++)d=new f.Residue(-1),d.cp1=b,d.cp2=c[c.length-1].cp2,c.push(d);a.chains.push(c)}};j.calculateDistances=function(a,c){for(var e=[],
b=0,d=a.atoms.length;b<d;b++){var f=a.atoms[b];f.hetatm&&(f.isWater||e.push(f))}b=0;for(d=c.length;b<d;b++)if(f=c[b],f.closestDistance=Number.POSITIVE_INFINITY,0===e.length)f.closestDistance=0;else for(var g=0,j=e.length;g<j;g++)f.closestDistance=Math.min(f.closestDistance,f.distance3D(e[g]))};var w=new a.PDBInterpreter;d.readPDB=function(a,c){return w.read(a,c)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,jQuery.trim,Math);
(function(d,b,a,f,g,e){var m={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},c={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},j={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};a.JCAMPInterpreter=function(){};g=a.JCAMPInterpreter.prototype=new a._Interpreter;g.convertHZ2PPM=!1;g.read=function(a){this.isBreak=function(a){return void 0!==m[a]||void 0!==c[a]||void 0!==j[a]||" "===a||"-"===a||"+"===a};this.getValue=function(a,b){var e=
a.charAt(0),d=a.substring(1);return void 0!==m[e]?parseFloat(m[e]+d):void 0!==c[e]?parseFloat(c[e]+d)+b:parseFloat(d)};var d=new f.Spectrum;if(void 0===a||0===a.length)return d;a=a.split("\n");for(var g=[],o,w,k,t,u=1,q=1,r=1,p=-1,y=-1,z=-1,x=!0,A=!1,C=0,F=a.length;C<F;C++){var D=e(a[C]),E=D.indexOf("$$");-1!==E&&(D=D.substring(0,E));if(0===g.length||!b.stringStartsWith(a[C],"##"))0!==g.length&&g.push("\n"),g.push(e(D));else if(E=g.join(""),x&&100>E.length&&d.metadata.push(E),g=[D],b.stringStartsWith(E,
"##TITLE\x3d"))d.title=e(E.substring(8));else if(b.stringStartsWith(E,"##XUNITS\x3d"))d.xUnit=e(E.substring(9)),this.convertHZ2PPM&&"HZ"===d.xUnit.toUpperCase()&&(d.xUnit="PPM",A=!0);else if(b.stringStartsWith(E,"##YUNITS\x3d"))d.yUnit=e(E.substring(9));else if(!b.stringStartsWith(E,"##XYPAIRS\x3d"))if(b.stringStartsWith(E,"##FIRSTX\x3d"))w=parseFloat(e(E.substring(9)));else if(b.stringStartsWith(E,"##LASTX\x3d"))o=parseFloat(e(E.substring(8)));else if(b.stringStartsWith(E,"##FIRSTY\x3d"))k=parseFloat(e(E.substring(9)));
else if(b.stringStartsWith(E,"##NPOINTS\x3d"))t=parseFloat(e(E.substring(10)));else if(b.stringStartsWith(E,"##XFACTOR\x3d"))u=parseFloat(e(E.substring(10)));else if(b.stringStartsWith(E,"##YFACTOR\x3d"))q=parseFloat(e(E.substring(10)));else if(b.stringStartsWith(E,"##DELTAX\x3d"))p=parseFloat(e(E.substring(9)));else if(b.stringStartsWith(E,"##.OBSERVE FREQUENCY\x3d"))this.convertHZ2PPM&&(r=parseFloat(e(E.substring(21))));else if(b.stringStartsWith(E,"##.SHIFT REFERENCE\x3d"))this.convertHZ2PPM&&
(z=E.substring(19).split(","),y=parseInt(e(z[2])),z=parseFloat(e(z[3])));else if(b.stringStartsWith(E,"##XYDATA\x3d")){A||(r=1);var D=x=!1,E=E.split("\n"),I=(o-w)/(t-1);if(-1!==p)for(var G=1,L=E.length;G<L;G++)if("|"===E[G].charAt(0)){I=p;break}for(var B=w-I,H=k,J=0,M,G=1,L=E.length;G<L;G++){for(var N=[],B=e(E[G]),g=[],Q=!1,K=0,P=B.length;K<P;K++)this.isBreak(B.charAt(K))?(0<g.length&&!(1===g.length&&" "===g[0])&&N.push(g.join("")),g=[B.charAt(K)]):"|"===B.charAt(K)?Q=!0:g.push(B.charAt(K));N.push(g.join(""));
B=parseFloat(N[0])*u-I;K=1;for(P=N.length;K<P;K++)if(H=N[K],void 0!==j[H.charAt(0)])for(var O=parseInt(j[H.charAt(0)]+H.substring(1))-1,S=0;S<O;S++)B+=I,J=this.getValue(M,J),H=J*q,R++,d.data[d.data.length-1]=new f.Point(B/r,H);else void 0!==m[H.charAt(0)]&&D?(H=this.getValue(H,J)*q,Q&&(B+=I,d.data.push(new f.Point(B/r,H)))):(D=void 0!==c[H.charAt(0)],M=H,B+=I,J=this.getValue(H,J),H=J*q,R++,d.data.push(new f.Point(B/r,H)))}if(-1!==y){D=z-d.data[y-1].x;C=0;for(F=d.data.length;C<F;C++)d.data[C].x+=D}}else if(b.stringStartsWith(E,
"##PEAK TABLE\x3d")){x=!1;d.continuous=!1;for(var E=E.split("\n"),R=0,G=1,L=E.length;G<L;G++){D=E[G].split(/[\s,]+/);R+=D.length/2;K=0;for(P=D.length;K+1<P;K+=2)d.data.push(new f.Point(parseFloat(e(D[K])),parseFloat(e(D[K+1]))))}}}d.setup();return d};var w=new a.JCAMPInterpreter;w.convertHZ2PPM=!0;d.readJCAMP=function(a){return w.read(a)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(d,b,a,f,g){b.JSONInterpreter=function(){};var e=b.JSONInterpreter.prototype;e.contentTo=function(a,e){for(var b=0,d=0,f=0,g=a.length;f<g;f++){for(var o=a[f],m=0,k=o.atoms.length;m<k;m++)o.atoms[m].tmpid="a"+b++;m=0;for(k=o.bonds.length;m<k;m++)o.bonds[m].tmpid="b"+d++}f=b=0;for(g=e.length;f<g;f++)e[f].tmpid="s"+b++;b={};if(a&&0<a.length){b.m=[];f=0;for(g=a.length;f<g;f++)b.m.push(this.molTo(a[f]))}if(e&&0<e.length){b.s=[];f=0;for(g=e.length;f<g;f++)b.s.push(this.shapeTo(e[f]))}f=0;for(g=
a.length;f<g;f++){o=a[f];m=0;for(k=o.atoms.length;m<k;m++)o.atoms[m].tmpid=void 0;m=0;for(k=o.bonds.length;m<k;m++)o.bonds[m].tmpid=void 0}f=0;for(g=e.length;f<g;f++)e[f].tmpid=void 0;return b};e.contentFrom=function(a){var e={molecules:[],shapes:[]};if(a.m)for(var b=0,d=a.m.length;b<d;b++)e.molecules.push(this.molFrom(a.m[b]));if(a.s){b=0;for(d=a.s.length;b<d;b++)e.shapes.push(this.shapeFrom(a.s[b],e.molecules))}b=0;for(d=e.molecules.length;b<d;b++){a=e.molecules[b];for(var f=0,g=a.atoms.length;f<
g;f++)a.atoms[f].tmpid=void 0;f=0;for(g=a.bonds.length;f<g;f++)a.bonds[f].tmpid=void 0}b=0;for(d=e.shapes.length;b<d;b++)e.shapes[b].tmpid=void 0;return e};e.molTo=function(c){for(var b={a:[]},e=0,d=c.atoms.length;e<d;e++){var f=c.atoms[e],g={x:f.x,y:f.y};f.tmpid&&(g.i=f.tmpid);"C"!==f.label&&(g.l=f.label);0!==f.z&&(g.z=f.z);0!==f.charge&&(g.c=f.charge);-1!==f.mass&&(g.m=f.mass);0!==f.numRadical&&(g.r=f.numRadical);0!==f.numLonePair&&(g.p=f.numLonePair);f.any&&(g.q=!0);-1!==f.rgroup&&(g.rg=f.rgroup);
b.a.push(g)}if(0<c.bonds.length){b.b=[];e=0;for(d=c.bonds.length;e<d;e++)f=c.bonds[e],g={b:c.atoms.indexOf(f.a1),e:c.atoms.indexOf(f.a2)},f.tmpid&&(g.i=f.tmpid),1!==f.bondOrder&&(g.o=f.bondOrder),f.stereo!==a.Bond.STEREO_NONE&&(g.s=f.stereo),b.b.push(g)}return b};e.molFrom=function(c){for(var b=new a.Molecule,e=0,d=c.a.length;e<d;e++){var f=c.a[e],g=new a.Atom(f.l?f.l:"C",f.x,f.y);f.i&&(g.tmpid=f.i);f.z&&(g.z=f.z);f.c&&(g.charge=f.c);f.m&&(g.mass=f.m);f.r&&(g.numRadical=f.r);f.p&&(g.numLonePair=f.p);
f.q&&(g.any=!0);f.rg&&(g.rgroup=f.rg);void 0!==f.p_h&&(g.hetatm=f.p_h);void 0!==f.p_w&&(g.isWater=f.p_w);void 0!==f.p_d&&(g.closestDistance=f.p_d);b.atoms.push(g)}if(c.b){e=0;for(d=c.b.length;e<d;e++)f=c.b[e],g=new a.Bond(b.atoms[f.b],b.atoms[f.e],f.o?f.o:1),f.i&&(g.tmpid=f.i),f.s&&(g.stereo=f.s),b.bonds.push(g)}return b};e.shapeTo=function(a){var b={};a.tmpid&&(b.i=a.tmpid);a instanceof f.Line?(b.t="Line",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,b.a=a.arrowType):a instanceof f.Pusher?(b.t=
"Pusher",b.o1=a.o1.tmpid,b.o2=a.o2.tmpid,1!==a.numElectron&&(b.e=a.numElectron)):a instanceof f.Bracket&&(b.t="Bracket",b.x1=a.p1.x,b.y1=a.p1.y,b.x2=a.p2.x,b.y2=a.p2.y,0!==a.charge&&(b.c=a.charge),0!==a.mult&&(b.m=a.mult),0!==a.repeat&&(b.r=a.repeat));return b};e.shapeFrom=function(c,b){var e;if("Line"===c.t)e=new f.Line(new a.Point(c.x1,c.y1),new a.Point(c.x2,c.y2)),e.arrowType=c.a;else if("Pusher"===c.t){var d,g;e=0;for(var l=b.length;e<l;e++){for(var m=b[e],v=0,k=m.atoms.length;v<k;v++){var t=
m.atoms[v];t.tmpid===c.o1?d=t:t.tmpid===c.o2&&(g=t)}v=0;for(k=m.bonds.length;v<k;v++)t=m.bonds[v],t.tmpid===c.o1?d=t:t.tmpid===c.o2&&(g=t)}e=new f.Pusher(d,g);c.e&&(e.numElectron=c.e)}else"Bracket"===c.t&&(e=new f.Bracket(new a.Point(c.x1,c.y1),new a.Point(c.x2,c.y2)),void 0!==c.c&&(e.charge=c.c),void 0!==c.m&&(e.mult=c.m),void 0!==c.r&&(e.repeat=c.r));return e};e.pdbFrom=function(a){var b=this.molFrom(a.mol);b.findRings=!1;b.fromJSON=!0;b.chains=this.chainsFrom(a.ribbons);return b};e.chainsFrom=
function(c){for(var b=[],e=0,d=c.cs.length;e<d;e++){for(var f=c.cs[e],g=[],m=0,v=f.length;m<v;m++){var k=f[m],t=new a.Residue;t.name=k.n;t.cp1=new a.Atom("",k.x1,k.y1,k.z1);t.cp2=new a.Atom("",k.x2,k.y2,k.z2);k.x3&&(t.cp3=new a.Atom("",k.x3,k.y3,k.z3),t.cp4=new a.Atom("",k.x4,k.y4,k.z4),t.cp5=new a.Atom("",k.x5,k.y5,k.z5));t.helix=k.h;t.sheet=k.s;t.arrow=k.a;g.push(t)}b.push(g)}return b};var m=new b.JSONInterpreter;d.readJSON=function(a){var b;try{b=g.parse(a)}catch(e){return}if(b)return b.m||b.s?
m.contentFrom(b):b.a?{molecules:[m.molFrom(b)],shapes:[]}:{molecules:[],shapes:[]}};d.writeJSON=function(a,b){return g.stringify(m.contentTo(a,b))}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,JSON);
(function(d,b,a){b.RXNInterpreter=function(){};var f=b.RXNInterpreter.prototype=new b._Interpreter;f.read=function(b,f){f||(f=d.default_bondLength_2D);var c=[],g;if(b){g=b.split("$MOL\n");for(var w=g[0].split("\n")[4],n=parseInt(w.substring(0,3)),w=parseInt(w.substring(3,6)),h=1,l=0,o=0,v=n+w;o<v;o++){c[o]=d.readMOL(g[h],f);var k=c[o].getBounds(),k=k.maxX-k.minX,l=l-(k+40);h++}o=0;for(v=n;o<v;o++){var k=c[o].getBounds(),k=k.maxX-k.minX,h=c[o].getCenter(),t=0;for(g=c[o].atoms.length;t<g;t++){var u=
c[o].atoms[t];u.x+=l+k/2-h.x;u.y-=h.y}l+=k+40}g=new a.d2.Line(new a.Point(l,0),new a.Point(l+40,0));l+=80;o=n;for(v=n+w;o<v;o++){k=c[o].getBounds();k=k.maxX-k.minX;h=c[o].getCenter();for(t=0;t<c[o].atoms.length;t++)u=c[o].atoms[t],u.x+=l+k/2-h.x,u.y-=h.y;l+=k+40}}else c.push(new a.Molecule),g=new a.d2.Line(new a.Point(-20,0),new a.Point(20,0));g.arrowType=a.d2.Line.ARROW_SYNTHETIC;return{molecules:c,shapes:[g]}};f.write=function(b,f){var c=[[],[]],g=void 0;if(b&&f){w=0;for(n=f.length;w<n;w++)if(f[w]instanceof
a.d2.Line){g=f[w].getPoints();break}if(!g)return"";for(var w=0,n=b.length;w<n;w++)b[w].getCenter().x<g[0].x?c[0].push(b[w]):c[1].push(b[w]);g=[];g.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");g.push(this.fit(c[0].length.toString(),3));g.push(this.fit(c[1].length.toString(),3));g.push("\n");for(w=0;2>w;w++)for(var n=0,h=c[w].length;n<h;n++)g.push("$MOL\n"),g.push(d.writeMOL(c[w][n])),g.push("\n");return g.join("")}};var g=new b.RXNInterpreter;d.readRXN=function(a,
b){return g.read(a,b)};d.writeRXN=function(a,b){return g.write(a,b)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(d,b,a,f,g,e){f.XYZInterpreter=function(){};b=f.XYZInterpreter.prototype=new f._Interpreter;b.deduceCovalentBonds=!0;b.read=function(c){var b=new g.Molecule;if(!c)return b;c=c.split("\n");for(var f=parseInt(e(c[0])),m=0;m<f;m++){var h=c[m+2].split(/\s+/g);b.atoms[m]=new g.Atom(isNaN(h[0])?h[0]:a[parseInt(h[0])-1],parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]))}this.deduceCovalentBonds&&(new d.informatics.BondDeducer).deduceCovalentBonds(b,1);return b};var m=new f.XYZInterpreter;d.readXYZ=
function(a){return m.read(a)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
ChemDoodle.monitor=function(d,b,a){var f={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};d.supports_touch()||b(a).ready(function(){b(a).mousemove(function(a){f.CANVAS_DRAGGING&&f.CANVAS_DRAGGING.drag&&(f.CANVAS_DRAGGING.prehandleEvent(a),f.CANVAS_DRAGGING.drag(a))});b(a).mouseup(function(a){f.CANVAS_DRAGGING&&f.CANVAS_DRAGGING!==f.CANVAS_OVER&&f.CANVAS_DRAGGING.mouseup&&(f.CANVAS_DRAGGING.prehandleEvent(a),f.CANVAS_DRAGGING.mouseup(a));f.CANVAS_DRAGGING=void 0});b(a).keydown(function(a){f.SHIFT=
a.shiftKey;f.ALT=a.altKey;f.META=a.metaKey||a.ctrlKey;var b=f.CANVAS_OVER;f.CANVAS_DRAGGING&&(b=f.CANVAS_DRAGGING);b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))});b(a).keypress(function(a){var b=f.CANVAS_OVER;f.CANVAS_DRAGGING&&(b=f.CANVAS_DRAGGING);b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))});b(a).keyup(function(a){f.SHIFT=a.shiftKey;f.ALT=a.altKey;f.META=a.metaKey||a.ctrlKey;var b=f.CANVAS_OVER;f.CANVAS_DRAGGING&&(b=f.CANVAS_DRAGGING);b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})});
return f}(ChemDoodle.featureDetection,jQuery,document);
(function(d,b,a,f,g,e,m,c,j,w){d._Canvas=function(){};var n=d._Canvas.prototype;n.molecules=void 0;n.shapes=void 0;n.emptyMessage=void 0;n.image=void 0;n.repaint=function(){if(!this.test){var a=j.getElementById(this.id);if(a.getContext){var c=a.getContext("2d");1!==this.pixelRatio&&a.width===this.width&&(a.width=this.width*this.pixelRatio,a.height=this.height*this.pixelRatio,c.scale(this.pixelRatio,this.pixelRatio));this.image?c.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==
a.style.backgroundColor&&(a.style.backgroundColor=this.specs.backgroundColor,this.bgCache=a.style.backgroundColor),c.fillStyle=this.specs.backgroundColor,c.fillRect(0,0,this.width,this.height));if(this.innerRepaint)this.innerRepaint(c);else if(0!==this.molecules.length||0!==this.shapes.length){c.save();c.translate(this.width/2,this.height/2);c.rotate(this.specs.rotateAngle);c.scale(this.specs.scale,this.specs.scale);c.translate(-this.width/2,-this.height/2);for(var a=0,b=this.molecules.length;a<b;a++)this.molecules[a].check(!0),
this.molecules[a].draw(c,this.specs);a=0;for(b=this.shapes.length;a<b;a++)this.shapes[a].draw(c,this.specs);c.restore()}else this.emptyMessage&&(c.fillStyle="#737683",c.textAlign="center",c.textBaseline="middle",c.font="18px Helvetica, Verdana, Arial, Sans-serif",c.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(c)}}};n.resize=function(a,c){var b=e("#"+this.id);b.attr({width:a,height:c});b.css("width",a);b.css("height",c);this.width=a;this.height=
c;if(d._Canvas3D&&this instanceof d._Canvas3D)this.gl.viewport(0,0,a,c),this.setupScene();else if(0<this.molecules.length){this.center();for(var b=0,f=this.molecules.length;b<f;b++)this.molecules[b].check()}this.repaint()};n.setBackgroundImage=function(a){this.image=new Image;var c=this;this.image.onload=function(){c.repaint()};this.image.src=a};n.loadMolecule=function(a){this.clear();this.molecules.push(a);this.center();d._Canvas3D&&this instanceof d._Canvas3D||a.check();this.afterLoadContent&&this.afterLoadContent();
this.repaint()};n.loadContent=function(a,c){this.molecules=a?a:[];this.shapes=c?c:[];this.center();if(!(d._Canvas3D&&this instanceof d._Canvas3D))for(var b=0,e=this.molecules.length;b<e;b++)this.molecules[b].check();this.afterLoadContent&&this.afterLoadContent();this.repaint()};n.addMolecule=function(a){this.molecules.push(a);d._Canvas3D&&this instanceof d._Canvas3D||a.check();this.repaint()};n.removeMolecule=function(a){this.molecules=e.grep(this.molecules,function(c){return c!==a});this.repaint()};
n.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0};n.getMolecules=function(){return this.molecules};n.addShape=function(a){this.shapes.push(a);this.repaint()};n.removeShape=function(a){this.shapes=e.grep(this.shapes,function(c){return c!==a});this.repaint()};n.getShapes=function(){return this.shapes};n.clear=function(){this.molecules=[];this.shapes=[];this.specs.scale=1;this.repaint()};n.center=function(){for(var a=this.getContentBounds(),b=new g.Point((this.width-a.minX-
a.maxX)/2,(this.height-a.minY-a.maxY)/2),e=0,d=this.molecules.length;e<d;e++)for(var f=this.molecules[e],j=0,m=f.atoms.length;j<m;j++)f.atoms[j].add(b);e=0;for(d=this.shapes.length;e<d;e++){f=this.shapes[e].getPoints();j=0;for(m=f.length;j<m;j++)f[j].add(b)}this.specs.scale=1;b=a.maxX-a.minX;a=a.maxY-a.minY;if(b>this.width||a>this.height)this.specs.scale=0.85*c.min(this.width/b,this.height/a)};n.bondExists=function(a,c){for(var b=0,e=this.molecules.length;b<e;b++)for(var d=this.molecules[b],f=0,g=
d.bonds.length;f<g;f++){var j=d.bonds[f];if(j.contains(a)&&j.contains(c))return!0}return!1};n.getBond=function(a,c){for(var b=0,e=this.molecules.length;b<e;b++)for(var d=this.molecules[b],f=0,g=d.bonds.length;f<g;f++){var j=d.bonds[f];if(j.contains(a)&&j.contains(c))return j}};n.getMoleculeByAtom=function(a){for(var c=0,b=this.molecules.length;c<b;c++){var e=this.molecules[c];if(-1!==e.atoms.indexOf(a))return e}};n.getAllAtoms=function(){for(var a=[],c=0,b=this.molecules.length;c<b;c++)a=a.concat(this.molecules[c].atoms);
return a};n.getAllPoints=function(){for(var a=[],c=0,b=this.molecules.length;c<b;c++)a=a.concat(this.molecules[c].atoms);c=0;for(b=this.shapes.length;c<b;c++)a=a.concat(this.shapes[c].getPoints());return a};n.getContentBounds=function(){for(var c=new a.Bounds,b=0,e=this.molecules.length;b<e;b++)c.expand(this.molecules[b].getBounds());b=0;for(e=this.shapes.length;b<e;b++)c.expand(this.shapes[b].getBounds());return c};n.create=function(a,l,n){this.id=a;this.width=l;this.height=n;this.molecules=[];this.shapes=
[];if(j.getElementById(a)){var v=e("#"+a);l?v.attr("width",l):this.width=v.attr("width");n?v.attr("height",n):this.height=v.attr("height");v.attr("class","ChemDoodleWebComponent")}else{if(!d.featureDetection.supports_canvas_text()&&m.msie&&"6"<=m.version){j.writeln('\x3cdiv style\x3d"border: 1px solid black;" width\x3d"'+l+'" height\x3d"'+n+'"\x3ePlease install \x3ca href\x3d"http://code.google.com/chrome/chromeframe/"\x3eGoogle Chrome Frame\x3c/a\x3e, then restart Internet Explorer.\x3c/div\x3e');
return}j.writeln('\x3ccanvas class\x3d"ChemDoodleWebComponent" id\x3d"'+a+'" width\x3d"'+l+'" height\x3d"'+n+'" alt\x3d"ChemDoodle Web Component"\x3eThis browser does not support HTML5/Canvas.\x3c/canvas\x3e')}a=e("#"+a);a.css("width",this.width);a.css("height",this.height);this.pixelRatio=w.devicePixelRatio?w.devicePixelRatio:1;this.specs=new g.VisualSpecifications;var k=this;b.supports_touch()?(a.bind("touchstart",function(a){var c=(new Date).getTime();if(!b.supports_gesture()&&2===a.originalEvent.touches.length){var e=
a.originalEvent.touches,d=new g.Point(e[0].pageX,e[0].pageY),e=new g.Point(e[1].pageX,e[1].pageY);k.implementedGestureDist=d.distance(e);k.implementedGestureAngle=d.angle(e);k.gesturestart&&(k.prehandleEvent(a),k.gesturestart(a))}k.lastTouch&&1===a.originalEvent.touches.length&&500>c-k.lastTouch?k.dbltap?(k.prehandleEvent(a),k.dbltap(a)):k.dblclick?(k.prehandleEvent(a),k.dblclick(a)):k.touchstart?(k.prehandleEvent(a),k.touchstart(a)):k.mousedown&&(k.prehandleEvent(a),k.mousedown(a)):k.touchstart?
(k.prehandleEvent(a),k.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){k.touchhold(a)},1E3))):k.mousedown&&(k.prehandleEvent(a),k.mousedown(a));k.lastTouch=c}),a.bind("touchmove",function(a){this.hold&&(clearTimeout(this.hold),this.hold=void 0);if(!b.supports_gesture()&&2===a.originalEvent.touches.length&&k.gesturechange){var e=a.originalEvent.touches,d=new g.Point(e[0].pageX,e[0].pageY),f=new g.Point(e[1].pageX,e[1].pageY),e=d.distance(f),d=d.angle(f);
a.originalEvent.scale=e/k.implementedGestureDist;a.originalEvent.rotation=180*(k.implementedGestureAngle-d)/c.PI;k.prehandleEvent(a);k.gesturechange(a)}if(1<a.originalEvent.touches.length&&k.multitouchmove){d=a.originalEvent.touches.length;k.prehandleEvent(a);e=new g.Point(-a.offset.left*d,-a.offset.top*d);for(f=0;f<d;f++)e.x+=a.originalEvent.changedTouches[f].pageX,e.y+=a.originalEvent.changedTouches[f].pageY;e.x/=d;e.y/=d;a.p=e;k.multitouchmove(a,d)}else k.touchmove?(k.prehandleEvent(a),k.touchmove(a)):
k.drag&&(k.prehandleEvent(a),k.drag(a))}),a.bind("touchend",function(a){this.hold&&(clearTimeout(this.hold),this.hold=void 0);!b.supports_gesture()&&k.implementedGestureDist&&(k.implementedGestureDist=void 0,k.implementedGestureAngle=void 0,k.gestureend&&(k.prehandleEvent(a),k.gestureend(a)));k.touchend?(k.prehandleEvent(a),k.touchend(a)):k.mouseup&&(k.prehandleEvent(a),k.mouseup(a));250>(new Date).getTime()-k.lastTouch&&(k.tap?(k.prehandleEvent(a),k.tap(a)):k.click&&(k.prehandleEvent(a),k.click(a)))}),
a.bind("gesturestart",function(a){k.gesturestart&&(k.prehandleEvent(a),k.gesturestart(a))}),a.bind("gesturechange",function(a){k.gesturechange&&(k.prehandleEvent(a),k.gesturechange(a))}),a.bind("gestureend",function(a){k.gestureend&&(k.prehandleEvent(a),k.gestureend(a))})):(a.click(function(a){switch(a.which){case 1:k.click&&(k.prehandleEvent(a),k.click(a));break;case 2:k.middleclick&&(k.prehandleEvent(a),k.middleclick(a));break;case 3:k.rightclick&&(k.prehandleEvent(a),k.rightclick(a))}}),a.dblclick(function(a){k.dblclick&&
(k.prehandleEvent(a),k.dblclick(a))}),a.mousedown(function(a){switch(a.which){case 1:f.CANVAS_DRAGGING=k;k.mousedown&&(k.prehandleEvent(a),k.mousedown(a));break;case 2:k.middlemousedown&&(k.prehandleEvent(a),k.middlemousedown(a));break;case 3:k.rightmousedown&&(k.prehandleEvent(a),k.rightmousedown(a))}}),a.mousemove(function(a){!f.CANVAS_DRAGGING&&k.mousemove&&(k.prehandleEvent(a),k.mousemove(a))}),a.mouseout(function(a){f.CANVAS_OVER=void 0;k.mouseout&&(k.prehandleEvent(a),k.mouseout(a))}),a.mouseover(function(a){f.CANVAS_OVER=
k;k.mouseover&&(k.prehandleEvent(a),k.mouseover(a))}),a.mouseup(function(a){switch(a.which){case 1:k.mouseup&&(k.prehandleEvent(a),k.mouseup(a));break;case 2:k.middlemouseup&&(k.prehandleEvent(a),k.middlemouseup(a));break;case 3:k.rightmouseup&&(k.prehandleEvent(a),k.rightmouseup(a))}}),a.mousewheel(function(a,c){k.mousewheel&&(k.prehandleEvent(a),k.mousewheel(a,c))}));this.subCreate&&this.subCreate()};n.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,
a.pageY=a.originalEvent.changedTouches[0].pageY);a.preventDefault();a.offset=e("#"+this.id).offset();a.p=new g.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document,window);
(function(d){d._AnimatorCanvas=function(b,a,d){b&&this.create(b,a,d)};d=d._AnimatorCanvas.prototype=new d._Canvas;d.timeout=33;d.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var b=this;this.nextFrame&&(this.handle=setInterval(function(){var a=(new Date).getTime();b.nextFrame(a-b.lastTime);b.repaint();b.lastTime=a},this.timeout))};d.stopAnimation=function(){this.handle&&(clearInterval(this.handle),this.handle=void 0)};d.isRunning=function(){return void 0!==this.handle}})(ChemDoodle);
(function(d,b){d.FileCanvas=function(a,d,g,e){a&&this.create(a,d,g);b.writeln('\x3cbr\x3e\x3cform name\x3d"FileForm" enctype\x3d"multipart/form-data" method\x3d"POST" action\x3d"'+e+'" target\x3d"HiddenFileFrame"\x3e\x3cinput type\x3d"file" name\x3d"f" /\x3e\x3cinput type\x3d"submit" name\x3d"submitbutton" value\x3d"Show File" /\x3e\x3c/form\x3e\x3ciframe id\x3d"HFF-'+a+'" name\x3d"HiddenFileFrame" height\x3d"0" width\x3d"0" style\x3d"display:none;" onLoad\x3d"GetMolFromFrame(\'HFF-'+a+"', "+a+')"\x3e\x3c/iframe\x3e');
this.emptyMessage="Click below to load file";this.repaint()};d.FileCanvas.prototype=new d._Canvas})(ChemDoodle,document);
(function(d){d.HyperlinkCanvas=function(b,a,d,g,e,m){b&&this.create(b,a,d);this.urlOrFunction=g;this.color=e?e:"blue";this.size=m?m:2};d=d.HyperlinkCanvas.prototype=new d._Canvas;d.openInNewWindow=!0;d.hoverImage=void 0;d.drawChildExtras=function(b){this.e&&(this.hoverImage?b.drawImage(this.hoverImage,0,0):(b.strokeStyle=this.color,b.lineWidth=2*this.size,b.strokeRect(0,0,this.width,this.height)))};d.setHoverImage=function(b){this.hoverImage=new Image;this.hoverImage.src=b};d.click=function(){this.e=
void 0;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};d.mouseout=function(){this.e=void 0;this.repaint()};d.mouseover=function(b){this.e=b;this.repaint()}})(ChemDoodle);
(function(d,b,a,f){d.MolGrabberCanvas=function(b,e,d){b&&this.create(b,e,d);e=[];e.push('\x3cbr\x3e\x3cinput type\x3d"text" id\x3d"');e.push(b);e.push('_query" size\x3d"32" value\x3d"" /\x3e');e.push("\x3cbr\x3e\x3cnobr\x3e");e.push('\x3cselect id\x3d"');e.push(b);e.push('_select"\x3e');e.push('\x3coption value\x3d"chemexper"\x3eChemExper');e.push('\x3coption value\x3d"chemspider"\x3eChemSpider');e.push('\x3coption value\x3d"pubchem" selected\x3ePubChem');e.push("\x3c/select\x3e");e.push('\x3cbutton id\x3d"');
e.push(b);e.push('_submit"\x3eShow Molecule\x3c/button\x3e');e.push("\x3c/nobr\x3e");f.getElementById(b);a("#"+b).after(e.join(""));var c=this;a("#"+b+"_submit").click(function(){c.search()});a("#"+b+"_query").keypress(function(a){13===a.which&&c.search()});this.emptyMessage="Enter search term below";this.repaint()};d=d.MolGrabberCanvas.prototype=new d._Canvas;d.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};d.search=function(){this.emptyMessage="Searching...";this.clear();
var d=this;b.getMoleculeFromDatabase(a("#"+this.id+"_query").val(),{database:a("#"+this.id+"_select").val()},function(a){d.loadMolecule(a)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(d,b,a){var f=[],g=[1,0,0],e=[0,1,0],m=[0,0,1];d.RotatorCanvas=function(a,b,e,d){a&&this.create(a,b,e);this.rotate3D=d};d=d.RotatorCanvas.prototype=new d._AnimatorCanvas;b=b.PI/15;d.xIncrement=b;d.yIncrement=b;d.zIncrement=b;d.nextFrame=function(c){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(c/=1E3,this.rotate3D){a.identity(f);a.rotate(f,this.xIncrement*c,g);a.rotate(f,this.yIncrement*c,e);a.rotate(f,this.zIncrement*c,m);c=0;for(var b=this.molecules.length;c<
b;c++){for(var d=this.molecules[c],n=0,h=d.atoms.length;n<h;n++){var l=d.atoms[n],o=[l.x-this.width/2,l.y-this.height/2,l.z];a.multiplyVec3(f,o);l.x=o[0]+this.width/2;l.y=o[1]+this.height/2;l.z=o[2]}n=0;for(h=d.rings.length;n<h;n++)d.rings[n].center=d.rings[n].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&d.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&d.sortBondsByZ()}c=0;for(b=this.shapes.length;c<b;c++){d=this.shapes[c].getPoints();n=0;for(h=d.length;n<
h;n++)l=d[n],o=[l.x-this.width/2,l.y-this.height/2,0],a.multiplyVec3(f,o),l.x=o[0]+this.width/2,l.y=o[1]+this.height/2}}else this.specs.rotateAngle+=this.zIncrement*c};d.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(d,b){d.SlideshowCanvas=function(a,b,e){a&&this.create(a,b,e)};var a=d.SlideshowCanvas.prototype=new d._AnimatorCanvas;a.frames=[];a.curIndex=0;a.timeout=5E3;a.alpha=0;a.innerHandle=void 0;a.phase=0;a.drawChildExtras=function(a){var d=b.getRGB(this.specs.backgroundColor,255);a.fillStyle="rgba("+d[0]+", "+d[1]+", "+d[2]+", "+this.alpha+")";a.fillRect(0,0,this.width,this.height)};a.nextFrame=function(){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var a=this,b=1;this.innerHandle=
setInterval(function(){a.alpha=b/15;a.repaint();15===b&&a.breakInnerHandle();b++},33)}};a.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0);if(0===this.phase){this.curIndex++;this.curIndex>this.frames.length-1&&(this.curIndex=0);this.alpha=1;var a=this.frames[this.curIndex];this.loadContent(a.mols,a.shapes);this.phase=1;var b=this,e=1;this.innerHandle=setInterval(function(){b.alpha=(15-e)/15;b.repaint();15===e&&b.breakInnerHandle();e++},33)}else 1===
this.phase&&(this.alpha=0,this.repaint())};a.addFrame=function(a,b){0===this.frames.length&&this.loadContent(a,b);this.frames.push({mols:a,shapes:b})}})(ChemDoodle,ChemDoodle.math);
(function(d,b,a,f,g){d.TransformCanvas=function(a,b,c,d){a&&this.create(a,b,c);this.rotate3D=d};d=d.TransformCanvas.prototype=new d._Canvas;d.lastPoint=void 0;d.rotationMultMod=1.3;d.lastPinchScale=1;d.lastGestureRotate=0;d.mousedown=function(a){this.lastPoint=a.p};d.dblclick=function(){this.center();this.repaint()};d.drag=function(e){if(!this.lastPoint.multi){if(b.ALT){var d=new a.Point(e.p.x,e.p.y);d.sub(this.lastPoint);for(var c=0,j=this.molecules.length;c<j;c++){for(var w=this.molecules[c],n=
0,h=w.atoms.length;n<h;n++)w.atoms[n].add(d);w.check()}c=0;for(j=this.shapes.length;c<j;c++){w=this.shapes[c].getPoints();n=0;for(h=w.length;n<h;n++)w[n].add(d)}this.lastPoint=e.p}else if(!0===this.rotate3D){h=f.max(this.width/4,this.height/4);n=(e.p.x-this.lastPoint.x)/h*this.rotationMultMod;h=-(e.p.y-this.lastPoint.y)/h*this.rotationMultMod;d=[];g.identity(d);g.rotate(d,h,[1,0,0]);g.rotate(d,n,[0,1,0]);c=0;for(j=this.molecules.length;c<j;c++){w=this.molecules[c];n=0;for(h=w.atoms.length;n<h;n++)c=
w.atoms[n],j=[c.x-this.width/2,c.y-this.height/2,c.z],g.multiplyVec3(d,j),c.x=j[0]+this.width/2,c.y=j[1]+this.height/2,c.z=j[2];c=0;for(j=w.rings.length;c<j;c++)w.rings[c].center=w.rings[c].getCenter();this.lastPoint=e.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&w.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&w.sortBondsByZ()}}else h=new a.Point(this.width/2,this.height/2),n=h.angle(this.lastPoint),h=h.angle(e.p),this.specs.rotateAngle-=h-n,this.lastPoint=
e.p;this.repaint()}};d.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};d.multitouchmove=function(b,d){if(2===d)if(this.lastPoint.multi){var c=new a.Point(b.p.x,b.p.y);c.sub(this.lastPoint);for(var f=0,g=this.molecules.length;f<g;f++){for(var n=this.molecules[f],h=0,l=n.atoms.length;h<l;h++)n.atoms[h].add(c);n.check()}f=0;for(g=this.shapes.length;f<g;f++){n=this.shapes[f].getPoints();h=0;for(l=n.length;h<l;h++)n[h].add(c)}this.lastPoint=
b.p;this.lastPoint.multi=!0;this.repaint()}else this.lastPoint=b.p,this.lastPoint.multi=!0};d.gesturechange=function(b){0!==b.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=b.originalEvent.scale/this.lastPinchScale,0.01>this.specs.scale&&(this.specs.scale=0.01),this.lastPinchScale=b.originalEvent.scale);if(0!==this.lastGestureRotate-b.originalEvent.rotation){for(var d=(this.lastGestureRotate-b.originalEvent.rotation)/180*n.PI,c=new a.Point(this.width/2,this.height/2),f=0,g=this.molecules.length;f<
g;f++){for(var n=this.molecules[f],h=0,l=n.atoms.length;h<l;h++){var o=n.atoms[h],v=c.distance(o),k=c.angle(o)+d;o.x=c.x+v*n.cos(k);o.y=c.y-v*n.sin(k)}n.check()}this.lastGestureRotate=b.originalEvent.rotation}this.repaint()};d.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);(function(d){d.ViewerCanvas=function(b,a,d){b&&this.create(b,a,d)};d.ViewerCanvas.prototype=new d._Canvas})(ChemDoodle);
(function(d){d._SpectrumCanvas=function(b,a,d){b&&this.create(b,a,d)};d=d._SpectrumCanvas.prototype=new d._Canvas;d.spectrum=void 0;d.emptyMessage="No Spectrum Loaded or Recognized";d.loadMolecule=void 0;d.getMolecule=void 0;d.innerRepaint=function(b){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(b,this.specs,this.width,this.height):this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,
this.width/2,this.height/2))};d.loadSpectrum=function(b){this.spectrum=b;this.repaint()};d.getSpectrum=function(){return this.spectrum};d.getSpectrumCoordinates=function(b,a){return spectrum.getInternalCoordinates(b,a,this.width,this.height)}})(ChemDoodle,document);(function(d){d.ObserverCanvas=function(b,a,d){b&&this.create(b,a,d)};d.ObserverCanvas.prototype=new d._SpectrumCanvas})(ChemDoodle);
(function(d){d.OverlayCanvas=function(b,a,d){b&&this.create(b,a,d)};d=d.OverlayCanvas.prototype=new d._SpectrumCanvas;d.overlaySpectra=[];d.superRepaint=d.innerRepaint;d.innerRepaint=function(b){this.superRepaint(b);if(this.spectrum&&0<this.spectrum.data.length)for(var a=0,d=this.overlaySpectra.length;a<d;a++){var g=this.overlaySpectra[a];g&&0<g.data.length&&(g.minX=this.spectrum.minX,g.maxX=this.spectrum.maxX,g.drawPlot(b,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,
this.spectrum.memory.offsetBottom))}};d.addSpectrum=function(b){this.spectrum?this.overlaySpectra.push(b):this.spectrum=b}})(ChemDoodle);
(function(d,b,a){d.PerspectiveCanvas=function(a,b,d){a&&this.create(a,b,d)};var f=d.PerspectiveCanvas.prototype=new d._SpectrumCanvas;f.dragRange=void 0;f.rescaleYAxisOnZoom=!0;f.lastPinchScale=1;f.mousedown=function(a){this.dragRange=new d.structures.Point(a.p.x,a.p.x)};f.mouseup=function(a){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=
void 0,this.repaint())};f.drag=function(a){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(b.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())};f.drawChildExtras=function(b){if(this.dragRange){var e=a.min(this.dragRange.x,this.dragRange.y),d=a.max(this.dragRange.x,this.dragRange.y);b.strokeStyle="gray";b.lineStyle=1;b.beginPath();for(b.moveTo(e,this.height/2);e<=d;e++)5>e%10?b.lineTo(e,a.round(this.height/
2)):b.moveTo(e,a.round(this.height/2));b.stroke()}};f.mousewheel=function(a,b){this.specs.scale+=b/10;0.01>this.specs.scale&&(this.specs.scale=0.01);this.repaint()};f.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};f.multitouchmove=function(a,b){2===b&&(!this.dragRange||!this.dragRange.multi?(this.dragRange=new d.structures.Point(a.p.x,a.p.x),this.dragRange.multi=!0):(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x,this.dragRange.y=a.p.x,
this.repaint()))};f.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale;0.01>this.specs.scale&&(this.specs.scale=0.01);this.lastPinchScale=a.originalEvent.scale;this.repaint()};f.gestureend=function(){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(d,b){d.SeekerCanvas=function(a,b,e,d){a&&this.create(a,b,e);this.seekType=d};var a=d.SeekerCanvas.prototype=new d._SpectrumCanvas;a.superRepaint=a.innerRepaint;a.innerRepaint=function(a){this.superRepaint(a);if(this.spectrum&&0<this.spectrum.data.length&&this.p){var g,e;if(this.seekType===d.SeekerCanvas.SEEK_POINTER)g=this.p,e=this.spectrum.getInternalCoordinates(g.x,g.y);else if(this.seekType===d.SeekerCanvas.SEEK_PLOT||this.seekType===d.SeekerCanvas.SEEK_PEAK){e=this.seekType===d.SeekerCanvas.SEEK_PLOT?
this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!e)return;g={x:this.spectrum.getTransformedX(e.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(e.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}a.fillStyle="white";a.strokeStyle=this.specs.plots_color;a.lineWidth=this.specs.plots_width;a.beginPath();a.arc(g.x,g.y,3,0,2*b.PI,!1);a.fill();a.stroke();
a.font=this.specs.getFontString(this.specs.text_font_size,this.specs.text_font_families);a.textAlign="left";a.textBaseline="bottom";e="x:"+e.x.toFixed(3)+", y:"+e.y.toFixed(3);var m=g.x+3,c=a.measureText(e).width;m+c>this.width-2&&(m-=6+c);g=g.y;0>g-this.specs.text_font_size-2&&(g+=this.specs.text_font_size);a.fillRect(m,g-this.specs.text_font_size,c,this.specs.text_font_size);a.fillStyle="black";a.fillText(e,m,g)}};a.mouseout=function(){this.p=void 0;this.repaint()};a.mousemove=function(a){this.p=
{x:a.p.x-2,y:a.p.y-3};this.repaint()};a.touchstart=function(a){this.mousemove(a)};a.touchmove=function(a){this.mousemove(a)};a.touchend=function(a){this.mouseout(a)};d.SeekerCanvas.SEEK_POINTER="pointer";d.SeekerCanvas.SEEK_PLOT="plot";d.SeekerCanvas.SEEK_PEAK="peak"})(ChemDoodle,Math);
(function(d,b,a,f,g,e,m,c,j,w,n){d._Canvas3D=function(a,b,c){a&&this.create(a,b,c)};var h=d._Canvas3D.prototype=new d._Canvas;h.rotationMatrix=void 0;h.translationMatrix=void 0;h.lastPoint=void 0;h.emptyMessage="WebGL is Unavailable!";h.afterLoadContent=function(){for(var b=new a.Bounds,c=0,e=this.molecules.length;c<e;c++)b.expand(this.molecules[c].getBounds3D());var d=m.max(b.maxX-b.minX,b.maxY-b.minY,b.maxZ-b.minZ)/2+3,c=45,e=Math.tan(c/360*Math.PI);this.depth=d/e;var e=m.max(this.depth-d,0.1),
d=this.depth+d,f=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight;1>f&&(c/=f);this.specs.projectionOrthoWidth_3D=2*(Math.tan(c/360*Math.PI)*this.depth)*f;this.specs.projectionPerspectiveVerticalFieldOfView_3D=c;this.specs.projectionFrontCulling_3D=e;this.specs.projectionBackCulling_3D=d;this.specs.projectionWidthHeightRatio_3D=f;this.translationMatrix=j.translate(j.identity([]),[0,0,-this.depth]);this.maxDimension=m.max(b.maxX-b.minX,b.maxY-b.minY);this.setupScene()};h.setViewDistance=function(b){this.specs.projectionPerspectiveVerticalFieldOfView_3D=
a.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D/b,0.1,179.9);this.specs.projectionOrthoWidth_3D=2*(m.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth)*this.specs.projectionWidthHeightRatio_3D;this.updateScene()};h.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.modelViewMatrix=j.multiply(this.translationMatrix,this.rotationMatrix,[]);this.gl.rotationMatrix=this.rotationMatrix;var a=this.gl.getUniformLocation(this.gl.program,
"u_projection_matrix");this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix);this.gl.fogging.setMode(this.specs.fog_mode_3D);for(var b=0,c=this.molecules.length;b<c;b++)this.molecules[b].render(this.gl,this.specs);b=0;for(c=this.shapes.length;b<c;b++)this.shapes[b].render(this.gl,this.specs);this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules());this.specs.compass_display&&(this.gl.uniformMatrix4fv(a,!1,this.compass.projectionMatrix),this.gl.fogging.setMode(0),
this.compass.render(this.gl,this.specs));this.gl.flush()}};h.center=function(){c.getElementById(this.id);for(var a=new f.Atom,b=0,e=this.molecules.length;b<e;b++){var d=this.molecules[b];a.add3D(d.getCenter3D())}a.x/=this.molecules.length;a.y/=this.molecules.length;b=0;for(e=this.molecules.length;b<e;b++){for(var d=this.molecules[b],g=0,h=d.atoms.length;g<h;g++)d.atoms[g].sub3D(a);if(d.chains&&d.fromJSON){g=0;for(h=d.chains.length;g<h;g++)for(var j=d.chains[g],m=0,n=j.length;m<n;m++){var w=j[m];w.cp1.sub3D(a);
w.cp2.sub3D(a);w.cp3&&(w.cp3.sub3D(a),w.cp4.sub3D(a),w.cp5.sub3D(a))}}}};h.subCreate=function(){try{var a=c.getElementById(this.id);this.gl=a.getContext("webgl");this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.rotationMatrix=j.identity([]),this.translationMatrix=j.identity([]),this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new g.Shader,this.gl.shader.init(this.gl),this.setupScene()):this.displayMessage()};d._Canvas.prototype.displayMessage=
function(){var a=c.getElementById(this.id);a.getContext&&(a=a.getContext("2d"),this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2)))};h.setupScene=function(){if(this.gl){var c=a.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(c[0],c[1],c[2],
1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new g.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);this.gl.starBuffer=new g.Star;this.gl.cylinderBuffer=new g.Cylinder(1,1,this.specs.bonds_resolution_3D);this.gl.lineBuffer=new g.Line;this.gl.arrowBuffer=new g.Arrow(0.3,this.specs.compass_resolution_3D);for(var c=0,d=this.molecules.length;c<d;c++){var f=this.molecules[c];f.unitCellVectors&&(f.unitCell=new g.UnitCell(f.unitCellVectors));
if(f.chains){f.ribbons=[];f.cartoons=[];f.tubes=[];for(var h=0,t=f.chains.length;h<t;h++){var u=f.chains[h],q=2<u.length&&e[u[2].name]&&"#BEA06E"===e[u[2].name].aminoColor;if(0<u.length&&!u[0].lineSegments){for(var r=0,p=u.length-1;r<p;r++)u[r].setup(u[r+1].cp1,q?1:this.specs.proteins_horizontalResolution);if(!q){r=1;for(p=u.length-1;r<p;r++)b.vec3AngleFrom(u[r-1].D,u[r].D)>m.PI/2&&(u[r].guidePointsSmall.reverse(),u[r].guidePointsLarge.reverse(),n.scale(u[r].D,-1))}r=1;for(p=u.length-3;r<p;r++)u[r].computeLineSegments(u[r-
1],u[r+1],u[r+2],!q,q?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);u.pop();u.pop();u.pop();u.shift()}var y=a.hsl2rgb(1===t?0.5:h/t,1,0.5),y="rgb("+y[0]+","+y[1]+","+y[2]+")";u.chainColor=y;if(q)u=new g.Tube(u,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),u.chainColor=y,f.tubes.push(u);else{q={front:new g.Ribbon(u,this.specs.proteins_ribbonThickness,!1),back:new g.Ribbon(u,-this.specs.proteins_ribbonThickness,!1)};q.front.chainColor=y;q.back.chainColor=
y;r=0;for(p=q.front.segments.length;r<p;r++)q.front.segments[r].chainColor=y;r=0;for(p=q.back.segments.length;r<p;r++)q.back.segments[r].chainColor=y;f.ribbons.push(q);u={front:new g.Ribbon(u,this.specs.proteins_ribbonThickness,!0),back:new g.Ribbon(u,-this.specs.proteins_ribbonThickness,!0)};u.front.chainColor=y;u.back.chainColor=y;r=0;for(p=u.front.segments.length;r<p;r++)u.front.segments[r].chainColor=y;r=0;for(p=u.back.segments.length;r<p;r++)u.back.segments[r].chainColor=y;r=0;for(p=u.front.cartoonSegments.length;r<
p;r++)u.front.cartoonSegments[r].chainColor=y;r=0;for(p=u.back.cartoonSegments.length;r<p;r++)u.back.cartoonSegments[r].chainColor=y;f.cartoons.push(u)}}}}this.label3D=new g.Label;this.label3D.initialize(this.gl);this.label3D.bindMoleculeLabel(this.gl,this.getMolecules());this.label3D.changeFontTexture(this.gl,this.specs);this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs);this.gl.lighting=new g.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);
this.gl.lighting.lightScene(this.gl);this.gl.material=new g.Material(this.gl);this.gl.fogging=new g.Fog(this.gl);this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);this.compass=new g.Compass(this.gl,this.specs);c=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(c=this.specs.projectionWidthHeightRatio_3D);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?j.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,
c,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):j.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/c,this.specs.projectionOrthoWidth_3D/2/c,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);c=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(c,!1,this.gl.projectionMatrix);var z=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),
x=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(z,!1,a);a=w.transpose(j.toInverseMat3(a,[]));this.uniformMatrix3fv(x,!1,a)}}};h.mousedown=function(a){this.lastPoint=a.p};h.rightmousedown=function(a){this.lastPoint=a.p};h.drag=function(a){if(d.monitor.ALT){var b=new f.Point(a.p.x,a.p.y);b.sub(this.lastPoint);j.translate(this.translationMatrix,[b.x/20,-b.y/20,0])}else{var c=a.p.x-this.lastPoint.x,b=a.p.y-this.lastPoint.y,c=
j.rotate(j.identity([]),c*m.PI/180,[0,1,0]);j.rotate(c,b*m.PI/180,[1,0,0]);this.rotationMatrix=j.multiply(c,this.rotationMatrix)}this.lastPoint=a.p;this.repaint()};h.mousewheel=function(b,c){this.specs.projectionPerspectiveVerticalFieldOfView_3D=a.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D+c*this.maxDimension/8,0.1,179.9);this.specs.projectionOrthoWidth_3D=2*(m.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth)*this.specs.projectionWidthHeightRatio_3D;
this.updateScene()};h.updateScene=function(){this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);var a=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(a=this.specs.projectionWidthHeightRatio_3D);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?j.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):
j.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);a=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(a,!1,this.gl.projectionMatrix);this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,
mat4,mat3,vec3,window);
(function(d,b,a,f){d.MolGrabberCanvas3D=function(b,e,d){b&&this.create(b,e,d);e=[];e.push('\x3cbr\x3e\x3cinput type\x3d"text" id\x3d"');e.push(b);e.push('_query" size\x3d"32" value\x3d"" /\x3e');e.push("\x3cbr\x3e\x3cnobr\x3e");e.push('\x3cselect id\x3d"');e.push(b);e.push('_select"\x3e');e.push('\x3coption value\x3d"pubchem" selected\x3ePubChem');e.push("\x3c/select\x3e");e.push('\x3cbutton id\x3d"');e.push(b);e.push('_submit"\x3eShow Molecule\x3c/button\x3e');e.push("\x3c/nobr\x3e");f.writeln(e.join(""));
var c=this;a("#"+b+"_submit").click(function(){c.search()});a("#"+b+"_query").keypress(function(a){13===a.which&&c.search()})};d=d.MolGrabberCanvas3D.prototype=new d._Canvas3D;d.setSearchTerm=function(b){a("#"+this.id+"_query").val(b);this.search()};d.search=function(){var d=this;b.getMoleculeFromDatabase(a("#"+this.id+"_query").val(),{database:a("#"+this.id+"_select").val(),dimension:3},function(a){d.loadMolecule(a)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(d,b){d.MovieCanvas3D=function(a,b,e){a&&this.create(a,b,e)};d.MovieCanvas3D.PLAY_ONCE=0;d.MovieCanvas3D.PLAY_LOOP=1;d.MovieCanvas3D.PLAY_SPRING=2;var a=d.MovieCanvas3D.prototype=new d._Canvas3D;a.timeout=50;a.frames=[];a.frameNumber=0;a.playMode=2;a.reverse=!1;a.startAnimation=d._AnimatorCanvas.prototype.startAnimation;a.stopAnimation=d._AnimatorCanvas.prototype.stopAnimation;a.isRunning=d._AnimatorCanvas.prototype.isRunning;a.dblclick=d.RotatorCanvas.prototype.dblclick;a.nextFrame=function(){var a=
this.frames[this.frameNumber];this.molecules=a.mols;this.shapes=a.shapes;2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))};a.center=function(){for(var a=new b.Atom,d=this.frames[0],e=0,m=d.mols.length;e<m;e++)a.add3D(d.mols[e].getCenter3D());a.x/=d.mols.length;a.y/=
d.mols.length;d=new b.Atom;d.sub3D(a);for(var a=0,c=this.frames.length;a<c;a++)for(var j=this.frames[a],e=0,m=j.mols.length;e<m;e++)for(var w=j.mols[e],n=0,h=w.atoms.length;n<h;n++)w.atoms[n].add3D(d)};a.addFrame=function(a,b){this.frames.push({mols:a,shapes:b})}})(ChemDoodle,ChemDoodle.structures);
(function(d,b,a){var f=[],g=[1,0,0],e=[0,1,0],m=[0,0,1];d.RotatorCanvas3D=function(a,b,c){a&&this.create(a,b,c)};var c=d.RotatorCanvas3D.prototype=new d._Canvas3D;c.timeout=33;b=b.PI/15;c.xIncrement=b;c.yIncrement=b;c.zIncrement=b;c.startAnimation=d._AnimatorCanvas.prototype.startAnimation;c.stopAnimation=d._AnimatorCanvas.prototype.stopAnimation;c.isRunning=d._AnimatorCanvas.prototype.isRunning;c.dblclick=d.RotatorCanvas.prototype.dblclick;c.mousedown=void 0;c.rightmousedown=void 0;c.drag=void 0;
c.mousewheel=void 0;c.nextFrame=function(b){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(a.identity(f),b/=1E3,a.rotate(f,this.xIncrement*b,g),a.rotate(f,this.yIncrement*b,e),a.rotate(f,this.zIncrement*b,m),a.multiply(this.rotationMatrix,f))}})(ChemDoodle,Math,mat4);(function(d){d.TransformCanvas3D=function(b,a,d){b&&this.create(b,a,d)};d.TransformCanvas3D.prototype=new d._Canvas3D})(ChemDoodle);
(function(d){d.ViewerCanvas3D=function(b,a,d){b&&this.create(b,a,d)};d=d.ViewerCanvas3D.prototype=new d._Canvas3D;d.mousedown=void 0;d.rightmousedown=void 0;d.drag=void 0;d.mousewheel=void 0})(ChemDoodle);
(function(d,b,a){function f(a,b,c,d){this.element=a;this.x=b;this.y=c;this.dimension=d}d.PeriodicTableCanvas=function(a,b){this.padding=5;a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding);this.cellDimension=b?b:20;this.setupTable();this.repaint()};var g=d.PeriodicTableCanvas.prototype=new d._Canvas;g.loadMolecule=void 0;g.getMolecule=void 0;g.getHoveredElement=function(){if(this.hovered)return this.hovered.element};g.innerRepaint=function(a){for(var b=0,c=this.cells.length;b<c;b++)this.drawCell(a,
this.specs,this.cells[b]);this.hovered&&this.drawCell(a,this.specs,this.hovered);this.selected&&this.drawCell(a,this.specs,this.selected)};g.setupTable=function(){this.cells=[];for(var a=this.padding,b=this.padding,c=0,g=0,w=d.SYMBOLS.length;g<w;g++){18===c&&(c=0,b+=this.cellDimension,a=this.padding);var n=d.ELEMENT[d.SYMBOLS[g]];if(2===n.atomicNumber)a+=16*this.cellDimension,c+=16;else if(5===n.atomicNumber||13===n.atomicNumber)a+=10*this.cellDimension,c+=10;if((58>n.atomicNumber||71<n.atomicNumber&&
90>n.atomicNumber||103<n.atomicNumber)&&113>n.atomicNumber)this.cells.push(new f(n,a,b,this.cellDimension)),a+=this.cellDimension,c++}b+=2*this.cellDimension;a=3*this.cellDimension+this.padding;for(g=57;104>g;g++)if(n=d.ELEMENT[d.SYMBOLS[g]],90===n.atomicNumber&&(b+=this.cellDimension,a=3*this.cellDimension+this.padding),58<=n.atomicNumber&&71>=n.atomicNumber||90<=n.atomicNumber&&103>=n.atomicNumber)this.cells.push(new f(n,a,b,this.cellDimension)),a+=this.cellDimension};g.drawCell=function(a,d,c){var f=
a.createRadialGradient(c.x+c.dimension/3,c.y+c.dimension/3,1.5*c.dimension,c.x+c.dimension/3,c.y+c.dimension/3,c.dimension/10);f.addColorStop(0,"#000000");f.addColorStop(0.7,c.element.jmolColor);f.addColorStop(1,"#FFFFFF");a.fillStyle=f;b.contextRoundRect(a,c.x,c.y,c.dimension,c.dimension,c.dimension/8);if(c===this.hovered||c===this.selected)a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),a.fillStyle="white";a.fill();a.font=d.getFontString(d.text_font_size,d.text_font_families);a.fillStyle=d.text_color;
a.textAlign="center";a.textBaseline="middle";a.fillText(c.element.symbol,c.x+c.dimension/2,c.y+c.dimension/2)};g.click=function(){this.hovered&&(this.selected=this.hovered,this.repaint())};g.mousemove=function(b){var d=b.p.x;b=b.p.y;this.hovered=void 0;for(var c=0,f=this.cells.length;c<f;c++){var g=this.cells[c];if(a.isBetween(d,g.x,g.x+g.dimension)&&a.isBetween(b,g.y,g.y+g.dimension)){this.hovered=g;break}}this.repaint()};g.mouseout=function(){this.hovered=void 0;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,
ChemDoodle.math,document);(function(d,b,a){d.png={};d.png.create=function(d){a.open(b.getElementById(d.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);(function(d,b){d.file={};d.file.content=function(a,d){b.get(a,"",d)}})(ChemDoodle.io,jQuery);
(function(d,b,a,f,g){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/icl_cdc_v050000/WebHQ";b.inRelay=!1;b.asynchronous=!0;b.INFO={userAgent:navigator.userAgent,v_cwc:d.getVersion(),v_jQuery:g.version,v_jQuery_ui:g.ui?g.ui.version:"N/A"};var e=new a.JSONInterpreter;b._contactServer=function(a,c,d,e,f){this.inRelay?alert("Already connecting to the server, please wait for the first request to finish."):(b.inRelay=!0,g.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:c,options:d,
info:b.INFO}),url:this.SERVER_URL,success:function(a){b.inRelay=!1;a=JSON.parse(a);a.message&&alert(a.message);e&&(a.content&&!a.stop)&&e(a.content);a.stop&&f&&f()},error:function(){b.inRelay=!1;alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support.");f&&f()},xhrFields:{withCredentials:!0},async:b.asynchronous}))};b.authenticate=function(a,b,d,e){this._contactServer("authenticate",{credential:a},b,function(a){d(a)},e)};b.calculate=function(a,
b,d,f){this._contactServer("calculate",{mol:e.molTo(a)},b,function(a){d(a)},f)};b.generateImage=function(a,b,d,f){this._contactServer("generateImage",{mol:e.molTo(a)},b,function(a){d(a.link)},f)};b.generateIUPACName=function(a,b,d,f){this._contactServer("generateIUPACName",{mol:e.molTo(a)},b,function(a){d(a.iupac)},f)};b.getAd=function(a,b){this._contactServer("getAd",{},{},function(b){a(b.image_url,b.target_url)},b)};b.getMoleculeFromContent=function(a,b,d,f){this._contactServer("getMoleculeFromContent",
{content:a},b,function(a){for(var b=!1,c=0,f=a.mol.a.length;c<f;c++)if(0!==a.mol.a[c].z){b=!0;break}if(b){c=0;for(f=a.mol.a.length;c<f;c++)a.mol.a[c].x/=20,a.mol.a[c].y/=20,a.mol.a[c].z/=20}d(e.molFrom(a.mol))},f)};b.getMoleculeFromDatabase=function(a,b,d,f){this._contactServer("getMoleculeFromDatabase",{query:a},b,function(a){if(3===b.dimension)for(var f=0,g=a.mol.a.length;f<g;f++)a.mol.a[f].x/=20,a.mol.a[f].y/=-20,a.mol.a[f].z/=20;d(e.molFrom(a.mol))},f)};b.getOptimizedPDBStructure=function(a,b,
d,g){this._contactServer("getOptimizedPDBStructure",{id:a},b,function(a){var b;b=a.mol?e.molFrom(a.mol):new f.Molecule;b.chains=e.chainsFrom(a.ribbons);b.fromJSON=!0;d(b)},g)};b.getZeoliteFromIZA=function(a,b,d,e){this._contactServer("getZeoliteFromIZA",{query:a},b,function(a){d(ChemDoodle.readCIF(a.cif,b.xSuper,b.ySuper,b.zSuper))},e)};b.isGraphIsomorphism=function(a,b,d,f,g){this._contactServer("isGraphIsomorphism",{arrow:e.molTo(a),target:e.molTo(b)},d,function(a){f(a.value)},g)};b.isSubgraphIsomorphism=
function(a,b,d,f,g){this._contactServer("isSubgraphIsomorphism",{arrow:e.molTo(a),target:e.molTo(b)},d,function(a){f(a.value)},g)};b.kekulize=function(a,b,d,f){this._contactServer("kekulize",{mol:e.molTo(a)},b,function(a){d(e.molFrom(a.mol))},f)};b.optimize=function(a,b,d,f){this._contactServer("optimize",{mol:e.molTo(a)},b,function(f){f=e.molFrom(f.mol);if(2===b.dimension){for(var g=0,l=f.atoms.length;g<l;g++)a.atoms[g].x=f.atoms[g].x,a.atoms[g].y=f.atoms[g].y;d()}else if(3===b.dimension){g=0;for(l=
f.atoms.length;g<l;g++)f.atoms[g].x/=20,f.atoms[g].y/=-20,f.atoms[g].z/=20;d(f)}},f)};b.readIUPACName=function(a,b,d,f){this._contactServer("readIUPACName",{iupac:a},b,function(a){d(e.molFrom(a.mol))},f)};b.readSMILES=function(a,b,d,f){this._contactServer("readSMILES",{smiles:a},b,function(a){d(e.molFrom(a.mol))},f)};b.saveFile=function(a,b,d,f){this._contactServer("saveFile",{mol:e.molTo(a)},b,function(a){d(a.link)},f)};b.simulate13CNMR=function(a,b,f,g){b.nucleus="C";b.isotope=13;this._contactServer("simulateNMR",
{mol:e.molTo(a)},b,function(a){f(d.readJCAMP(a.jcamp))},g)};b.simulate1HNMR=function(a,b,f,g){b.nucleus="H";b.isotope=1;this._contactServer("simulateNMR",{mol:e.molTo(a)},b,function(a){f(d.readJCAMP(a.jcamp))},g)};b.simulateMassParentPeak=function(a,b,f,g){this._contactServer("simulateMassParentPeak",{mol:e.molTo(a)},b,function(a){f(d.readJCAMP(a.jcamp))},g)};b.writeSMILES=function(a,b,d,f){this._contactServer("writeSMILES",{mol:e.molTo(a)},b,function(a){d(a.smiles)},f)};b.version=function(a,b,d){this._contactServer("version",
{},a,function(a){b(a.value)},d)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);